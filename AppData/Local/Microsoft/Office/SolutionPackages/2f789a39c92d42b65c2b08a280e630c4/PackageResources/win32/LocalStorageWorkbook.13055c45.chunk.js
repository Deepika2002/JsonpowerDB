"use strict";(self.webpackChunkmaker_code_editor=self.webpackChunkmaker_code_editor||[]).push([[5230],{76128:function(e,r,t){t.d(r,{dR:function(){return n},wS:function(){return a},gN:function(){return o},Tm:function(){return u},BK:function(){return i},Wv:function(){return c}});var n={recordedScriptsKey:"recorded-maker-scripts",sharedScriptsKey:"shared-maker-scripts",attachedIdsKey:"workbook-attached-ids"},a="0a088C17MOCKPUID",o="Name",u="name@contoso.com",i="Tenant-guid",c="Contoso"},2983:function(e,r,t){t.d(r,{_:function(){return a}});var n=t(76128),a=function(){};Object.defineProperty(a,"getScriptsMap",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=JSON.parse(localStorage.getItem(n.dR.recordedScriptsKey)||"{}");return new Map(Object.entries(e))}}),Object.defineProperty(a,"updateLocalStorageScriptsMap",{configurable:!0,enumerable:!0,writable:!0,value:function(e,r){window.localStorage.setItem(e,JSON.stringify(a.convertMapToObject(r)))}}),Object.defineProperty(a,"updateLocalStorageGeneral",{configurable:!0,enumerable:!0,writable:!0,value:function(e,r){window.localStorage.setItem(e,r)}}),Object.defineProperty(a,"convertMapToObject",{configurable:!0,enumerable:!0,writable:!0,value:function(e){var r={};return e.forEach((function(e,t){return r[t]=e})),r}}),Object.defineProperty(a,"getSharedScriptsMap",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=JSON.parse(localStorage.getItem(n.dR.sharedScriptsKey)||"{}");return new Map(Object.entries(e))}}),Object.defineProperty(a,"getAttachedIds",{configurable:!0,enumerable:!0,writable:!0,value:function(){return JSON.parse(localStorage.getItem(n.dR.attachedIdsKey)||"[]")}})},95655:function(e,r,t){t.r(r),t.d(r,{LocalStorageWorkbook:function(){return c}});var n=t(74844),a=t(76128),o=t(2983);function u(e,r,t,n,a,o,u){try{var i=e[o](u),c=i.value}catch(d){return void t(d)}i.done?r(c):Promise.resolve(c).then(n,a)}function i(e){return function(){var r=this,t=arguments;return new Promise((function(n,a){var o=e.apply(r,t);function i(e){u(o,n,a,i,c,"next",e)}function c(e){u(o,n,a,i,c,"throw",e)}i(void 0)}))}}var c=function(){function e(){var e=this;Object.defineProperty(this,"readScriptIdsFromWorkbook",{configurable:!0,enumerable:!0,writable:!0,value:function(){var r=i(regeneratorRuntime.mark((function r(){var t,n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.readScriptIdShareIdsFromWorkbook();case 2:return t=r.sent,n=t.map((function(e){return e.shareId})),r.abrupt("return",n);case 5:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}()}),Object.defineProperty(this,"readScriptIdShareIdsFromWorkbook",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,n.Tg)(o._.getAttachedIds()));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"attachScriptToWorkbook",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=i(regeneratorRuntime.mark((function e(r){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return-1===(t=o._.getAttachedIds()).findIndex((function(e){return e===r}))&&(t.push(r),o._.updateLocalStorageGeneral(a.dR.attachedIdsKey,JSON.stringify(t))),e.abrupt("return");case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"detachScriptFromWorkbook",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=i(regeneratorRuntime.mark((function e(r,t){var n,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t="User"),n=o._.getAttachedIds(),-1!=(u=n.findIndex((function(e){return e===r})))&&(n.splice(u,1),o._.updateLocalStorageGeneral(a.dR.attachedIdsKey,JSON.stringify(n))),e.abrupt("return");case 5:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}()})}return e.prototype.getWorkbookIds=function(e){return Promise.resolve({locationId:"",driveId:"",fileId:"",listId:"",driveType:"",isMyOneDrive:!1})},e}()}}]);
//# sourceMappingURL=LocalStorageWorkbook.13055c45.chunk.js.map