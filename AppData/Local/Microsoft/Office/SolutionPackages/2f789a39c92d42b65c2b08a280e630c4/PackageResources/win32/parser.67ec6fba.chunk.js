"use strict";(self.webpackChunkmaker_code_editor=self.webpackChunkmaker_code_editor||[]).push([[7330],{93593:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.parseTypescriptToFlow=r.ts=r.ValidationTypeErrorCode=r.SignatureParserValidationError=r.MakerApiType=r.logStats=r.FlowType=void 0;var n=t(286);r.ts=n;var i=t(73950);Object.defineProperty(r,"logStats",{enumerable:!0,get:function(){return i.logStats}});var o=t(44405),a=t(79175),u=t(40175),p=t(22369);Object.defineProperty(r,"MakerApiType",{enumerable:!0,get:function(){return p.MakerApiType}});var c=t(87427);Object.defineProperty(r,"ValidationTypeErrorCode",{enumerable:!0,get:function(){return c.ValidationTypeErrorCode}});var s=t(25322),d=t(38373),y=t(21473),l=t(42870);Object.defineProperty(r,"SignatureParserValidationError",{enumerable:!0,get:function(){return l.SignatureParserValidationError}});var f=t(53468),T=t(16385);r.FlowType=T,r.parseTypescriptToFlow=function(e,r,t){void 0===t&&(t="main");var n=new o.FunctionSignatureParser(e,t,r,u.createBrowserTypeChecker);if(!n.parse())throw new l.SignatureParserValidationError([{code:c.ValidationTypeErrorCode.NoTargetFunctionError,message:"No function of name '"+t+"' found. Ensure the function exists and is not nested in anything.",position:{start:0,end:0}}]);var i=new s.ModifierValidator(n.parsedNodes);i.validate();var p=new d.ParameterTypeValidator(n.parsedNodes,r.makerApiType);p.validate();var T=new y.ReturnTypeValidator(n.parsedNodes);T.validate();var v=i.errors.concat(p.errors,T.errors);if(v.length>0)throw new l.SignatureParserValidationError(v);var m=f.writeParameterToFlow(n.parsedNodes.paramNodes,r.makerApiType),h=f.writeReturnToFlow(n.parsedNodes.returnNode),S=new a.ParameterOrderSignatureParser(e,t,r);return S.parse(),{originalParameterOrder:S.nodeOrder,parameterSchema:m,returnSchema:h}}},73950:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.logStats=void 0;var n=t(28531),i=t(92748),o=t(37099);r.logStats=function(e){if(null===e)return i.createParameterInfoStats({hasError:!0});if(!e||""===e.trim())return i.createParameterInfoStats();try{var r=JSON.parse(e),t=r.originalParameterOrder.length,a=!n.isFlowReturnSchemaNullObj(r.returnSchema),u=o.sanitizeFlowSchema(r.parameterSchema),p=o.sanitizeFlowSchema(r.returnSchema);return i.createParameterInfoStats({numParams:t,hasReturn:a,paramSchema:u,returnSchema:p})}catch(c){return i.createParameterInfoStats({hasError:!0})}}},92748:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.createParameterInfoStats=void 0;var n=t(28531);r.createParameterInfoStats=function(e){var r=void 0===e?{}:e,t=r.hasError,i=void 0!==t&&t,o=r.numParams,a=void 0===o?0:o,u=r.hasReturn,p=void 0!==u&&u,c=r.paramSchema,s=void 0===c?void 0:c,d=r.returnSchema,y=void 0===d?void 0:d;return i||(s=n.createFlowParameterSchemaNullObj(),y=n.createFlowReturnSchemaNullObj()),{hasError:i,numParams:a,hasReturn:p,paramSchema:s,returnSchema:y}}},37099:function(e,r,t){function n(){return n=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},n.apply(this,arguments)}Object.defineProperty(r,"__esModule",{value:!0}),r.createSanitizedPropertyName=r.sanitizeFlowSchema=void 0;var i=t(16385);function o(e){if(e)return e.map((function(e,r){return s(r)}))}function a(e){if(e){var r={};return Object.entries(e).forEach((function(e,t){e[0];var n=e[1];r[s(t)]=u(n)})),r}}function u(e){var r;if(i.isNormalFlowTypeNode(e))switch(e.type){case i.FlowType.String:return n({},e,{default:p(e.default),enum:null===(r=e.enum)||void 0===r?void 0:r.map((function(e){return s()}))});case i.FlowType.Array:return n({},e,{default:c(e.default),items:u(e.items)});case i.FlowType.Object:var t=n({},e);return delete t.properties,t.properties=function(e){if(!e)return;var r={};return Object.entries(e).forEach((function(e,t){e[0];var n=e[1];r[s(t)]=u(n)})),r}(e.properties),t;default:return n({},e)}var o=e.default;return"string"===typeof e.default&&(o=p(e.default)),e.default instanceof Array&&(o=c(e.default)),n({},e,{default:o})}function p(e){return e?s():void 0}function c(e){if(e)return e.every((function(e){return"string"===typeof e}))?e.map((function(e){return s()})):e}function s(e){return"var"+(null!==e&&void 0!==e?e:"")}r.sanitizeFlowSchema=function(e){return n({},e,{required:o(e.required),properties:a(e.properties)})},r.createSanitizedPropertyName=s},44405:function(e,r,t){function n(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,r){return i=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e},i(e,r)}Object.defineProperty(r,"__esModule",{value:!0}),r.FunctionSignatureParser=void 0;var o=t(286),a=t(62887),u=t(72032),p=t(44170),c=t(54793),s=t(12033),d=t(3263),y=function(e){var r,t;function c(r,t,n,i){var o;return void 0===t&&(t="main"),(o=e.call(this,r,t,n)||this).targetFunctionName=t,o.signatureParserOptions=n,o.mParsedNodes=u.createParsedNodesNullObj(),o.typeCheckerStrategy=null!==i&&void 0!==i?i:s.createDefaultNodeTypeChecker,o}t=e,(r=c).prototype=Object.create(t.prototype),r.prototype.constructor=r,i(r,t);var y,l,f,T=c.prototype;return T.parseVariableStatement=function(r){var t=this;return r.modifiers&&r.modifiers.forEach((function(e){return t.parseFunctionModifier(e)})),e.prototype.parseVariableStatement.call(this,r)},T.parseParameterDeclaration=function(e){this.mParsedNodes.paramNodes.push(this.buildParsedNode(e,e.name))},T.parseTargetedFunction=function(e,r){var t=this;return r.text===this.targetFunctionName&&(e.modifiers&&e.modifiers.forEach((function(e){return t.parseFunctionModifier(e)})),this.mParsedNodes.returnNode=this.buildParsedReturnNode(e,r),o.forEachChild(e,this.parseSignature),!0)},T.parseFunctionModifier=function(e){switch(e.kind){case o.SyntaxKind.AsyncKeyword:this.mParsedNodes.functionModifiers=this.mParsedNodes.functionModifiers||[],this.mParsedNodes.functionModifiers.push({kind:a.FunctionModifierType.Async,position:{start:e.pos,end:e.end}});break;case o.SyntaxKind.ExportKeyword:this.mParsedNodes.functionModifiers=this.mParsedNodes.functionModifiers||[],this.mParsedNodes.functionModifiers.push({kind:a.FunctionModifierType.Export,position:{start:e.pos,end:e.end}});break;case o.SyntaxKind.DeclareKeyword:this.mParsedNodes.functionModifiers=this.mParsedNodes.functionModifiers||[],this.mParsedNodes.functionModifiers.push({kind:a.FunctionModifierType.Declare,position:{start:e.pos,end:e.end}})}},T.buildParsedReturnNode=function(e,r){var t=this.buildParsedNode(e,r);return e.type||(t.type=this.getImplicitType(e)),t},T.buildParsedNode=function(e,r){var t=r.text,n={start:r.pos,end:r.end};return{name:t,namePosition:n,type:e.type?d.parseType(e,this.topNode):p.createUnrecognizedType(),typePosition:e.type?{start:e.type.pos,end:e.type.end}:n}},T.getImplicitType=function(e){var r;if(!(null===(r=this.signatureParserOptions)||void 0===r?void 0:r.parseImplicitTypes))return p.createVoidType();var t=this.typeChecker.getSignatureFromDeclaration(e);if(!t)return p.createVoidType();var n=this.typeChecker.getReturnTypeOfSignature(t),i=this.typeChecker.typeToTypeNode(n,void 0,void 0);return d.parseTypeNode(i,this.topNode)},y=c,(l=[{key:"typeChecker",get:function(){var e,r;return this.mTypeChecker||(this.mTypeChecker=this.typeCheckerStrategy(this.topNode,null===(e=this.signatureParserOptions)||void 0===e?void 0:e.libSource,null===(r=this.signatureParserOptions)||void 0===r?void 0:r.compilerOptions)),this.mTypeChecker}},{key:"parsedNodes",get:function(){return this.mParsedNodes}}])&&n(y.prototype,l),f&&n(y,f),Object.defineProperty(y,"prototype",{writable:!1}),c}(c.SignatureParser);r.FunctionSignatureParser=y},79175:function(e,r,t){function n(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,r){return i=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e},i(e,r)}Object.defineProperty(r,"__esModule",{value:!0}),r.ParameterOrderSignatureParser=void 0;var o=t(286),a=t(22369),u=t(6279),p=function(e){var r,t;function p(r,t,n){var i;return void 0===t&&(t="main"),(i=e.call(this,r,t,n)||this).targetFunctionName=t,i.mNodeOrder=[],i.curIndex=0,i.makerApiType=a.MakerApiType.BatchApi,void 0!==n&&(i.makerApiType=n.makerApiType),i}t=e,(r=p).prototype=Object.create(t.prototype),r.prototype.constructor=r,i(r,t);var c,s,d,y=p.prototype;return y.parseParameterDeclaration=function(e){u.isContext(e,this.makerApiType)||this.mNodeOrder.push({name:e.name.text,index:this.curIndex++})},y.parseTargetedFunction=function(e,r){return r.text===this.targetFunctionName&&(o.forEachChild(e,this.parseSignature),!0)},c=p,(s=[{key:"nodeOrder",get:function(){return this.mNodeOrder}}])&&n(c.prototype,s),d&&n(c,d),Object.defineProperty(c,"prototype",{writable:!1}),p}(t(54793).SignatureParser);r.ParameterOrderSignatureParser=p},54793:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.SignatureParser=void 0;var n=t(286),i=t(6279),o=t(20717),a=function(){function e(e,r,t){var a=this;void 0===r&&(r="main"),this.targetFunctionName=r,this.parseSignature=function(e){switch(e.kind){case n.SyntaxKind.FunctionDeclaration:return a.parseFunctionDeclaration(e);case n.SyntaxKind.VariableStatement:return a.parseVariableStatement(e);case n.SyntaxKind.VariableDeclaration:return a.parseVariableDeclaration(e);case n.SyntaxKind.Parameter:return a.parseParameterDeclaration(e),!1;default:return!1}};var u=t&&t.compilerOptions&&t.compilerOptions.target||o.SCRIPT_TARGET;this.topNode=i.isSourceFile(e)?e:n.createSourceFile(o.SOURCE_FILE_NAME,e,u,!0,n.ScriptKind.TS)}var r=e.prototype;return r.parse=function(){return!!n.forEachChild(this.topNode,this.parseSignature)},r.parseFunctionDeclaration=function(e){return!!e.name&&this.parseTargetedFunction(e,e.name)},r.parseVariableStatement=function(e){return!!n.forEachChild(e.declarationList,this.parseSignature)},r.parseVariableDeclaration=function(e){var r=e.initializer;return!(!r||!n.isArrowFunction(r))&&this.parseTargetedFunction(r,e.name)},e}();r.SignatureParser=a},20717:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.SCRIPT_TARGET=r.SOURCE_FILE_NAME=void 0;var n=t(286);r.SOURCE_FILE_NAME="index.ts",r.SCRIPT_TARGET=n.ScriptTarget.ES5},40175:function(e,r,t){function n(){return n=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},n.apply(this,arguments)}Object.defineProperty(r,"__esModule",{value:!0}),r.createBrowserTypeChecker=void 0;var i=t(286),o=t(20717),a="lib.ts";r.createBrowserTypeChecker=function(e,r,t){void 0===r&&(r=[]),void 0===t&&(t={});var u={fileExists:function(){return!0},getCanonicalFileName:function(e){return e},getCurrentDirectory:function(){return"/"},getDefaultLibFileName:function(){return a},getNewLine:function(){return"\n"},getSourceFile:function(n){if(n===o.SOURCE_FILE_NAME)return e;if(n===a){var u="string"===typeof r?r:r.join("\n");return i.createSourceFile(n,u,t.target||o.SCRIPT_TARGET,!0)}},readFile:function(){},useCaseSensitiveFileNames:function(){return!1},writeFile:function(){}};return i.createProgram([o.SOURCE_FILE_NAME],n({target:o.SCRIPT_TARGET},t),u).getTypeChecker()}},12033:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.createDefaultNodeTypeChecker=void 0;var n=t(286),i=t(20717);r.createDefaultNodeTypeChecker=function(e){var r=n.createCompilerHost({}),t={fileExists:function(){return!0},getCanonicalFileName:function(e){return e},getCurrentDirectory:function(){return"/"},getDefaultLibFileName:function(){return"./node_modules/typescript/lib/lib.d.ts"},getNewLine:function(){return"/n"},getSourceFile:function(t){return t===i.SOURCE_FILE_NAME?e:r.getSourceFile(t,i.SCRIPT_TARGET)},readFile:function(){},useCaseSensitiveFileNames:function(){return!1},writeFile:function(){}};return n.createProgram([i.SOURCE_FILE_NAME],{target:i.SCRIPT_TARGET},t).getTypeChecker()}},3263:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.parseTypeNode=r.parseType=void 0;var n=t(286),i=t(44170),o=t(13158);function a(e,r){var t=u(e.type,r);return n.isParameter(e)&&(t.modifier=o.parseTypeModifier(e,r)),t}function u(e,r){if(!e)return i.createUnrecognizedType();switch(e.kind){case n.SyntaxKind.AnyKeyword:case n.SyntaxKind.UnknownKeyword:return{kind:i.TSType.Any};case n.SyntaxKind.UndefinedKeyword:return{kind:i.TSType.Undefined};case n.SyntaxKind.VoidKeyword:return{kind:i.TSType.Void};case n.SyntaxKind.StringKeyword:return{kind:i.TSType.String};case n.SyntaxKind.ObjectKeyword:return{kind:i.TSType.Object};case n.SyntaxKind.LiteralType:return function(e){switch(e.literal.kind){case n.SyntaxKind.StringLiteral:return{kind:i.TSType.StringLiteral,value:e.literal.text};case n.SyntaxKind.NumericLiteral:return{kind:i.TSType.NumericLiteral,value:+e.literal.text};case n.SyntaxKind.TrueKeyword:case n.SyntaxKind.FalseKeyword:return p(e.literal);default:return i.createUnrecognizedType()}}(e);case n.SyntaxKind.TrueKeyword:case n.SyntaxKind.FalseKeyword:return p(e);case n.SyntaxKind.BooleanKeyword:return{kind:i.TSType.Boolean};case n.SyntaxKind.NumberKeyword:return{kind:i.TSType.Number};case n.SyntaxKind.ArrayType:return function(e,r){return{kind:i.TSType.Array,internalType:u(e.elementType,r)}}(e,r);case n.SyntaxKind.UnionType:return function(e,r){var t=e.types.map((function(e){return u(e,r)}));return{kind:i.TSType.Union,internalTypes:t}}(e,r);case n.SyntaxKind.ParenthesizedType:return u(e.type,r);case n.SyntaxKind.TypeReference:return function(e,r){var t=e.typeName.text?e.typeName.text:e.typeName.getText();if(e.typeArguments){var o=e.typeArguments.map((function(e){return u(e,r)}));return{kind:i.TSType.TypeReference,typeName:t,typeArgs:o}}return function(e,r){var t=i.createUnrecognizedType(),o=function(o){switch(o.kind){case n.SyntaxKind.InterfaceDeclaration:t=function(e,r,t){if(e.name.text!==r)return i.createUnrecognizedType();return c(e.members,t)}(o,e.typeName,r);break;case n.SyntaxKind.TypeAliasDeclaration:t=function(e,r,t){if(e.name.text!==r)return i.createUnrecognizedType();if(n.isTypeAliasDeclaration(e)&&e.type.kind!==n.SyntaxKind.TypeLiteral)return i.createUnrecognizedType();return c(e.type.members,t)}(o,e.typeName,r);break;default:return!1}return t.kind!==i.TSType.Unrecognized};return n.forEachChild(r,o),t.kind!==i.TSType.Unrecognized?t:e}({kind:i.TSType.TypeReference,typeName:t},r)}(e,r);case n.SyntaxKind.TypeLiteral:return function(e,r){var t=e.members.map((function(e){return n.isPropertySignature(e)&&n.isIdentifier(e.name)?{name:e.name.text,type:u(e.type,r)}:{name:"",type:i.createUnrecognizedType()}}));return{kind:i.TSType.TypeLiteral,propertyMembers:t}}(e,r);case n.SyntaxKind.TypeOperator:return u(e.type,r);default:return i.createUnrecognizedType()}}function p(e){return e.kind===n.SyntaxKind.TrueKeyword?{kind:i.TSType.BooleanLiteral,value:!0}:{kind:i.TSType.BooleanLiteral,value:!1}}function c(e,r){var t=e.map((function(e){return{name:e.name.text,type:a(e,r)}}));return{kind:i.TSType.TypeLiteral,propertyMembers:t}}r.parseType=a,r.parseTypeNode=u},13158:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.parseTypeModifier=void 0;var n=t(286),i=t(6279),o=t(44170),a=t(3263);function u(e){return n.isStringLiteral(e)?{kind:o.TSType.StringLiteral,value:e.text}:n.isNumericLiteral(e)?{kind:o.TSType.NumericLiteral,value:+e.text}:i.isBooleanLiteral(e)?{kind:o.TSType.BooleanLiteral,value:e.kind===n.SyntaxKind.TrueKeyword}:o.createUnrecognizedType()}r.parseTypeModifier=function(e,r){if(void 0!==e.dotDotDotToken)return{kind:o.PropertyModifierType.Rest};if(void 0!==e.questionToken)return{kind:o.PropertyModifierType.Optional};if(void 0!==e.initializer){var t=function(e,r){if(!e.initializer)return o.createUnrecognizedType();if(n.isArrayLiteralExpression(e.initializer)){var t=e.initializer.elements.map((function(e){return u(e)}));return o.isLiteralArray(t)&&e.type?{kind:o.TSType.ArrayLiteral,type:a.parseTypeNode(i.getArrayInnerType(e.type),r),value:t}:o.createUnrecognizedType()}return u(e.initializer)}(e,r);return t.kind!==o.TSType.Unrecognized?{kind:o.PropertyModifierType.Default,defaultValue:t}:o.createUnrecognizedType()}}},62887:function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FunctionModifierType=void 0,function(e){e.Async="Async",e.Export="Export",e.Declare="Declare"}(r.FunctionModifierType||(r.FunctionModifierType={}))},22369:function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MakerApiType=void 0,function(e){e.MakerSyncApi="MakerSyncApi",e.BatchApi="BatchApi"}(r.MakerApiType||(r.MakerApiType={}))},72032:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.isParsedNodesNullObj=r.createParsedNodesNullObj=r.isParsedNodeNullObj=r.createParsedNodeNullObj=void 0;var n=t(44170);function i(){return{name:"",namePosition:{start:0,end:0},type:n.createUnrecognizedType(),typePosition:{start:0,end:0}}}function o(e){return""===e.name&&0===e.namePosition.start&&0===e.namePosition.end&&e.type.kind===n.TSType.Unrecognized&&0===e.typePosition.start&&0===e.typePosition.end}r.createParsedNodeNullObj=i,r.isParsedNodeNullObj=o,r.createParsedNodesNullObj=function(){return{paramNodes:[],returnNode:i()}},r.isParsedNodesNullObj=function(e){return!e.functionModifiers&&e.paramNodes&&0===e.paramNodes.length&&o(e.returnNode)}},44170:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.hasDefaultModifier=r.hasRestParameterModifier=r.hasOptionalModifier=r.isContext=r.isLiteralArray=r.isLiteralType=r.isLiteralUnion=r.getNonUndefinedTypes=r.isOptionalUnionType=r.createVoidType=r.createUnrecognizedType=r.PropertyModifierType=r.TSType=void 0;var n,i,o=t(9685);function a(e){return e.internalTypes.filter((function(e){return e.kind!==n.Undefined}))}function u(e){return e.kind===n.StringLiteral||e.kind===n.NumericLiteral||e.kind===n.BooleanLiteral||e.kind===n.ArrayLiteral}!function(e){e.Any="Any",e.Undefined="Undefined",e.Void="Void",e.String="String",e.StringLiteral="StringLiteral",e.Boolean="Boolean",e.BooleanLiteral="BooleanLiteral",e.Number="Number",e.NumericLiteral="NumericLiteral",e.Object="Object",e.Array="Array",e.ArrayLiteral="ArrayLiteral",e.Union="Union",e.TypeReference="TypeReference",e.TypeLiteral="TypeLiteral",e.Unrecognized="Unrecognized"}(n=r.TSType||(r.TSType={})),function(e){e.Optional="Optional",e.Rest="Rest",e.Default="Default"}(i=r.PropertyModifierType||(r.PropertyModifierType={})),r.createUnrecognizedType=function(){return{kind:n.Unrecognized}},r.createVoidType=function(){return{kind:n.Void}},r.isOptionalUnionType=function(e){return 2===e.internalTypes.length&&e.internalTypes.some((function(e){return e.kind===n.Undefined}))&&a(e).length>0},r.getNonUndefinedTypes=a,r.isLiteralUnion=function(e){if(e.kind!==n.Union)return!1;var r=a(e);return!(r.length<2)&&(r.every((function(e,r,t){return e.kind===t[0].kind}))&&u(r[0]))},r.isLiteralType=u,r.isLiteralArray=function(e){return e.every((function(e){return u(e)}))},r.isContext=function(e,r){var t=e.type;return t.kind===n.TypeReference&&o.getContextType(r).includes(t.typeName)&&!t.typeArgs},r.hasOptionalModifier=function(e){return void 0!==e.modifier&&e.modifier.kind===i.Optional},r.hasRestParameterModifier=function(e){return void 0!==e.modifier&&e.modifier.kind===i.Rest},r.hasDefaultModifier=function(e){return void 0!==e.modifier&&e.modifier.kind===i.Default}},11818:function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.OBJECT_ARRAY_TYPES=void 0,r.OBJECT_ARRAY_TYPES=["Array","ReadonlyArray"]},9685:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.getContextType=void 0;var n=t(22369);r.getContextType=function(e){switch(void 0===e&&(e=n.MakerApiType.BatchApi),e){case n.MakerApiType.BatchApi:return"Excel.RequestContext";case n.MakerApiType.MakerSyncApi:return"ExcelScript.Workbook";default:return"Excel.RequestContext"}}},6279:function(e,r,t){function n(e,r){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(t)return(t=t.call(e)).next.bind(t);if(Array.isArray(e)||(t=function(e,r){if(!e)return;if("string"===typeof e)return i(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return i(e,r)}(e))||r&&e&&"number"===typeof e.length){t&&(e=t);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function i(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}Object.defineProperty(r,"__esModule",{value:!0}),r.getArrayInnerType=r.isContext=r.isBooleanLiteral=r.isAnyKeywordNode=r.isSourceFile=void 0;var o=t(286),a=t(11818),u=t(9685);function p(e){return e.kind===o.SyntaxKind.AnyKeyword}r.isSourceFile=function(e){return void 0!==e.kind},r.isAnyKeywordNode=p,r.isBooleanLiteral=function(e){return e.kind===o.SyntaxKind.TrueKeyword||e.kind===o.SyntaxKind.FalseKeyword},r.isContext=function(e,r){return o.isParameter(e)&&!!e.type&&o.isTypeReferenceNode(e.type)&&u.getContextType(r).includes(e.type.typeName.text?e.type.typeName.text:e.type.typeName.getText())},r.getArrayInnerType=function e(r){if(p(r))return r;if(o.isArrayTypeNode(r))return r.elementType;if(o.isTypeReferenceNode(r)&&a.OBJECT_ARRAY_TYPES.includes(r.typeName.text)){if(!r.typeArguments)return;return r.typeArguments[0]}if(o.isUnionTypeNode(r))for(var t,i=n(r.types);!(t=i()).done;){var u=e(t.value);if(u)return u}}},38373:function(e,r,t){function n(e,r){return n=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e},n(e,r)}Object.defineProperty(r,"__esModule",{value:!0}),r.ParameterTypeValidator=void 0;var i=t(87427),o=t(9685),a=t(72032),u=t(44170),p=function(e){var r,t;function p(r,t){var n;return(n=e.call(this,r)||this).makerApiType=t,n.parsedParameters=[],n.curParam=a.createParsedNodeNullObj(),n.parsedParameters=r.paramNodes,n.addSupportedTypeReferenceTypes(o.getContextType(t)),n}t=e,(r=p).prototype=Object.create(t.prototype),r.prototype.constructor=r,n(r,t);var c=p.prototype;return c.doValidate=function(){var e=this;this.validateContext(),this.parsedParameters.forEach((function(r){e.curParam=r,e.validateType(r.type,r.typePosition)}))},c.getErrorLabel=function(){return a.isParsedNodeNullObj(this.curParam)?"Parameter type error:":"Parameter type error for parameter '"+this.curParam.name+": "+this.curParam.type.kind+"':"},c.validateObject=function(e,r){},c.validateAny=function(e,r){},c.validateArray=function(r,t){var n=r.internalType;n.kind!==u.TSType.Object?e.prototype.validateArray.call(this,r,t):this.validateObject(n,t)},c.validateUnion=function(r,t){u.isOptionalUnionType(r)||this.validateLiteralUnion(r,t),e.prototype.validateUnion.call(this,r,t)},c.validateContext=function(){0!==this.parsedParameters.length&&u.isContext(this.parsedParameters[0],this.makerApiType)||this.createContextError()},c.createContextError=function(){var e=this.parsedParameters.length>0?this.parsedParameters[0].namePosition:this.parsedNodes.returnNode.namePosition;this.createError(i.ValidationTypeErrorCode.ContextError,"Parameter error: First parameter is required to have type: "+o.getContextType(this.makerApiType)+"'",e)},p}(t(53657).TypeValidator);r.ParameterTypeValidator=p},21473:function(e,r,t){function n(e,r){return n=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e},n(e,r)}Object.defineProperty(r,"__esModule",{value:!0}),r.ReturnTypeValidator=void 0;var i=t(44170),o=function(e){var r,t;function o(r){var t;return(t=e.call(this,r)||this).parsedReturn=r.returnNode,t}t=e,(r=o).prototype=Object.create(t.prototype),r.prototype.constructor=r,n(r,t);var a=o.prototype;return a.doValidate=function(){if(this.parsedReturn){var e=this.isPromiseType(this.parsedReturn.type)?this.parsedReturn.type.typeArgs[0]:this.parsedReturn.type;this.validateType(e,this.parsedReturn.typePosition)}},a.getErrorLabel=function(){return"Return type error:"},a.validateVoid=function(e,r){},a.isPromiseType=function(e){return e.kind===i.TSType.TypeReference&&"Promise"===e.typeName&&void 0!==e.typeArgs&&1===e.typeArgs.length},o}(t(53657).TypeValidator);r.ReturnTypeValidator=o},42870:function(e,r){function t(e){var r="function"===typeof Map?new Map:void 0;return t=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof r){if(r.has(e))return r.get(e);r.set(e,i)}function i(){return n(e,arguments,a(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),o(i,e)},t(e)}function n(e,r,t){return n=i()?Reflect.construct:function(e,r,t){var n=[null];n.push.apply(n,r);var i=new(Function.bind.apply(e,n));return t&&o(i,t.prototype),i},n.apply(null,arguments)}function i(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function o(e,r){return o=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e},o(e,r)}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}Object.defineProperty(r,"__esModule",{value:!0}),r.SignatureParserValidationError=void 0;var u=function(e){var r,t;function n(r){var t;return(t=e.call(this,r.map((function(e){return e.message})).join("\n"))||this).errors=r,Object.setPrototypeOf(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t),n.prototype),t}return t=e,(r=n).prototype=Object.create(t.prototype),r.prototype.constructor=r,o(r,t),n}(t(Error));r.SignatureParserValidationError=u},53657:function(e,r,t){function n(e,r){return n=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e},n(e,r)}Object.defineProperty(r,"__esModule",{value:!0}),r.TypeValidator=void 0;var i=t(11818),o=t(87427),a=t(44170),u=function(e){var r,t;function u(r){var t;return(t=e.call(this,r)||this).supportedTypeReferenceTypes=[].concat(i.OBJECT_ARRAY_TYPES),t}t=e,(r=u).prototype=Object.create(t.prototype),r.prototype.constructor=r,n(r,t);var p=u.prototype;return p.addSupportedTypeReferenceTypes=function(){var e;(e=this.supportedTypeReferenceTypes).push.apply(e,arguments)},p.validateType=function(e,r){switch(e.kind){case a.TSType.Any:this.validateAny(e,r);break;case a.TSType.String:case a.TSType.Number:case a.TSType.Boolean:case a.TSType.Undefined:break;case a.TSType.Void:this.validateVoid(e,r);break;case a.TSType.Object:this.validateObject(e,r);break;case a.TSType.Array:this.validateArray(e,r);break;case a.TSType.Union:this.validateUnion(e,r);break;case a.TSType.TypeReference:this.validateTypeReference(e,r);break;case a.TSType.TypeLiteral:this.validateTypeLiteral(e,r);break;case a.TSType.Unrecognized:default:e.kind===a.TSType.Unrecognized?this.createError(o.ValidationTypeErrorCode.UnrecognizableError,this.getErrorLabel()+" Type is unrecognizable",r):this.createError(o.ValidationTypeErrorCode.UnsupportedTypeError,this.getErrorLabel()+" '"+e.kind+"' is not supported",r)}},p.validateAny=function(e,r){this.createError(o.ValidationTypeErrorCode.UnsupportedTypeError,this.getErrorLabel()+" '"+e.kind+"' is not supported",r)},p.validateVoid=function(e,r){this.createError(o.ValidationTypeErrorCode.UnsupportedTypeError,this.getErrorLabel()+" '"+e.kind+"' is not supported",r)},p.validateObject=function(e,r){this.createError(o.ValidationTypeErrorCode.UnsupportedTypeError,this.getErrorLabel()+" '"+e.kind+"' is not supported. Try using an interface or type literal instead",r)},p.validateArray=function(e,r){var t=e.internalType;switch(t.kind){case a.TSType.String:case a.TSType.Number:case a.TSType.Boolean:return;case a.TSType.Union:return void this.validateUnion(t,r);case a.TSType.TypeLiteral:return void this.validateTypeLiteral(t,r);case a.TSType.Array:return void this.validateArray(t,r);case a.TSType.TypeReference:if(i.OBJECT_ARRAY_TYPES.includes(t.typeName)){if(!t.typeArgs)return void this.createError(o.ValidationTypeErrorCode.ArrayTypeError,this.getErrorLabel()+"'"+t.typeName+"' requires type args.",r);var n={kind:a.TSType.Array,internalType:t.typeArgs[0]};return void this.validateArray(n,r)}default:this.createError(o.ValidationTypeErrorCode.ArrayTypeError,this.getErrorLabel()+" '"+t.kind+"' is not a valid array type.",r)}},p.validateUnion=function(e,r){if(a.isOptionalUnionType(e)){var t=a.getNonUndefinedTypes(e)[0];this.validateType(t,r)}},p.validateLiteralUnion=function(e,r){a.isLiteralUnion(e)||this.createError(o.ValidationTypeErrorCode.UnionTypeError,this.getErrorLabel()+" Union type required to be in format 'type | "+a.TSType.Undefined+"' or a union of homogenous literals.",r)},p.validateTypeReference=function(e,r){if(this.supportedTypeReferenceTypes.includes(e.typeName))if(i.OBJECT_ARRAY_TYPES.includes(e.typeName)){if(!e.typeArgs)return void this.createError(o.ValidationTypeErrorCode.TypeReferenceTypeError,this.getErrorLabel()+"'"+e.typeName+"' requires type args.",r);var t={kind:a.TSType.Array,internalType:e.typeArgs[0]};this.validateArray(t,r)}else;else this.createError(o.ValidationTypeErrorCode.TypeReferenceTypeError,this.getErrorLabel()+" Non primitive type '"+e.typeName+"' is not supported.",r)},p.validateTypeLiteral=function(e,r){var t=this;e.propertyMembers.forEach((function(e){switch(e.type.kind){case a.TSType.String:case a.TSType.Number:case a.TSType.Boolean:return;case a.TSType.Array:return void t.validateArray(e.type,r);case a.TSType.Union:return void t.validateUnion(e.type,r);case a.TSType.TypeReference:return void t.validateTypeReference(e.type,r);case a.TSType.TypeLiteral:return void t.validateTypeLiteral(e.type,r);default:t.createError(o.ValidationTypeErrorCode.TypeLiteralTypeError,t.getErrorLabel()+" Type literal contains invalid type '"+e.type.kind+"'.",r)}}))},u}(t(5123).Validator);r.TypeValidator=u},5123:function(e,r,t){function n(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(r,"__esModule",{value:!0}),r.Validator=void 0;var i=t(72032),o=t(42870),a=function(){function e(e){this.parsedNodes=e,this.mErrors=[]}var r,t,a,u=e.prototype;return u.validate=function(){i.isParsedNodesNullObj(this.parsedNodes)||this.doValidate()},u.throwErrors=function(){throw new o.SignatureParserValidationError(this.mErrors)},u.printErrors=function(){console.log(this.mErrors.map((function(e){return JSON.stringify(e,null,2)})).join("\n"))},u.createError=function(r,t,n){t="["+e.ERROR_MESSAGE_DESCRIPTOR+"] "+t,this.mErrors.push({code:r,message:t,position:n})},r=e,(t=[{key:"errors",get:function(){return this.mErrors}}])&&n(r.prototype,t),a&&n(r,a),Object.defineProperty(r,"prototype",{writable:!1}),e}();r.Validator=a,a.ERROR_MESSAGE_DESCRIPTOR="Power automate incompatibility error"},25322:function(e,r,t){function n(e,r){return n=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e},n(e,r)}Object.defineProperty(r,"__esModule",{value:!0}),r.ModifierValidator=void 0;var i=t(87427),o=t(62887),a=function(e){var r,t;function a(r){var t;return(t=e.call(this,r)||this).parsedModifiers=r.functionModifiers,t}t=e,(r=a).prototype=Object.create(t.prototype),r.prototype.constructor=r,n(r,t);var u=a.prototype;return u.doValidate=function(){var e=this;this.parsedModifiers&&this.parsedModifiers.forEach((function(r){r.kind!==o.FunctionModifierType.Async&&e.createError(i.ValidationTypeErrorCode.ModifierError,e.getErrorLabel()+" Function can not have modifier '"+r+"'.",r.position)}))},u.getErrorLabel=function(){return"Modifier error:"},a}(t(5123).Validator);r.ModifierValidator=a},87427:function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ValidationTypeErrorCode=void 0,function(e){e.UnrecognizableError="UnrecognizableError",e.UnsupportedTypeError="UnsupportedError",e.ArrayTypeError="ArrayTypeError",e.UnionTypeError="UnionTypeError",e.TypeReferenceTypeError="TypeReferenceError",e.TypeLiteralTypeError="TypeLiteralTypeError",e.ContextError="ContextError",e.ModifierError="ModifierError",e.NoTargetFunctionError="NoTargetFunctionError"}(r.ValidationTypeErrorCode||(r.ValidationTypeErrorCode={}))},71395:function(e,r,t){function n(e,r){return n=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e},n(e,r)}Object.defineProperty(r,"__esModule",{value:!0}),r.FlowParameterTranslator=void 0;var i=t(44170),o=t(16385),a=function(e){var r,t;function a(){return e.apply(this,arguments)||this}t=e,(r=a).prototype=Object.create(t.prototype),r.prototype.constructor=r,n(r,t);var u=a.prototype;return u.translateObjectType=function(e){return{type:o.FlowType.Object}},u.translateUnionType=function(e){var r=i.getNonUndefinedTypes(e);if(i.isOptionalUnionType(e))return this.translateToFlowType(r[0]);if(i.isLiteralUnion(e))switch(r[0].kind){case i.TSType.StringLiteral:var t=r.map((function(e){return e.value}));return{type:o.FlowType.String,enum:t};case i.TSType.NumericLiteral:var n=r.map((function(e){return e.value}));return{type:o.FlowType.Number,enum:n};case i.TSType.BooleanLiteral:return{type:o.FlowType.Boolean}}return o.createUnrecognizedType()},a}(t(22131).FlowTranslator);r.FlowParameterTranslator=a},87025:function(e,r,t){function n(e,r){return n=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e},n(e,r)}Object.defineProperty(r,"__esModule",{value:!0}),r.FlowReturnTranslator=void 0;var i=t(44170),o=t(16385),a=function(e){var r,t;function a(){return e.apply(this,arguments)||this}t=e,(r=a).prototype=Object.create(t.prototype),r.prototype.constructor=r,n(r,t);var u=a.prototype;return u.translateUnionType=function(e){var r=i.getNonUndefinedTypes(e);if(i.isOptionalUnionType(e))return this.translateToFlowType(r[0]);if(i.isLiteralUnion(e))switch(r[0].kind){case i.TSType.StringLiteral:return{type:o.FlowType.String};case i.TSType.NumericLiteral:return{type:o.FlowType.Number};case i.TSType.BooleanLiteral:return{type:o.FlowType.Boolean};default:return o.createUnrecognizedType()}return{}},u.translateTypeReference=function(r){return"Promise"===r.typeName?this.translateTypeReferenceTypeArgs(r):e.prototype.translateTypeReference.call(this,r)},a}(t(22131).FlowTranslator);r.FlowReturnTranslator=a},22131:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.FlowTranslator=void 0;var n=t(11818),i=t(44170),o=t(16385),a=function(){function e(e){this.nodeToTranslate=e}var r=e.prototype;return r.translate=function(){return this.nodeToTranslate?this.translateToFlowNode(this.nodeToTranslate.type):o.createUnrecognizedType()},r.translateToFlowNode=function(e){var r=this.translateToFlowType(e);return Object.assign(r,this.translateModifier(e)),r},r.translateToFlowType=function(e){switch(e.kind){case i.TSType.Any:return{};case i.TSType.String:return{type:o.FlowType.String};case i.TSType.Number:return{type:o.FlowType.Number};case i.TSType.Boolean:return{type:o.FlowType.Boolean};case i.TSType.Object:return this.translateObjectType(e);case i.TSType.Array:return this.translateArrayType(e);case i.TSType.Union:return this.translateUnionType(e);case i.TSType.TypeReference:return this.translateTypeReference(e);case i.TSType.TypeLiteral:return this.translateTypeLiteral(e);default:return o.createUnrecognizedType()}},r.translateObjectType=function(e){return o.createUnrecognizedType()},r.translateArrayType=function(e){return{type:o.FlowType.Array,items:this.translateToFlowType(e.internalType)}},r.translateUnionType=function(e){return o.createUnrecognizedType()},r.translateTypeReference=function(e){var r=e.typeName;return n.OBJECT_ARRAY_TYPES.includes(r)?{type:o.FlowType.Array,items:this.translateTypeReferenceTypeArgs(e)}:o.createUnrecognizedType()},r.translateTypeLiteral=function(e){var r=this;if(e.propertyMembers.length<1)return o.createUnrecognizedType();var t=e.propertyMembers.map((function(e){var t;return(t={})[e.name]=r.translateToFlowType(e.type),t}));return{type:o.FlowType.Object,properties:Object.assign.apply(Object,[{}].concat(t))}},r.translateTypeReferenceTypeArgs=function(e){return e.typeArgs?this.translateToFlowType(e.typeArgs[0]):o.createUnrecognizedType()},r.translateModifier=function(e){if(e.modifier)return e.modifier.kind===i.PropertyModifierType.Default?e.modifier.defaultValue.kind===i.TSType.ArrayLiteral?{default:e.modifier.defaultValue.value.map((function(e){return e.value}))}:{default:e.modifier.defaultValue.value}:void 0},e}();r.FlowTranslator=a},53468:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.writeReturnToFlow=r.writeParameterToFlow=void 0;var n=t(64068),i=t(44170),o=t(71395),a=t(87025),u=t(28531),p=t(16385);r.writeParameterToFlow=function(e,r){var t,n=e.map((function(e){var r,t=new o.FlowParameterTranslator(e);return(r={})[e.name]=t.translate(),r})).filter((function(e){return Object.values(e).every((function(e){return!p.containsUnrecognizableFlowType(e)}))}));if(0===n.length)return u.createFlowParameterSchemaNullObj();var a=function(e,r,t){return r.filter((function(e){return!(void 0!==(r=e.type).modifier&&r.modifier.kind===i.PropertyModifierType.Optional)&&!function(e){return e.kind===i.TSType.Union&&e.internalTypes.map((function(e){return e.kind})).includes(i.TSType.Undefined)}(e.type)&&!i.isContext(e,t);var r})).map((function(e){return e.name})).filter((function(r){return e.includes(r)}))}((t=[]).concat.apply(t,n.map((function(e){return Object.keys(e)}))),e,r);return{type:"object",required:a,properties:Object.assign.apply(Object,[{}].concat(n))}},r.writeReturnToFlow=function(e){var r,t=new a.FlowReturnTranslator(e).translate();return p.containsUnrecognizableFlowType(t)?u.createFlowReturnSchemaNullObj():{type:"object",properties:(r={},r[n.ROOT_RETURN_PROPERTY_NAME]=t,r)}}},64068:function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ROOT_RETURN_PROPERTY_NAME=void 0,r.ROOT_RETURN_PROPERTY_NAME="result"},28531:function(e,r){function t(){return{type:"object",properties:{}}}Object.defineProperty(r,"__esModule",{value:!0}),r.isFlowReturnSchemaNullObj=r.createFlowReturnSchemaNullObj=r.createFlowParameterSchemaNullObj=void 0,r.createFlowParameterSchemaNullObj=function(){return{type:"object",default:{},"x-ms-visibility":"internal"}},r.createFlowReturnSchemaNullObj=t,r.isFlowReturnSchemaNullObj=function(e){return JSON.stringify(e)===JSON.stringify({type:"object",properties:{}})}},16385:function(e,r){var t;function n(e){return void 0!==e.type}Object.defineProperty(r,"__esModule",{value:!0}),r.containsUnrecognizableFlowType=r.createUnrecognizedType=r.isNormalFlowTypeNode=r.FlowType=void 0,function(e){e.String="string",e.Number="number",e.Boolean="boolean",e.Array="array",e.Unrecognized="unrecognized",e.Object="object"}(t=r.FlowType||(r.FlowType={})),r.isNormalFlowTypeNode=n,r.createUnrecognizedType=function(){return{type:t.Unrecognized}},r.containsUnrecognizableFlowType=function e(r){if(!n(r))return!1;if(r.type===t.Unrecognized)return!0;switch(r.type){case t.Array:return e(r.items);case t.Object:return!!r.properties&&Object.values(r.properties).some((function(r){return e(r)}));default:return!1}}}}]);
//# sourceMappingURL=parser.67ec6fba.chunk.js.map