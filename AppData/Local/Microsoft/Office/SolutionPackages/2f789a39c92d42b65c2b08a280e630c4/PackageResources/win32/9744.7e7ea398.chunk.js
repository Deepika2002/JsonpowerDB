"use strict";(self.webpackChunkmaker_code_editor=self.webpackChunkmaker_code_editor||[]).push([[9744],{98425:function(e,t,n){n.d(t,{Z:function(){return h}});var r=n(84586),i=n(14979),a=n(44696),o=n(79628),s=n(58351);var c=n(67796),u=n(32613),l=n(38104),d=n(90271),p=n(21914),f=n(34961),g=n(81066),h=(0,r.Zz)((function(e){var t=e.theme,n=e.scriptHasUnsavedChanges,r=e.isPointerCursor,h=e.script,b=e.shouldSplit,y=(0,c.a)(h)||(0,u.H)(h)?void 0:function(e){if(e.storageScript.fileUrl){var t=e.storageScript.fileUrl.lastIndexOf("/");if(-1!=t)return e.storageScript.fileUrl.slice(0,t)}(0,s.m)(new Error("Failed to get folder URL from script, the script does not have valid file URL."),s.in.Debug,{storageId:e.storageScript.id})}(h),w=l.E.instance().getCachedValue((0,f.O3)(),h),S=(0,p.useState)(""),x=S[0],k=S[1],R=(0,p.useState)(!((0,c.a)(h)||w||b)),P=R[0],C=R[1];return(0,p.useLayoutEffect)((function(){(0,c.a)(h)?k(strings.Backstage.ScriptItemSamplesRootFolderText+" \xbb ... \xbb Office Scripts"):b?k((0,l.R)(h.storageScript)):P||k(w)}),[]),(0,p.useEffect)((function(){P&&l.E.instance().getBreadcrumb((0,f.O3)(),h).then((function(e){k(e),C(!1)}))}),[]),p.createElement(p.Fragment,null,P?p.createElement(v,null,p.createElement(d.q,{shimmerColors:m(t),styles:{root:{width:"100%"}}})):n?p.createElement(i._,{styles:(0,o.dz)(t,r,n),"aria-hidden":"true"},strings.Backstage.ScriptItemUnsavedChangesText):x?y&&g.X.instance().isTeamOwnershipUXEnabled()?p.createElement(v,null,p.createElement(a.r,{href:y,target:"_blank",styles:(0,o.dz)(t,r,n),"aria-hidden":"true",onClick:function(e){(0,s.ve)({eventName:"ControlAction",eventType:"User",data:{control:"FolderPath",storageId:h.storageScript.id}}),e.stopPropagation()}},x)):p.createElement(v,null,p.createElement(i._,{styles:(0,o.dz)(t,r,n),"aria-hidden":"true"},x)):p.createElement(p.Fragment,null))})),m=function(e){return{shimmer:e.colors.neutralQuaternaryAlt,shimmerWave:e.colors.neutralQuaternary,background:e.colors.neutralLight}},v=r.ZP.div.withConfig({displayName:"Breadcrumb__FlexWrapper",componentId:"u6bze4-0"})(["display:flex;text-overflow:ellipsis;"])},63746:function(e,t,n){var r=n(14979),i=n(74513),a=n(92198),o=n(78015),s=n(21914);function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}t.Z=function(e){var t=e.message,n=e.ariaLabel,c=e.uniqueUserInfos,l=e.isUserNamesHovered,d=e.isUserNamesFocused,g=e.isCalloutVisible,h=e.setIsUserNamesHovered,m=e.setIsUserNamesFocused,v=e.setIsCalloutVisible,b=e.modifiedByUserNames,y=e.theme,w=t.indexOf("${userNames}"),S=s.createElement("strong",null,s.createElement("u",{onMouseEnter:function(){h(!0)},onMouseLeave:function(){h(!1)},onFocus:function(){m(!0)},onBlur:function(){m(!1)},onClick:function(){v(!0)},onKeyDown:function(e){"Enter"!==e.key&&" "!==e.key||v(!0)},style:f(l,d,y),id:"OfficeScriptConsentDialogUserNamesButton",tabIndex:0,role:"button","aria-label":n},b));return s.createElement(s.Fragment,null,s.createElement(r._,{styles:p(y)},s.createElement("div",null,w>0&&t.slice(0,w),S,w+12<t.length&&t.slice(w+12))),s.createElement(s.Fragment,null,g?s.createElement(i.U,{target:"#OfficeScriptConsentDialogUserNamesButton",onDismiss:function(){v(!1)},directionalHint:a.b.bottomLeftEdge,setInitialFocus:!0},s.createElement(o.a,{items:c,onRenderCell:function(e,t){return e?s.createElement(u,{userInfo:e,index:t,theme:y}):null}})):null))};var u=function(e){var t=e.userInfo,n=e.index,i=e.theme,a=(0,s.useState)(!1),o=a[0],c=a[1];return s.createElement("div",{key:t.lastModifiedByUserEmail,role:"button",tabIndex:0,style:l(0===n,o,i),onFocus:function(){c(!0)},onBlur:function(){c(!1)},onKeyDown:function(){}},s.createElement(r._,{styles:p(i),role:"listitem"},t.lastModifiedByUserName),s.createElement(r._,{styles:d(i),role:"listitem"},t.lastModifiedByUserEmail))},l=function(e,t,n){var r={display:"block",padding:e?"10px":"0 10px 10px",margin:"2px"};return t?c({},r,{outline:"1px solid "+n.colors.neutralSecondary}):r},d=function(e){return{root:{color:e.colors.neutralSecondaryLight,fontWeight:e.fontWeights.regular,padding:"0 0 5px 0"}}},p=function(e){return{root:{fontWeight:e.fontWeights.regular}}},f=function(e,t,n){return t?{outline:"1px solid "+n.colors.neutralSecondary}:e?{cursor:"pointer"}:void 0}},76293:function(e,t,n){var r,i,a,o,s,c=n(21914),u=n(84586),l=n(81329),d=n(78574),p=n(32225),f=n(57776),g=n(40608),h=n(14979),m=n(44696),v=n(99072),b=n(32641),y=n(21830),w=n(49225),S=n(57222),x=n(26634),k=n(98425),R=n(58351),P=n(67796),C=n(32613),I=n(63746),O=n(84824),T=n(97650),E=n(19885),D=n(8855),M=n(90828),j=n(35826),L=n(52105),N=n(81066),B=n(57464);function F(e,t){return t||(t=e.slice(0)),e.raw=t,e}function A(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function U(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){A(a,r,i,o,s,"next",e)}function s(e){A(a,r,i,o,s,"throw",e)}o(void 0)}))}}t.ZP=(0,u.Zz)((function(e){var t=e.script,n=e.isOpen,r=e.hideConsentDialog,i=e.viewScript,a=e.theme,o=z(),s=_(o,t,n),u=s.length>0,p=(0,c.useState)(!1),y=p[0],x=p[1],P=(0,c.useState)(!1),C=P[0],F=P[1],A=(0,c.useState)(!1),J=A[0],K=A[1];if(!t||!u)return null;var $=(0,E.L)(s),Y=(0,T.N)($),ee=!!i,te=strings.substitute(strings.Backstage.ScriptItemUserOwnedOneDriveRootFolderText,{creator:t.storageScript.creatorDisplayName||""});return c.createElement(l.V,{hidden:!n,onDismiss:function(){S.t.instance().revokeOrCancelConsent(t,!0),r()},dialogContentProps:V(a),modalProps:{isBlocking:!1,styles:(0,w.De)()},minWidth:"340px"},c.createElement(H,null,ee?c.createElement(Z,null,c.createElement(W,null,c.createElement(f.J,{iconName:(0,O.o)(t)?"OfficeScriptsSharedIcon32":"OfficeScriptsIcon32"}),c.createElement(G,{onClick:function(){(0,R.ve)({eventName:"ControlAction",eventType:"User",data:{control:"ConsentDialog",operationType:"OpenScript",storageId:t.storageScript.id}}),i&&i(t)}},c.createElement(h._,{styles:X(a)},t.storageScript.name),N.X.instance().isTeamOwnershipUXEnabled()||(0,B.$)(t)?c.createElement(k.Z,{script:t,isPointerCursor:!0,shouldSplit:!N.X.instance().isTeamOwnershipUXEnabled()||"Editor"!==(0,L.L3)()||"Attached"===M.w.backstage.getCurrentPivot((0,j.v)().getState())}):c.createElement(b.Z,{rootFolder:te,isPointerCursor:!0,showSubFolder:!0})))):c.createElement(W,null,c.createElement(f.J,{iconName:(0,O.o)(t)?"OfficeScriptsSharedIcon32":"OfficeScriptsIcon32"}),c.createElement(G,null,c.createElement(h._,{styles:X(a)},t.storageScript.name),N.X.instance().isTeamOwnershipUXEnabled()||(0,B.$)(t)?c.createElement(k.Z,{script:t,isPointerCursor:!0,shouldSplit:!N.X.instance().isTeamOwnershipUXEnabled()||"Editor"!==(0,L.L3)()||"Attached"===M.w.backstage.getCurrentPivot((0,j.v)().getState())}):c.createElement(b.Z,{rootFolder:te,isPointerCursor:!0,showSubFolder:!0}))),c.createElement(q,null,c.createElement(I.Z,{message:strings.Dialog.ConsentLastModifiedMessage,ariaLabel:strings.Dialog.ConsentLastModifiedUsersAriaLabel,uniqueUserInfos:$,isUserNamesHovered:C,isUserNamesFocused:J,isCalloutVisible:y,setIsUserNamesHovered:F,setIsUserNamesFocused:K,setIsCalloutVisible:x,modifiedByUserNames:Y,theme:a})),c.createElement(h._,{styles:{root:{fontWeight:a.fontWeights.regular}}},strings.Dialog.ConsentScopesListHeader),c.createElement("ul",{style:{margin:"0 "+a.spacing.mediumPlus+" 0"}},D.d.map((function(e,t){return c.createElement("li",{key:t},c.createElement(h._,{styles:{root:{display:"inline",fontWeight:a.fontWeights.regular}}},e.text),c.createElement(v.h,{iconProps:{iconName:"Info"},onClick:function(){return window.open(e.infoLink,"_blank")},styles:{root:{marginLeft:0,cursor:"pointer",color:a.colors.neutralSecondary,verticalAlign:"middle",paddingBottom:"0.1rem"}},ariaLabel:strings.substitute(strings.Dialog.ConsentViewScopeDetailAriaLabel,{scope:e.text}),role:"link"}))}))),c.createElement(h._,{styles:{root:{fontWeight:a.fontWeights.regular}}},strings.Dialog.ConsentIfYouAllowExplanation),c.createElement(m.r,{href:"https://aka.ms/office-scripting-overview",target:"_blank",styles:Q(a),role:"link"},strings.Dialog.ConsentLearnAboutOfficeScriptingLinkText)),c.createElement(d.c,null,c.createElement(g.Z,{text:strings.Dialog.ConsentAllowButtonText,ariaLabel:strings.Dialog.ConsentAllowButtonText,ariaDescription:strings.Dialog.ConsentAllowButtonAriaDescription,onClick:U(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.t.instance().acceptConsent(t);case 2:r();case 3:case"end":return e.stop()}}),e)}))),primary:!0,role:"button"}),c.createElement(g.Z,{text:strings.Dialog.ConsentDenyButtonText,ariaLabel:strings.Dialog.ConsentDenyButtonText,ariaDescription:strings.Dialog.ConsentDenyButtonAriaDescription,onClick:U(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:S.t.instance().revokeOrCancelConsent(t),r();case 2:case"end":return e.stop()}}),e)}))),role:"button"})))}));var z=function(){var e=(0,c.useRef)(!1);return(0,c.useEffect)((function(){return e.current=!0,function(){e.current=!1}}),[]),e},_=function(e,t,n){var r=(0,c.useState)([]),i=r[0],a=r[1];return(0,c.useEffect)((function(){!t||(0,P.a)(t)||(0,C.H)(t)||x.T.instance().getValue(t).then((function(t){e.current&&a(t)})).catch((function(){}))}),[e,t,n]),i},H=u.ZP.div(r||(r=F(["\n  margin-bottom: ",";\n"])),(function(e){return e.theme.spacing.mediumPlus})),W=u.ZP.div(i||(i=F(["\n  display: flex;\n  align-items: center;\n"]))),Z=u.ZP.div(a||(a=F(["\n  cursor: pointer;\n  padding: ",";\n  margin: ",";\n\n  &:hover {\n    background: ",";\n  }\n\n  &:focus {\n    background: ",";\n    outline: none;\n  }\n"])),(function(e){return e.theme.spacing.xSmall+" "+e.theme.spacing.small}),(function(e){return"0 -"+e.theme.spacing.small}),(function(e){return e.theme.colors.neutralQuaternaryAlt}),(function(e){return e.theme.colors.neutralTertiaryAlt})),G=u.ZP.div(o||(o=F(["\n  padding: ",";\n  width: 100%;\n  overflow: hidden;\n"])),(function(e){return(0,y.zg)()?"0 "+e.theme.spacing.medium+" 0 0":"0 0 0 "+e.theme.spacing.medium})),V=function(e){return{type:p.i.normal,title:strings.Dialog.ConsentRunPermissionsHeader,styles:{title:{fontSize:e.fontSizes.large,fontWeight:e.fontWeights.semibold,color:e.colors.primary},content:{backgroundColor:e.colors.neutralLight}}}},X=function(e){return{root:{fontSize:e.fontSizes.medium,fontWeight:e.fontWeights.semibold,padding:0,overflow:"hidden"}}},Q=function(e){return{root:{marginTop:e.spacing.smallPlus,display:"inline-block",color:e.colors.linkText,selectors:{":focus":{color:e.colors.linkText,outline:"none !important"},":hover":{color:e.colors.linkTextHovered,textDecoration:"underline"}}}}},q=u.ZP.div(s||(s=F(["\n  display: flex;\n  align-items: center;\n  margin: 0 0 ",";\n  padding-bottom: ",";\n  border-bottom: 1px solid ",";\n"])),(function(e){return e.theme.spacing.small}),(function(e){return e.theme.spacing.xSmall}),(function(e){return e.theme.colors.neutralLighter}))},21849:function(e,t,n){n.d(t,{Z:function(){return I}});var r=n(84586),i=n(21914),a=n(66640),o=n.n(a),s=n(15592),c=n(54050),u=n(98642).ObjectInspector,l=function(e){var t=e.obj,n=function(e){var t="chromeLight";switch(e){case"Dark Gray":case"Black":t="chromeDark"}return t}((0,s.M)((0,c.Zd)()));return t&&t.toJSON?i.createElement(u,{data:t.toJSON()}):"undefined"!==typeof OfficeExtension&&t instanceof OfficeExtension.Error?i.createElement(u,{theme:n,data:t,expandPaths:["$","$.debugInfo","$.debugInfo.surroundingStatements"]}):o()(t)?i.createElement(u,{theme:n,data:t,showNonenumerable:!0,expandLevel:1,sortObjectKeys:d}):i.createElement(u,{theme:n,data:t})};function d(e,t){return"stack"===e?1:"stack"===t||e<t?-1:e>t?1:0}var p=n(22100),f=n(57776),g=n(21830),h=n(7765),m=n(30747),v=n(58351),b=n(49225);function y(){return y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},y.apply(this,arguments)}var w,S=0,x=(0,r.Zz)((function(e){var t,n=e.severity,r=e.message,a=e.theme;S++,w||(w=new v.pX("LogItem","System"));var o=(0,p.Z)(r),s=o.length,c="object"===typeof r?"object":"string";if("object"===c){s>1e5&&(r=o)}(0,i.useEffect)((function(){w.ended()||w.succeed(v.in.Information,{messageType:c,messageLength:s})}),[c,s]);var u={backgroundColor:a.colors.neutralLight,borderColor:a.colors.neutralLight,color:a.colors.text,icon:{name:"Log",color:a.colors.neutralSecondaryLight,tooltipText:void 0},ariaLabel:strings.substitute(strings.Editor.InfoConsoleLogLabel,{logText:o})},d=(t={},t[m.xj.Log]=y({},u),t[m.xj.Info]=y({},u,{icon:{name:"Info",color:a.colors.infoIcon},ariaLabel:strings.substitute(strings.Editor.InfoConsoleLogLabel,{logText:o})}),t[m.xj.Warn]=y({},u,{icon:{name:"Warning",color:a.colors.warningIcon,tooltipText:strings.Editor.WarningConsoleLogTooltip},ariaLabel:strings.substitute(strings.Editor.WarningConsoleLogLabel,{logText:o})}),t[m.xj.Error]=y({},u,{icon:{name:"Error",color:a.colors.errorIcon,tooltipText:strings.Editor.ErrorConsoleLogTooltip},ariaLabel:strings.substitute(strings.Editor.ErrorConsoleLogLabel,{logText:o})}),t)[n],g=d.backgroundColor,x=d.borderColor,C=d.color,I=d.icon,O=d.ariaLabel;return i.createElement(R,{backgroundColor:g,color:C,borderColor:x,role:"listitem","aria-label":O,tabIndex:0,dir:"ltr","data-is-focusable":!0},I&&i.createElement(h.G,{content:I.tooltipText?I.tooltipText:"",id:"log-item-"+S+"-tooltip",styles:k(a,I.color),calloutProps:(0,b.FA)(a)},i.createElement(f.J,{iconName:I.name,"aria-describedby":I.tooltipText?"log-item-"+S+"-tooltip":void 0})),"object"===typeof r?i.createElement(l,{obj:r}):i.createElement(P,{dir:"ltr"},(0,p.Z)(r)))})),k=function(e,t){return{root:{margin:(0,g.zg)()?"0 0 0 "+e.spacing.smallPlus:"0 "+e.spacing.smallPlus+" 0 0",fontSize:e.fontSizes.small,height:"16px",color:t}}},R=r.ZP.li.withConfig({displayName:"LogItem__LogEntry",componentId:"sc-15co0cx-0"})(["display:flex;align-items:center;vertical-align:middle;position:relative;width:100%;min-height:2.4rem;padding:"," ",";margin-bottom:",";font-family:monospace;color:",";background-color:",";border-top:0.5px solid ",";border-bottom:0.5px solid ",";overflow-wrap:break-word;word-wrap:break-word;& *{background:",";}&:focus{outline:0.1rem solid ",";}"],(function(e){return e.theme.spacing.xSmall}),(function(e){return e.theme.spacing.small}),(function(e){return e.theme.spacing.xSmall}),(function(e){return e.color}),(function(e){return e.backgroundColor}),(function(e){return e.borderColor}),(function(e){return e.borderColor}),(function(e){return e.backgroundColor}),(function(e){return e.theme.colors.neutralSecondary})),P=r.ZP.pre.withConfig({displayName:"LogItem__LogText",componentId:"sc-15co0cx-1"})(["white-space:pre-wrap;word-wrap:break-word;font-size:",";width:100%;line-height:1.2rem;text-align:left;"],(function(e){return e.theme.fontSizes.small})),C=n(57158),I=(0,r.Zz)((function(e){var t=e.logs.slice(-500).map((function(e){var t=e.id,n=e.severity,r=e.message;return i.createElement(x,{key:t,severity:n,message:r})}));return i.createElement(C.k,{"data-testid":e["data-testid"],role:"list",style:O(e.theme)},t)})),O=function(e){return{padding:"0.6rem 0.1rem",maxHeight:"100%",overflowX:"hidden",overflowY:"auto",background:e.colors.neutralLight}}},88061:function(e,t,n){var r,i,a=n(84586),o=n(21914),s=n(99072),c=n(31378),u=n(60146),l=n(20968),d=n(7765),p=n(58351),f=n(49225);function g(){return g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},g.apply(this,arguments)}!function(e){e.Output="Output",e.Problems="Problems",e.Help="Help"}(r||(r={})),function(e){e.Expanded="70%",e.Default="30%",e.Minimized="5%"}(i||(i={}));t.ZP=(0,a.Zz)((function(e){var t=e.pivotBarItems,n=e.pivotPages,r=e.currentPivotKey,a=e.shouldFocusBottomPanel,S=e.setShouldFocusBottomPanel,x=e.hideBottomPanel,k=e.setCurrentPivotKey,R=e.allowClose,P=e.allowMinimize,C=e.theme,I=(0,o.useState)(i.Default),O=I[0],T=I[1],E=O===i.Minimized,D=y(O,P),M=r||Object.keys(n)[0];return(0,o.useEffect)((function(){(0,p.sM)("Console","Console",M)}),[r]),o.createElement(w,{"data-testid":(0,u.k)("BottomPanel"),panelHeight:O},o.createElement(h,null,o.createElement(m,null,!E&&o.createElement(c.Z,{selectedKey:M,onSelect:k,items:t,shouldFocus:a,setShouldFocus:function(e){return S(e)}})),o.createElement(v,null,D.map((function(e,t){return o.createElement(d.G,{id:"ExpandCollapseIcon-tooltip",content:e.resizeText,key:t,calloutProps:(0,f.FA)(C)},o.createElement(s.h,{"data-testid":(0,u.k)("BottomPanelExpandCollapse"),iconProps:{iconName:e.resizeIcon},ariaLabel:e.resizeText,onClick:function(){T(e.newPanelSize)},styles:g({},(0,l.EM)(C,!1),b(C)),"aria-describedby":"ExpandCollapseIcon-tooltip"}))})),R&&o.createElement(d.G,{id:(0,u.k)("BottomPanelClose")+"-tooltip",content:strings.General.CloseButtonLabel,calloutProps:(0,f.FA)(C)},o.createElement(s.h,{"data-testid":(0,u.k)("BottomPanelClose"),iconProps:{iconName:"Cancel"},ariaLabel:strings.General.CloseButtonLabel,onClick:x,styles:g({},(0,l.EM)(C,!1),b(C)),"aria-describedby":(0,u.k)("BottomPanelClose")+"-tooltip"})))),!E&&n[M])}));var h=a.ZP.div.withConfig({displayName:"Console__FlexWrapper",componentId:"dfh6kv-0"})(["display:flex;align-items:flex-start;"]),m=a.ZP.div.withConfig({displayName:"Console__PushLeft",componentId:"dfh6kv-1"})(["flex-grow:1;"]),v=a.ZP.div.withConfig({displayName:"Console__PullRight",componentId:"dfh6kv-2"})(["display:flex;"]),b=function(e){return{root:{padding:0,fontSize:e.fontSizes.mini,color:e.colors.neutralDarker,width:"20px",height:"20px"},icon:{fontSize:e.fontSizes.mini}}},y=function(e,t){var n;switch(e){case i.Expanded:n=[{resizeIcon:"ChevronDown",resizeText:strings.General.CollapseText,newPanelSize:i.Default}];break;case i.Minimized:n=[{resizeIcon:"ChevronUp",resizeText:strings.General.ExpandText,newPanelSize:i.Default}];break;case i.Default:default:n=[{resizeIcon:"ChevronUp",resizeText:strings.General.ExpandText,newPanelSize:i.Expanded}],t&&n.push({resizeIcon:"ChevronDown",resizeText:strings.General.CollapseText,newPanelSize:i.Minimized})}return n},w=a.ZP.div.withConfig({displayName:"Console__BottomPanelWrapper",componentId:"dfh6kv-3"})(["display:flex;flex-direction:column;background-color:",";border-top:0.5px solid ",";height:",";max-height:",";width:100%;position:absolute;bottom:3.2rem;padding:"," ",";"],(function(e){return e.theme.colors.neutralLight}),(function(e){return e.theme.colors.neutralTertiaryAlt}),(function(e){return e.panelHeight}),(function(e){return e.panelHeight}),(function(e){return e.theme.spacing.xSmall}),(function(e){return e.theme.spacing.small}))},30747:function(e,t,n){var r;n.d(t,{xj:function(){return r},LT:function(){return a},NX:function(){return o},e3:function(){return s},Fh:function(){return i}}),function(e){e.Info="info",e.Log="log",e.Warn="warn",e.Error="error"}(r||(r={}));var i,a={id:"contextualHelpLearnMore",title:strings.Editor.LearnMoreDocsLink,link:"https://go.microsoft.com/fwlink/p/?LinkId=2135335"},o=["contextualHelpTableOrChart","contextualHelpRange","contextualHelpWorkbook","contextualHelpPivotTable"],s=[{id:"contextualHelpTableOrChart",title:strings.Editor.CreateTableOrChartDocsLink,link:"https://go.microsoft.com/fwlink/p/?LinkId=2139464"},{id:"contextualHelpRange",title:strings.Editor.ApplyFunctionToRangeDocsLink,link:"https://go.microsoft.com/fwlink/p/?LinkId=2139375"},{id:"contextualHelpWorkbook",title:strings.Editor.MakeChangesToWorkbookDocsLink,link:"https://go.microsoft.com/fwlink/p/?LinkId=2139465"},{id:"contextualHelpPivotTable",title:strings.Editor.PivotTableDocsLink,link:"https://go.microsoft.com/fwlink/p/?LinkId=2139466"},{id:"contextualHelpChart",title:strings.Editor.ChartDocsLink,link:"https://go.microsoft.com/fwlink/p/?LinkId=2141308"},{id:"contextualHelpComment",title:strings.Editor.CommentDocsLink,link:"https://go.microsoft.com/fwlink/p/?LinkId=2141307"},{id:"contextualHelpRangeFormat",title:strings.Editor.RangeFormatDocsLink,link:"https://go.microsoft.com/fwlink/p/?LinkId=2141026"},{id:"contextualHelpShape",title:strings.Editor.ShapeDocsLink,link:"https://go.microsoft.com/fwlink/p/?LinkId=2141025"},{id:"contextualHelpTable",title:strings.Editor.TableDocsLink,link:"https://go.microsoft.com/fwlink/p/?LinkId=2141106"},{id:"contextualHelpWorksheet",title:strings.Editor.WorksheetDocsLink,link:"https://go.microsoft.com/fwlink/p/?LinkId=2141024"}];!function(e){e.Output="Output",e.Problems="Problems",e.Help="Help"}(i||(i={}))},20968:function(e,t,n){n.d(t,{EM:function(){return u},oF:function(){return l},Tt:function(){return d}});var r=n(21914),i=n(12466),a=n(84586),o=n(7765),s=n(49225);function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}var u=function(e,t){return{root:{alignSelf:"stretch",height:"3.2rem",padding:"0 "+e.spacing.xSmall,backgroundColor:e.colors.neutralLight,fontSize:e.fontSizes.small,selectors:{".ms-Button-menuIcon":{fontSize:e.fontSizes.icon},".ms-Icon":{marginTop:".1rem",opacity:t?.5:1}}},rootDisabled:{backgroundColor:e.colors.neutralLight,selectors:{"@media screen and (-ms-high-contrast: active)":{background:"window",MsHighContrastAdjust:"none"}}},rootHovered:{backgroundColor:e.colors.neutralQuaternary},rootPressed:{backgroundColor:e.colors.neutralTertiaryAlt},icon:{fontSize:e.fontSizes.icon}}},l=function(e,t,n){void 0===n&&(n=!1);var r=function(e,t,n){void 0===n&&(n=!1);var r=u(t,n);return c({},r,{root:c({},r.root,{fontSize:e})})}(e,t,n);return c({},r,{root:c({},r.root,{backgroundColor:"transparent"}),rootDisabled:{backgroundColor:"transparent"}})},d=function(e){var t=u(e,!1);return c({},t,{root:c({},t.root,{backgroundColor:"transparent",padding:"0",width:"3.2rem",minWidth:"3.2rem"})})};t.ZP=(0,a.Zz)((function(e){var t=e.buttonProps,n=e.testId,a=e.theme,l=e.additionalStyles,d=e.tooltipText,p=e.dismissTooltipOnFirstShow,f=e.isMenuOpened,g=e.setIsMenuOpened,h=e.onTooltipToggle,m=void 0!==n&&void 0!==d,v=(0,r.useRef)(null),b=(0,r.useState)(!m||p?"":d),y=b[0],w=b[1];return(0,r.useEffect)((function(){m&&!0!==p&&w(d)}),[d]),r.createElement(o.G,{content:y,id:n+"-tooltip",componentRef:v,onTooltipToggle:h,calloutProps:(0,s.FA)(a)},r.createElement(i.Q,c({"data-testid":n,styles:c({},u(a,!!t.disabled),l)},t,{"aria-describedby":m?n+"-tooltip":void 0,onMouseEnter:function(e){p&&!y&&(w(d||""),v.current&&v.current.show())},onMenuClick:function(e){g&&(g(!f),null==e||e.preventDefault(),null==e||e.stopPropagation())},onAfterMenuDismiss:function(){g&&g(!1)},onKeyDown:function(e){"ArrowDown"===e.key&&e.altKey&&g&&!f&&(g(!0),null==e||e.preventDefault(),null==e||e.stopPropagation())}})))}))},31378:function(e,t,n){var r=n(84586),i=n(21914),a=n(81943),o=n(273);t.Z=(0,r.Zz)((function(e){var t=e.items,n=e.selectedKey,r=e.testId,c=e.shouldFocus,u=e.setShouldFocus,l=e.theme,d=e.onSelect,p=i.createRef();return(0,i.useEffect)((function(){c&&p.current&&(p.current.focus(),u&&u(!1))}),[c,u,p]),i.createElement(a.o,{"data-testid":r,componentRef:p,onLinkClick:function(e){var t=e?e.props.itemKey:null;t&&t!==n&&d&&d(t)},selectedKey:n,styles:s(l)},t.map((function(e){var t=e.testId?{"data-testid":e.testId}:void 0;return i.createElement(o.M,{key:e.key,itemKey:e.key,headerText:e.text,ariaLabel:e.ariaLabel,itemIcon:e.iconName,headerButtonProps:t,itemCount:e.itemCount||void 0})})))}));var s=function(e){return{root:{paddingTop:"2px",paddingBottom:e.spacing.smallPlus,outline:"none",paddingLeft:"2px"},linkIsSelected:{selectors:{":hover":{background:"transparent"},":focus":{outline:"1px solid "+e.colors.neutralSecondary}}},link:{selectors:{":hover":{background:"transparent"}}}}}},32641:function(e,t,n){var r=n(84586),i=n(21914),a=n(14979),o=n(79628),s=n(83542);t.Z=(0,r.Zz)((function(e){var t=e.theme,n=e.scriptHasUnsavedChanges,r=e.rootFolder,u=e.isPointerCursor,l=e.showSubFolder?r+s.jX:r;return i.createElement(i.Fragment,null,n?i.createElement(a._,{styles:(0,o.dz)(t,u,n),"aria-hidden":"true"},strings.Backstage.ScriptItemUnsavedChangesText):i.createElement(c,null,i.createElement(a._,{styles:(0,o.dz)(t,u,n),"aria-hidden":"true"},l)))}));var c=r.ZP.div.withConfig({displayName:"FolderPath__FlexWrapper",componentId:"sc-1v3v844-0"})(["display:flex;text-overflow:ellipsis;"])},9617:function(e,t,n){n.d(t,{Y:function(){return a}});var r=n(67921),i=n(74413);function a(e){return{colors:(0,r.E)(e),spacing:(0,i.b)()}}},70530:function(e,t,n){n.d(t,{Gu:function(){return P},OC:function(){return C},TW:function(){return I},LY:function(){return O},O8:function(){return T},lq:function(){return E},sI:function(){return D},co:function(){return M},xT:function(){return j},tj:function(){return L},j3:function(){return N},dR:function(){return B},nC:function(){return F},Jj:function(){return A},mw:function(){return U},kQ:function(){return z},uW:function(){return _}});var r=n(21830),i=n(20260),a=n(72558),o=n(60146),s=n(58351),c=n(36103),u=n(20661),l=n(57318),d=n(67796),p=n(84824),f=n(18421),g=n(60683),h=n(88859),m=n(75434),v=n(54050),b=n(57464);function y(){return y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},y.apply(this,arguments)}var w={marginTop:".0rem"},S={marginTop:".0rem",opacity:"50%"},x=function(e,t){return{iconProps:y({iconName:e},t)}},k=function(e,t,n){return y({text:e,ariaLabel:t},n)},R=function(e,t){return{key:e,onClick:t}},P=function(e,t,n,r,i,a){return y({},R(e,(function(e){(0,h.I)(t,r),"Details Page"===r&&e.stopPropagation()})),k(strings.General.RunButtonText,strings.General.RunButtonText),x("PlayIcon"),{disabled:!n,tooltipText:(0,f.d)(i)},a)},C=function(e,t,n){var r=R(e,t),i=strings.Details.EditButtonText;return y({},r,k(i,i),x("EditGeneric16"),n)},I=function(e,t,n,r){var i=c.u.store,a="";t?a=strings.Details.ShareButtonAlreadySharedTooltipText:n||(a=strings.Details.ShareButtonSharingDisabledTooltipText);return y({},R(e,(function(){i.dispatch(u.N.shareDialog.show())})),k(strings.Details.ShareCommandButtonText,strings.Details.ShareCommandButtonText),x("ShareTo"),{toolTipText:a},r)},O=function(e){return{key:e,name:"-",itemType:l.n.Divider}},T=function(e,t){var n=c.u.store;return y({key:e,onClick:function(){n.dispatch(u.N.unshareDialog.show())}},k(strings.Dialog.StopSharingButtonText,strings.Dialog.StopSharingButtonText),t)},E=function(e,t,n){var r=c.u.store,i=R(e,(function(){r.dispatch(u.N.dialog.show({title:strings.Dialog.ConfirmDeleteDialogLabel,subText:strings.Dialog.DeleteWarningText,buttons:[{key:(0,o.k)("DeleteDialogDeleteButton"),text:strings.Dialog.DeleteButtonText,action:u.N.scripts.remove.request(t),isPrimary:!0},{key:(0,o.k)("DeleteDialogCancelButton"),text:strings.General.CancelButtonText,action:u.N.dialog.dismiss(),isPrimary:!1}]}))})),a=strings.General.DeleteButtonText;return y({},i,k(a,a),x("AfterDeleteMenuIcon",{style:n?w:S}),{disabled:!n})},D=function(e,t,n){return y({},R(e,n),k(strings.Editor.RenameButtonText,strings.Editor.RenameButtonText),x("RenameMenuIcon",{style:t?w:S}),{disabled:!t})},M=function(e,t,n){var r=strings.Editor.SaveScriptAsButtonText;return y({},R(e,n),k(r,r),x("SaveAs",{style:t?w:S}),{disabled:!t})},j=function(e,t,n){return y({},R(e,n),k(strings.Editor.MakeCopyButtonText,strings.Editor.MakeCopyButtonText),x("CopyIcon",{style:t?w:S}),{disabled:!t})},L=function(e,t){return y({},R((0,o.k)("MainHeaderOverflowRevertToSavedButton"),t),k(strings.Editor.DiscardChangesButtonText,strings.Editor.DiscardChangesButtonText),x((0,r.zg)()?"UndoMenuIconRtl":"UndoMenuIcon",{style:e?w:S}),{disabled:!e})},N=function(e){return y({},R((0,o.k)("MainHeaderOverflowConsole"),e),k(strings.Editor.ConsoleButtonText,strings.Editor.ConsoleButtonText,{ariaDescription:strings.Editor.ConsoleAriaDescription}),x("AccReportBlankIcon",{style:w}))},B=function(e){return y({},R("MainHeaderOverflowOptionsButton",e),k(strings.PageTitles.About,strings.PageTitles.About),x("PlayerSettingsMenuIcon"))},F=function(e){return y({},R((0,o.k)("MainHeaderOverflowHelpButton"),e),k(strings.Editor.HelpButtonText,strings.Editor.HelpButtonText),x("InfoMenuIcon",{style:w}))},A=function(e){return y({},R((0,o.k)("MainHeaderOverflowSettingsButton"),e),k(strings.Editor.SettingsButtonText,strings.Editor.SettingsButtonText),x("CurrentViewSettingsMenuIcon",{style:w}))},U=function(e,t,n){var r=(null==t?void 0:t.storageScript.isCreator)&&(0,a.J)(t)&&!(0,b.$)(t),i=(0,m.jN)("OfficeScriptsAutomateTask")&&(0,v.Xf)()===Office.PlatformType.OfficeOnline;return y({},R(e,(function(){if(i){var e={Script:JSON.stringify(null!=t?t:{}),Source:n};(0,v.dp)("PowerAutomate",void 0,e)}else window.open("https://go.microsoft.com/fwlink/?linkid=2114609","_blank");(0,s.ve)({eventName:"CreateFlowClicked",eventType:"User",data:t&&t.storageScript?{storageId:t.storageScript.id}:void 0})})),k(strings.Details.CreateFlowButtonText,strings.Details.CreateFlowButtonText),x("FlowIcon",{style:r?w:S}),{disabled:!r})},z=function(e,t,n,r){var i=t&&!(0,d.a)(t)&&(n||(0,p.o)(t)),a=strings.General.AddButtonText;return y({},R(e,(function(){r(t)})),k(a,a),x("AddIcon",{style:i?w:S}),{disabled:!i,tooltipText:i?"":strings.General.AddButtonSharingDisabledTooltipText})},_=function(e,t,n){var r=!!t,a=c.u.store,o=R(e,(function(){t?(a.dispatch(u.N.editor.openScript({id:t.storageScript.id,destination:"Details"})),(0,s.ve)((0,g.Z)({eventName:"OpenScript",eventType:"User",data:{logLevel:s.in.Information,storageId:t.storageScript.id,entryPoint:n,hasDescription:!!t.storageScript.description,isOwner:(0,i.C)(t),driveType:t.storageScript.driveType}}))):(0,s.m)(new Error("script is undefined"),s.in.Error)})),l=strings.General.DetailsButtonText;return y({},o,k(l,l),x("ShowDetailsPageMenuIcon",{style:r?w:S}))}},38281:function(e,t){var n;!function(e){e.Workbook="ExcelScript.Workbook",e.Table="ExcelScript.Table",e.Worksheet="ExcelScript.Worksheet",e.String="String",e.Number="Number",e.Function="Function",e.Unknown="Unknown"}(n||(n={})),t.Z=n},9580:function(e,t,n){var r=n(78095),i=n(24654),a=n(73693),o=(0,n(3515).sI)();t.Z=(0,r.UY)({isVisible:function(e,t){switch(void 0===e&&(e=!1),t.type){case(0,i.getType)(a.show):return!0;case(0,i.getType)(a.hide):return!1;default:return e}},currentPivot:function(e,t){return void 0===e&&(e=null),t.type===(0,i.getType)(a.setCurrentPivot)?t.payload:e},outputLogs:function(e,t){switch(void 0===e&&(e=[]),t.type){case(0,i.getType)(a.addOutputLogs):return[].concat(e,t.payload);case(0,i.getType)(a.clearOutputLogs):return[];default:return e}},problemsLogs:function(e,t){switch(void 0===e&&(e=[]),t.type){case(0,i.getType)(a.setProblemsLogs):return t.payload;case(0,i.getType)(a.clearProblemsLogs):return[];default:return e}},helpLinks:function(e,t){return void 0===e&&(e=o),t.type===(0,i.getType)(a.setHelpLinks)?t.payload:e}})},9180:function(e,t,n){var r=n(78095),i=n(24654),a=n(31703);t.Z=(0,r.UY)({isVisible:function(e,t){switch(void 0===e&&(e=!1),t.type){case(0,i.getType)(a.show):return!0;case(0,i.getType)(a.hide):return!1;default:return e}}})},26634:function(e,t,n){n.d(t,{T:function(){return d}});var r=n(45912),i=n(55048),a=n(44444),o=n(28041);function s(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){s(a,r,i,o,c,"next",e)}function c(e){s(a,r,i,o,c,"throw",e)}o(void 0)}))}}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}var d=function(e){var t,n;function i(){for(var t,n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return t=e.call.apply(e,[this].concat(i))||this,Object.defineProperty(u(t),"getImpl",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=c(regeneratorRuntime.mark((function e(t){var n,i,s,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.W9)(t);case 2:return n=e.sent,e.next=5,(0,r.Z)();case 5:if(i=e.sent,0!==(s=n.filter((function(e){return e.lastModifiedByUser!==i.UserId}))).length){e.next=11;break}return e.abrupt("return",s);case 11:return e.next=13,o.q.instance();case 13:return c=e.sent,e.next=16,c.getScriptConsentRecord(t);case 16:return u=e.sent,e.abrupt("return",s.filter((function(e){return!u||-1===u.userIds.findIndex((function(t){return t===e.lastModifiedByUser}))})));case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),Object.defineProperty(u(t),"innerKey",{configurable:!0,enumerable:!0,writable:!0,value:function(e){return e.storageScript.id}}),u(t)||u(t)}return n=e,(t=i).prototype=Object.create(n.prototype),t.prototype.constructor=t,l(t,n),i}(i.q);Object.defineProperty(d,"_instance",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(d,"instance",{configurable:!0,enumerable:!0,writable:!0,value:function(){return d._instance||(d._instance=new d),d._instance}})},57222:function(e,t,n){n.d(t,{t:function(){return _}});var r=n(90828),i=n(52105),a=n(35826),o=n(82750),s=n(9617),c=n(15592),u=n(26634),l=n(64295),d=n(54050),p=n(8855),f=n(83542),g=n(65086),h=n(58351),m=n(97650),v=n(19885),b=n(47272),y=n(86709),w=n(56136),S=n(21830),x=n(57464),k=n(38104),R=n(34961),P=n(81066);function C(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e,t){return O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},O(e,t)}var T=function(e){var t,n;function r(t,n,r,i){var a;return void 0===i&&(i=!0),a=e.call(this,n,r,i)||this,Object.defineProperty(I(a),"activeScript",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(I(a),"displayDialog",{configurable:!0,enumerable:!0,writable:!0,value:function(){return a.displayDialogAsync(y.rn.consent,"canceled")}}),Object.defineProperty(I(a),"processDialogEvent",{configurable:!0,enumerable:!0,writable:!0,value:function(e){var t=12006===e.error;t?a.activity.succeed(h.in.Information,{dialogType:y.rn.consent,isDismissed:!0,dialogURL:(0,w.c)()}):a.activity.fail(h.in.Error,{dialogType:y.rn.consent,errorCode:e.error},new Error("Received error event from dialog!")),a.closeDialog(t,"canceled")}}),Object.defineProperty(I(a),"processDialogMessage",{configurable:!0,enumerable:!0,writable:!0,value:function(e){if(e.error)a.activity.fail(h.in.Error,{dialogType:y.rn.consent,errorCode:e.error},new Error("Error found inside dialog message!")),a.closeDialog(!1,"canceled");else{var t=(0,g.r)(e.message);t&&(t.messageType===y.Q4.onRegisterMessageComplete?t.success?a.sendDialogProps():(a.activity.fail(h.in.Error,{dialogType:y.rn.consent},new Error("Failed to register message listener on dialog!")),a.closeDialog(!1,"canceled")):t.messageType===y.Q4.onButtonClick&&a.handleDialogButtonClick(t.props))}}}),Object.defineProperty(I(a),"handleDialogButtonClick",{configurable:!0,enumerable:!0,writable:!0,value:function(e){e.buttonId===y.hK.accept?a.closeDialog(!1,"accepted"):e.buttonId===y.hK.deny||e.buttonId===y.hK.close?a.closeDialog(!1,"denied"):e.buttonId===y.hK.viewScript&&(a.closeDialog(!1,"canceled"),(0,l.Z)(a.activeScript)),a.activity.succeed(h.in.Information,{dialogType:y.rn.consent,buttonId:e.buttonId})}}),Object.defineProperty(I(a),"sendDialogProps",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,n,r,i,o,l,g,h,b;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,c.M)((0,d.Zd)()),n=(0,s.Y)(t),e.next=4,u.T.instance().getValue(a.activeScript);case 4:r=e.sent,i=(0,v.L)(r),o=strings.substitute(strings.Backstage.ScriptItemUserOwnedOneDriveRootFolderText,{creator:a.activeScript.storageScript.creatorDisplayName||""}),l=o+f.jX,g=k.E.instance().getCachedValue((0,R.O3)(),a.activeScript),h={header:strings.Dialog.ConsentRunPermissionsHeader,folderPath:P.X.instance().isTeamOwnershipUXEnabled()||(0,x.$)(a.activeScript)?null!=g?g:(0,k.R)(a.activeScript.storageScript):l,modifiedByUserNames:(0,m.N)(i),message:strings.Dialog.ConsentLastModifiedMessage,ariaLabels:{lastModifiedUsers:strings.Dialog.ConsentLastModifiedUsersAriaLabel,closeButton:strings.General.CloseButtonLabel},ariaDescriptions:{allowButton:strings.Dialog.ConsentAllowButtonAriaDescription,denyButton:strings.Dialog.ConsentDenyButtonAriaDescription},consentScopesHeader:strings.Dialog.ConsentScopesListHeader,consentIfAllow:strings.Dialog.ConsentIfYouAllowExplanation,consentLearnAbout:strings.Dialog.ConsentLearnAboutOfficeScriptingLinkText,allowButton:strings.Dialog.ConsentAllowButtonText,denyButton:strings.Dialog.ConsentDenyButtonText},b={dialogType:y.rn.consent,isRTL:(0,S.zg)(),dialogProps:{script:a.activeScript,userInfos:i,localizedStrings:h,theme:n,scopes:(0,p.K)()}},a.messageChild(b);case 12:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){C(a,r,i,o,s,"next",e)}function s(e){C(a,r,i,o,s,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}()}),a.activeScript=t,a}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,O(t,n),r}(b.S);function E(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function D(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){E(a,r,i,o,s,"next",e)}function s(e){E(a,r,i,o,s,"throw",e)}o(void 0)}))}}var M=function(e,t,n,r,i){var a=this;void 0===i&&(i=!0),Object.defineProperty(this,"displayInIframe",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"height",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"width",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dialogType",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"defaultValue",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"resolveDialog",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"rejectDialog",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"activity",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dialog",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"displayDialogAsync",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=D(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,w.c)(),n=a.convertPixelToPercentage(),r={height:n.height.toString(),width:n.width.toString(),displayInIFrame:a.displayInIframe,dialogTitle:strings.Dialog.ConsentRunPermissionsHeader,onMessage:a.onMessageCallback,onClose:a.onCloseCallback},e.prev=3,e.next=6,OfficeFirstPartyDialog.displayWebDialog(t,r);case 6:a.dialog=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),a.onDialogCreationFailure(e.t0);case 12:return e.abrupt("return",new Promise((function(e,t){a.resolveDialog=e,a.rejectDialog=t})));case 13:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"handleDialogButtonClick",{configurable:!0,enumerable:!0,writable:!0,value:function(e){}}),Object.defineProperty(this,"composeDialogProps",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=D(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",void 0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"closeDialog",{configurable:!0,enumerable:!0,writable:!0,value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){a.dialog&&a.dialog.close(),a.resolveDialogPromise(e),a.activity.succeed(h.in.Information,t)}))}),Object.defineProperty(this,"sendDialogProps",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=D(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.composeDialogProps();case 2:(t=e.sent)&&a.messageChild(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"messageChild",{configurable:!0,enumerable:!0,writable:!0,value:function(e){if(!a.dialog)throw new Error("Trying to send message while dialog is not yet created!");a.dialog.messageChild(JSON.stringify(e),{targetOrigin:""})}}),Object.defineProperty(this,"resolveDialogPromise",{configurable:!0,enumerable:!0,writable:!0,value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){a.resolveDialog&&a.resolveDialog(e)}))}),Object.defineProperty(this,"rejectDialogPromise",{configurable:!0,enumerable:!0,writable:!0,value:function(e){a.rejectDialog&&a.rejectDialog(e)}}),Object.defineProperty(this,"onCloseCallback",{configurable:!0,enumerable:!0,writable:!0,value:function(){a.activity.succeed(h.in.Information,{dialogType:y.rn.consent,isDismissed:!0,dialogURL:(0,w.c)()}),a.resolveDialogPromise(a.defaultValue)}}),Object.defineProperty(this,"onDialogCreationFailure",{configurable:!0,enumerable:!0,writable:!0,value:function(e){a.activity.fail(h.in.Error,{dialogType:a.dialogType},e),a.rejectDialogPromise(e)}}),Object.defineProperty(this,"onMessageCallback",{configurable:!0,enumerable:!0,writable:!0,value:function(e,t,n){var r=(0,g.r)(e);r&&(r.messageType===y.Q4.onRegisterMessageComplete?r.success&&a.sendDialogProps():r.messageType===y.Q4.onButtonClick&&a.handleDialogButtonClick(r.props))}}),Object.defineProperty(this,"convertPixelToPercentage",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=window.screen.availHeight,t=window.screen.availWidth,n=100*a.height/e,r=100*a.width/t,i=Math.floor(n),o=Math.floor(r);return{height:Math.min(100,i),width:Math.min(90,o)}}}),this.height=e,this.width=t,this.dialogType=n,this.defaultValue=r,this.displayInIframe=i,this.activity=new h.pX("FloatingDialog","User",[],!0)};function j(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function L(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(e,t){return N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},N(e,t)}var B=function(e){var t,n;function r(t,n,r,i){var a;return void 0===i&&(i=!0),a=e.call(this,n,r,y.rn.consent,"canceled",i)||this,Object.defineProperty(L(a),"activeScript",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(L(a),"displayDialog",{configurable:!0,enumerable:!0,writable:!0,value:function(){return a.displayDialogAsync()}}),Object.defineProperty(L(a),"handleDialogButtonClick",{configurable:!0,enumerable:!0,writable:!0,value:function(e){var t={dialogType:y.rn.consent,buttonId:e.buttonId};e.buttonId===y.hK.accept?a.closeDialog("accepted",t):e.buttonId===y.hK.deny||e.buttonId===y.hK.close?a.closeDialog("denied",t):e.buttonId===y.hK.viewScript&&(a.closeDialog("canceled",t),(0,l.Z)(a.activeScript))}}),Object.defineProperty(L(a),"composeDialogProps",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,n,r,i,o,l,g,h,b;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(0,c.M)((0,d.Zd)()),n=(0,s.Y)(t),e.next=4,u.T.instance().getValue(a.activeScript);case 4:return r=e.sent,i=(0,v.L)(r),o=strings.substitute(strings.Backstage.ScriptItemUserOwnedOneDriveRootFolderText,{creator:a.activeScript.storageScript.creatorDisplayName||""}),l=o+f.jX,g=k.E.instance().getCachedValue((0,R.O3)(),a.activeScript),h={header:strings.Dialog.ConsentRunPermissionsHeader,folderPath:P.X.instance().isTeamOwnershipUXEnabled()||(0,x.$)(a.activeScript)?null!=g?g:(0,k.R)(a.activeScript.storageScript):l,modifiedByUserNames:(0,m.N)(i),message:strings.Dialog.ConsentLastModifiedMessage,ariaLabels:{lastModifiedUsers:strings.Dialog.ConsentLastModifiedUsersAriaLabel,closeButton:strings.General.CloseButtonLabel},ariaDescriptions:{allowButton:strings.Dialog.ConsentAllowButtonAriaDescription,denyButton:strings.Dialog.ConsentDenyButtonAriaDescription},consentScopesHeader:strings.Dialog.ConsentScopesListHeader,consentIfAllow:strings.Dialog.ConsentIfYouAllowExplanation,consentLearnAbout:strings.Dialog.ConsentLearnAboutOfficeScriptingLinkText,allowButton:strings.Dialog.ConsentAllowButtonText,denyButton:strings.Dialog.ConsentDenyButtonText},b={dialogType:y.rn.consent,isRTL:(0,S.zg)(),dialogProps:{script:a.activeScript,userInfos:i,localizedStrings:h,theme:n,scopes:(0,p.K)()}},e.abrupt("return",b);case 12:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){j(a,r,i,o,s,"next",e)}function s(e){j(a,r,i,o,s,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}()}),a.activeScript=t,a}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,N(t,n),r}(M),F=n(75434),A=n(28041);function U(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function z(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){U(a,r,i,o,s,"next",e)}function s(e){U(a,r,i,o,s,"throw",e)}o(void 0)}))}}var _=function(e){H.call(this),this.reduxStore=e};Object.defineProperty(_,"_instance",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(_,"instance",{configurable:!0,enumerable:!0,writable:!0,value:function(){if(!_._instance){var e=(0,a.v)();_._instance=new _(e)}return _._instance}});var H=function(){var e=this;Object.defineProperty(this,"reduxStore",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"resolveDialog",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"showConsentDialog",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=z(regeneratorRuntime.mark((function t(n){var a,o,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("RunFromButton"!==(0,i.L3)()||!(0,F.jN)("TaskpanelessRFB")){t.next=19;break}if((0,d.Xf)()!==Office.PlatformType.OfficeOnline){t.next=15;break}return a=new T(n,480,390),t.next=5,a.displayDialog();case 5:if("accepted"!==(o=t.sent)){t.next=11;break}return e.acceptConsent(n),t.abrupt("return",!0);case 11:return e.revokeOrCancelConsent(n,"canceled"===o),t.abrupt("return",!1);case 13:t.next=17;break;case 15:return s=new B(n,440,390),t.abrupt("return",s.displayDialog().then((function(t){return"accepted"===t?(e.acceptConsent(n),!0):(e.revokeOrCancelConsent(n,"canceled"===t),!1)})).catch((function(){return!1})));case 17:t.next=21;break;case 19:return e.reduxStore.dispatch(r.N.consentDialog.show()),t.abrupt("return",new Promise((function(t){e.resolveDialog=t})));case 21:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}),Object.defineProperty(this,"checkConsent",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=z(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.T.instance().getValue(t);case 3:return n=e.sent,e.abrupt("return",0===n.length);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"acceptConsent",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=z(regeneratorRuntime.mark((function t(n){var r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,A.q.instance();case 3:return r=t.sent,t.next=6,u.T.instance().getValue(n);case 6:return i=t.sent,t.next=9,r.acceptConsentUsers(n.storageScript.id,(0,v.L)(i));case 9:u.T.instance().setValue(n,[]),t.next=14;break;case 12:t.prev=12,t.t0=t.catch(0);case 14:e.resolveDialogPromise(!0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}()}),Object.defineProperty(this,"revokeOrCancelConsent",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=z(regeneratorRuntime.mark((function t(n,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===r&&(r=!1),(0,o.HQ)("EnablePermissionDialog")){t.next=12;break}if(r){t.next=12;break}return t.prev=3,t.next=6,A.q.instance();case 6:t.sent.denyConsent(n),t.next=12;break;case 10:t.prev=10,t.t0=t.catch(3);case 12:e.resolveDialogPromise(!1);case 13:case"end":return t.stop()}}),t,null,[[3,10]])})));return function(e,n){return t.apply(this,arguments)}}()}),Object.defineProperty(this,"resolveDialogPromise",{configurable:!0,enumerable:!0,writable:!0,value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(t){"RunFromButton"===(0,i.L3)()&&(0,F.jN)("TaskpanelessRFB")||e.resolveDialog&&e.resolveDialog(t)}))})}},50578:function(e,t,n){var r=n(78095),i=n(24654),a=n(45752);t.Z=(0,r.UY)({active:function(e,t){return void 0===e&&(e=null),t.type===(0,i.getType)(a.j6.setActive)?t.payload.id:e},isLoading:function(e,t){return void 0===e&&(e=!0),t.type!==(0,i.getType)(a.j6.monacoInitialized)&&e},isDetailsPageVisible:function(e,t){switch(void 0===e&&(e=!1),t.type){case(0,i.getType)(a.j6.showDetailsPage):return!0;case(0,i.getType)(a.j6.hideDetailsPage):return!1;default:return e}},externalContentUpdateCounter:function(e,t){return void 0===e&&(e=0),t.type===(0,i.getType)(a.j6.contentExternallyUpdated)?++e:e},navigationSourcePage:function(e,t){return void 0===e&&(e=""),t.type===(0,i.getType)(a.j6.setNavigationSourcePage)?t.payload:e},isMakingACopy:function(e,t){return void 0===e&&(e=!1),t.type===(0,i.getType)(a.j6.setIsMakingACopy)?t.payload:e},isEditingScriptName:function(e,t){return void 0===e&&(e=!1),t.type===(0,i.getType)(a.j6.setIsEditingScriptName)?t.payload:e},detailsNavigateSource:function(e,t){return void 0===e&&(e=null),t.type===(0,i.getType)(a.j6.setDetailsNavigateSource)?t.payload:e},isRecorderRunning:function(e,t){return void 0===e&&(e=!1),t.type===(0,i.getType)(a.j6.setIsRecorderRunning)?t.payload:e}})},59338:function(e,t,n){n.d(t,{r:function(){return r}});var r=function(){};Object.defineProperty(r,"editor",{configurable:!0,enumerable:!0,writable:!0,value:void 0})},110:function(e,t,n){n.d(t,{D:function(){return u},B:function(){return l}});var r,i=n(66052);function a(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){a(o,r,i,s,c,"next",e)}function c(e){a(o,r,i,s,c,"throw",e)}s(void 0)}))}}function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},s.apply(this,arguments)}var c={tabWidth:2};function u(e){c=s({},c,e)}function l(e){return d.apply(this,arguments)}function d(){return(d=o(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",f().then((function(){return p(t,c)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e,t){try{return r?r.js_beautify(e,{indent_size:t.tabWidth,break_chained_methods:!0,brace_style:"expand"}):e}catch(n){return e}}function f(){return g.apply(this,arguments)}function g(){return(g=o(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=2;break}return e.abrupt("return",r);case 2:return e.abrupt("return",(0,i.S)("formatter",(function(){return n.e(1737).then(n.t.bind(n,10056,23))})).then((function(e){return r=e.default,e.default})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},90828:function(e,t,n){n.d(t,{N:function(){return r.ZP},w:function(){return i.ZP}});var r=n(45752),i=n(25509)},6503:function(e,t,n){var r=n(78095),i=n(24654),a=n(65647);t.Z=(0,r.UY)({activeScript:function(e,t){return void 0===e&&(e=null),t.type===(0,i.getType)(a.setActiveScript)?t.payload.script:e},fetchErrorText:function(e,t){return void 0===e&&(e=null),t.type===(0,i.getType)(a.setFetchErrorText)?t.payload.text:e},isViewingScript:function(e,t){switch(void 0===e&&(e=!1),t.type){case(0,i.getType)(a.viewScript):return!0;case(0,i.getType)(a.attemptToRunScriptFromLink):return!1;default:return e}}})},94232:function(e,t,n){var r=n(78095),i=n(24654),a=n(5571);t.Z=(0,r.UY)({runningStatus:function(e,t){switch(void 0===e&&(e="None"),t.type){case(0,i.getType)(a.clearPreviousRun):return"None";case(0,i.getType)(a.start):return"InProgress";case(0,i.getType)(a.success):return"Succeeded";case(0,i.getType)(a.failure):return"Failed";case(0,i.getType)(a.unsupported):return"Unsupported";case(0,i.getType)(a.cancel):return"InProgress"===e?"Canceled":e;case(0,i.getType)(a.consentDenied):return"ConsentDenied";default:return e}}})},76140:function(e,t,n){n.d(t,{sz:function(){return O}});var r=n(65506),i=n(56222),a=n(58351);function o(e,t){return"Line #"+e+": "+t}var s=n(286);function c(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){c(a,r,i,o,s,"next",e)}function s(e){c(a,r,i,o,s,"throw",e)}o(void 0)}))}}function l(e){return d.apply(this,arguments)}function d(){return(d=u(regeneratorRuntime.mark((function e(t){var n,r,i,a,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=s.ScriptTarget.ES2019,r=["dom","es2019"],!(i=s.transpileModule(t,{reportDiagnostics:!0,compilerOptions:{target:n,lib:r,allowJs:!0}})).diagnostics.length){e.next=6;break}return a=i.diagnostics.map((function(e){var n=t.substr(0,e.start),r=t.substr(e.start+1),i=n.split("\n").length,a=n.lastIndexOf("\n"),s=t.substring(a,e.start+Math.max(r.indexOf("\n"),0)).trim();return o(i,e.messageText+"\n "+s)})).join("\n\n"),e.abrupt("return",{compileErrorMessage:a});case 6:return c=i.outputText.replace('Object.defineProperty(exports, "__esModule", { value: true });',""),e.abrupt("return",{outputText:c});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){p(a,r,i,o,s,"next",e)}function s(e){p(a,r,i,o,s,"throw",e)}o(void 0)}))}}function g(e){return h.apply(this,arguments)}function h(){return(h=f(regeneratorRuntime.mark((function e(t){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(t);case 2:if(n=e.sent,r=n.compileErrorMessage,i=n.outputText,!r){e.next=7;break}throw new SyntaxError(r);case 7:if(!i){e.next=9;break}return e.abrupt("return",i);case 9:throw new SyntaxError("No Code");case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var m=n(21001),v=n(73613),b=n(54050);function y(e){return e.map((function(e){var t=e.name,n=e.version;return{name:t,version:n,support:Office.context.requirements.isSetSupported(t,n)}}))}var w=n(8797);function S(){return S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},S.apply(this,arguments)}function x(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function k(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){x(a,r,i,o,s,"next",e)}function s(e){x(a,r,i,o,s,"throw",e)}o(void 0)}))}}function R(e,t,n,r){return P.apply(this,arguments)}function P(){return(P=k(regeneratorRuntime.mark((function e(t,n,r,i){var o,c,u,d,p,f,g,h,x,k,R,P,C,I,O,T;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,v.D)();case 2:return o=e.sent,c=new a.pX("TransformScript","System"),u={storageId:n.storageScript.id},d=(0,w.Z)()&&(0,b.e8)(),e.prev=6,f=function(e){return e},e.next=10,o.transformSynchronousCodeForBatchExecutionLegacy(t,l,S({logger:logger,scan:d,getSetSupport:y,mergeOverride:f},r));case 10:if(!(p=e.sent).outputText){e.next=17;break}return g=function(e,t){var n=[1157,1232,2300,2364,2393,2451,2792],r=s.getPreEmitDiagnostics(t);i.syntaxErrorCodes=JSON.stringify(r.map((function(e){return e.code})));var a=r.filter((function(e){return n.indexOf(e.code)>=0})).filter((function(e){return e.file}));return(0,m.diagnosticsToErrorMessage)(e,a)},e.next=15,o.transformSynchronousCodeForBatchExecution(t,S({logger:logger,scan:d,getSetSupport:y,mergeOverride:f,syntaxOverride:g},r));case 15:(h=e.sent).outputText||(p=h);case 17:e.next=23;break;case 19:throw e.prev=19,e.t0=e.catch(6),c.fail(a.in.Error,S({},u,{message:"Office Script unexpected transform error"}),e.t0),e.t0;case 23:if(k=(x=p).outputText,R=x.scanReport,P=x.transformStats,C=x.failureStage,I=x.failureMessage,O=!C&&!I&&void 0!==k,T=R?!R.detectedApis.some((function(e){return"undefined"===e.name})):void 0,c.succeed(a.in.Information,S({syntaxTime:null==P?void 0:P.stageSyntaxMilliseconds,programTime:null==P?void 0:P.stageProgramMilliseconds,lintTime:null==P?void 0:P.stageLintMilliseconds,scanTime:null==P?void 0:P.stageScanMilliseconds,supportTime:null==P?void 0:P.stageSupportMilliseconds,transpileTime:null==P?void 0:P.stageTranspileMilliseconds,compileTime:null==P?void 0:P.stageCompileMilliseconds,failureStage:C,scan:d,allSetsDefined:T},u,{success:O})),!C){e.next=30;break}if(!I){e.next=30;break}throw new SyntaxError(I);case 30:if(!k){e.next=32;break}return e.abrupt("return",k);case 32:throw new SyntaxError("No Code");case 33:case"end":return e.stop()}}),e,null,[[6,19]])})))).apply(this,arguments)}function C(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function I(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){C(a,r,i,o,s,"next",e)}function s(e){C(a,r,i,o,s,"throw",e)}o(void 0)}))}}function O(e,t,n,r){return T.apply(this,arguments)}function T(){return(T=I(regeneratorRuntime.mark((function e(t,n,i,o){var s,c,u,l,d,p;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s="",c=(0,r.Z)(n),u=new a.pX("CompileScript","System"),l={apiInfo:n.storageScript.apiInfo,storageId:n.storageScript.id,cacheHit:!1,parentCallId:o},(d=JSON.parse(JSON.stringify(i))).cachedVersion=2,!(p=D(t,d))){e.next=12;break}return l.cacheHit=!0,u.succeed(a.in.Information,l),M(t,d,p),e.abrupt("return",p);case 12:if(e.prev=12,!c){e.next=19;break}return e.next=16,R(t,n,i,l);case 16:e.t0=e.sent,e.next=22;break;case 19:return e.next=21,g(t);case 21:e.t0=e.sent;case 22:s=e.t0,M(t,d,s),u.succeed(a.in.Information,l),e.next=32;break;case 27:throw e.prev=27,e.t1=e.catch(12),u.fail(a.in.Information,l,new Error("Compile failed")),e.t1.isCompileError=!0,e.t1;case 32:return e.abrupt("return",s);case 33:case"end":return e.stop()}}),e,null,[[12,27]])})))).apply(this,arguments)}var E=new i.sH("buildcache",2097152,0,{canPurge:function(){return!0},compare:i.iQ});function D(e,t){var n=j(e,t);return E.read(n)}function M(e,t,n){var r=j(e,t);E.write(r,n)}function j(e,t){var n=0,r=0;for(e+=JSON.stringify(t);n<e.length;n++)r=Math.imul(31,r)+e.charCodeAt(n)|0;return r.toString(16)}},3136:function(e,t,n){n.d(t,{a:function(){return o}});var r=n(73613);function i(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(e){i(o,r,a,s,c,"next",e)}function c(e){i(o,r,a,s,c,"throw",e)}s(void 0)}))}}function o(e){return s.apply(this,arguments)}function s(){return(s=a(regeneratorRuntime.mark((function e(t){var n,i,a,o,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.D)();case 2:return n=e.sent,i=t instanceof SyntaxError?t:t.data&&t.data.message&&t.data.message.error,a=n.formatErrorMessage(i),o="",i&&(s=i.code)&&n.isUnexpectedBatchErrorCodeInSynchronousExecution(s)&&(o=s),"Unexpected strict mode reserved word"===a&&(o="UnexpectedReservedWord"),e.abrupt("return",{errorMessage:a,unexpectedBatchErrorInSyncCode:o});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},88859:function(e,t,n){n.d(t,{I:function(){return o}});var r=n(58351),i=n(2898),a=n(46201),o=function(e,t){e?i.L.instance().acquireMutexToken()&&new a.Lc("lastModified",t).run().then((function(){i.L.instance().releaseMutexToken()})).catch((function(){i.L.instance().releaseMutexToken()})):(0,r.m)(new Error("Script is not defined"),r.in.Error)}},2898:function(e,t,n){n.d(t,{L:function(){return A}});var r=n(45752),i=n(25509),a=n(30747),o=n(60683);var s=0,c=n(58351),u=n(25200),l=n(67796),d=n(20260),p=n(52105),f=n(84195),g=n(75434),h=n(8797),m=n(17317),v=n(36047),b=n(35826),y=n(19100),w=n(3136),S=n(39711),x=n(82750),k=n(35064),R=n(76123),P=n(58679),C=n(57464),I=n(6986),O=n(92250),T=n(81908),E=n(76140),D=n(82143),M=n(67207),j=n(11899),L=n(22883);function N(){return N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},N.apply(this,arguments)}function B(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function F(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){B(a,r,i,o,s,"next",e)}function s(e){B(a,r,i,o,s,"throw",e)}o(void 0)}))}}var A=function(){function e(t){var n=this;Object.defineProperty(this,"reduxStore",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mutex",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_nextErrorId",{configurable:!0,enumerable:!0,writable:!0,value:0}),Object.defineProperty(this,"_fetchStatistics",{configurable:!0,enumerable:!0,writable:!0,value:{numberOfAttemptedFetches:0,numberOfSuccessfulFetches:0,numberOfFailedFetches:0}}),Object.defineProperty(this,"runtimeCanceled",{configurable:!0,enumerable:!0,writable:!0,value:!1}),Object.defineProperty(this,"mutexToken",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"startTime",{configurable:!0,enumerable:!0,writable:!0,value:0}),Object.defineProperty(this,"runtime",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mutexPromiseResolveFn",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mutexPromise",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"preloadFunction",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"script",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runtimeConsole",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runtimeTracker",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"isRuntimeCanceled",{configurable:!0,enumerable:!0,writable:!0,value:function(){return n.runtimeCanceled}}),Object.defineProperty(this,"acquireMutexToken",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=n.mutex.tryAcquire();return void 0!==e&&(n.mutexToken=e,n.runtimeCanceled=!1,n.startTime=Date.now(),n.mutexPromise=new Promise((function(e){n.mutexPromiseResolveFn=e})),!0)}}),Object.defineProperty(this,"releaseMutexToken",{configurable:!0,enumerable:!0,writable:!0,value:function(){try{n.mutexToken.release(),n.mutexToken=void 0,n.resolveMutexReleasePromise()}catch(e){(0,c.m)(e,c.in.Error)}}}),Object.defineProperty(this,"mutexTokenReleasePromise",{configurable:!0,enumerable:!0,writable:!0,value:function(){return n.mutexPromise?n.mutexPromise:Promise.resolve()}}),Object.defineProperty(this,"ensureScriptBody",{configurable:!0,enumerable:!0,writable:!0,value:function(e,t){var n="lastModified"===t?e.localUpdates.body:e.storageScript.body;return!(0,u.Z)(n)}}),Object.defineProperty(this,"ensurePreload",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=F(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.preloadFunction.promise());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"prepareScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=F(regeneratorRuntime.mark((function e(t,i,a,o){var s,u,l,f,h,m,v,b,y,w;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.reduxStore.dispatch(r.KH.start()),(s=new c.pX("PrepareScript","User")).sendStart({clickId:a}),e.prev=3,u="lastModified"===i?t.localUpdates.body:t.storageScript.body,n.reduxStore.dispatch(r.j_.clearOutputLogs()),e.next=8,(0,D.$)(t);case 8:return l=e.sent,f=(0,E.sz)(u,t,l,s.id),e.next=12,n.runtimeTracker.getRuntime(t);case 12:return n.runtime=e.sent,e.next=15,f;case 15:return h=e.sent,e.next=18,n.runtime.loadCode(h);case 18:return s.succeed(c.in.Information,{storageId:t.storageScript.id,runtimeId:n.runtime.getId()}),e.abrupt("return",!0);case 22:return e.prev=22,e.t0=e.catch(3),e.next=26,n.findErrors(e.t0);case 26:if(m=e.sent,"Set Unsupported"===(v=m.errorMessage)?(n.reduxStore.dispatch(r.KH.unsupported()),s.fail(c.in.Information,{clickId:a,runtimeId:n.runtime?n.runtime.getId():void 0},new Error("Unsupported."))):(y=!!e.t0.isCompileError,w=y?c.in.Information:c.in.Error,n.onErrorRun(t,v),s.fail(w,{clickId:a,runtimeId:n.runtime?null==(b=n.runtime)?void 0:b.getId():void 0},y?new Error("Compile error."):e.t0)),"RunFromButton"!==(0,p.L3)()||!(0,g.jN)("TaskpanelessRFB")){e.next=32;break}return e.next=32,(0,O.dA)(O.vj.officeScriptsRunningStatus,{runStatus:O.Z1.runFailed,clickId:a,scriptLink:t.localUpdates.shareId,buttonText:o,isOwner:(0,d.C)(t)?"true":"false"});case 32:return e.abrupt("return",!1);case 33:case"end":return e.stop()}}),e,null,[[3,22]])})));return function(t,n,r,i){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"executeScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=F(regeneratorRuntime.mark((function t(i,a,o,s,u,f){var v,b,y,w,S,k,P,T,E,D;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===f&&(f=[]),n.script=i,n._fetchStatistics={numberOfAttemptedFetches:0,numberOfSuccessfulFetches:0,numberOfFailedFetches:0},v="lastModified"===a,(b=new c.pX("RunScript","User",[],!0)).sendStart({clickId:s}),t.prev=6,w=i.storageScript,!(0,h.Z)()||m.ZP||(0,l.a)(i)||n.sendLogToService(w,b.id,v),S=m.x?n.runtime.getId():n.runtime.executeFunction(M.gM,f),!(0,x.HQ)("DynamicLinterTelemetry")||!i.localUpdates.body){t.next=22;break}return t.prev=11,t.next=14,I.c.promise();case 14:return k=t.sent,t.next=17,e._dynamicLinter.initializationPromise;case 17:y=e._dynamicLinter.lint(i.localUpdates.body,new R.Z(k.getCache()),!0).length>0,t.next=22;break;case 20:t.prev=20,t.t0=t.catch(11);case 22:return t.next=24,S;case 24:if(P=t.sent,!n.runtimeCanceled){t.next=34;break}if(n.dismissMessageBar(n.startTime),n.reduxStore.dispatch(r.KH.cancel()),b.fail(c.in.Information,{storageId:i.storageScript.id,entryPoint:o,isOwner:(0,d.C)(i),driveType:i.storageScript.driveType,apiInfo:i.storageScript.apiInfo,hasDescription:!!i.storageScript.description,isDraft:v,clickId:s,phase:"run",blockedExternalCalls:(0,g.Sq)()||(0,C.$)(i),runtimeId:n.runtime.getId(),stats:N({},n.getRunStats(),n._fetchStatistics),hasIntellisenseMessages:y},new Error("Run cancelled.")),"RunFromButton"!==(0,p.L3)()||!(0,g.jN)("TaskpanelessRFB")){t.next=32;break}return t.next=32,(0,O.dA)(O.vj.officeScriptsRunningStatus,{runStatus:O.Z1.canceled,clickId:s,scriptLink:i.localUpdates.shareId,buttonText:u});case 32:t.next=40;break;case 34:if(n.dismissMessageBar(n.startTime),n.reduxStore.dispatch(r.KH.success({script:i,startTime:n.startTime,result:P})),b.succeed(c.in.Information,{storageId:i.storageScript.id,stats:N({},n.getRunStats(),n._fetchStatistics),entryPoint:o,isOwner:(0,d.C)(i),driveType:i.storageScript.driveType,apiInfo:i.storageScript.apiInfo,hasDescription:!!i.storageScript.description,isDraft:v,clickId:s,blockedExternalCalls:(0,g.Sq)()||(0,C.$)(i),runtimeId:n.runtime.getId(),hasIntellisenseMessages:y}),"RunFromButton"!==(0,p.L3)()||!(0,g.jN)("TaskpanelessRFB")){t.next=40;break}return t.next=40,(0,O.dA)(O.vj.officeScriptsRunningStatus,{runStatus:O.Z1.succeeded,clickId:s,scriptLink:i.localUpdates.shareId,buttonText:u});case 40:t.next=54;break;case 42:return t.prev=42,t.t1=t.catch(6),t.next=46,n.findErrors(t.t1);case 46:if(T=t.sent,E=T.errorMessage,D=T.unexpectedBatchErrorInSyncCode,b.fail(c.in.Information,{storageId:i.storageScript.id,entryPoint:o,isOwner:(0,d.C)(i),driveType:i.storageScript.driveType,apiInfo:i.storageScript.apiInfo,hasDescription:!!i.storageScript.description,isDraft:v,clickId:s,phase:"run",unexpectedBatchErrorInSyncCode:D,blockedExternalCalls:(0,g.Sq)()||(0,C.$)(i),runtimeId:n.runtime.getId(),stats:N({},n.getRunStats(),n._fetchStatistics),hasIntellisenseMessages:y},new Error("Run failed.")),n.onErrorRun(i,E),"RunFromButton"!==(0,p.L3)()||!(0,g.jN)("TaskpanelessRFB")){t.next=54;break}return t.next=54,(0,O.dA)(O.vj.officeScriptsRunningStatus,{runStatus:O.Z1.runFailed,clickId:s,scriptLink:i.localUpdates.shareId,isOwner:(0,d.C)(i)?"true":"false",buttonText:u});case 54:return t.prev=54,t.next=57,n.terminateCurrentRun();case 57:return n.preloadFunction.forget(),n.ensurePreload(),t.finish(54);case 60:case"end":return t.stop()}}),t,null,[[6,42,54,60],[11,20]])})));return function(e,n,r,i,a,o){return t.apply(this,arguments)}}()}),Object.defineProperty(this,"getRunStats",{configurable:!0,enumerable:!0,writable:!0,value:function(){try{return n.runtime.getStats()}catch(e){return{}}}}),Object.defineProperty(this,"cancelRun",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=F(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.runtime){e.next=5;break}return n.runtimeCanceled=!0,e.next=4,n.terminateCurrentRun();case 4:return e.abrupt("return",!0);case 5:return e.abrupt("return",!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"sendLogToService",{configurable:!0,enumerable:!0,writable:!0,value:function(e,t,n){var r,i,a=N({},e,{body:null!=(r=e.body)?r:"",description:null!=(i=e.description)?i:""}),o=new c.pX("LogRun","System");(0,S.$I)((function(e){return(0,f.VO)((0,g.N6)().ClientUrl,a,n,e)}),o,(0,j.ff)(L.Ce)).then((function(){o.succeed(c.in.Information,{parentCallId:t})})).catch((function(e){o.fail(c.in.Warning,{parentCallId:t},e)}))}}),Object.defineProperty(this,"resolveMutexReleasePromise",{configurable:!0,enumerable:!0,writable:!0,value:function(){n.mutexPromiseResolveFn&&n.mutexPromiseResolveFn()}}),Object.defineProperty(this,"telemetryChannel",{configurable:!0,enumerable:!0,writable:!0,value:function(e){if("fetchStarted"===e.eventName){if(n._fetchStatistics.numberOfAttemptedFetches++,(0,g.Sq)()){var t={id:""+n._nextErrorId++,message:strings.General.ExtractPermissionDisabledLog,severity:a.xj.Error};n.reduxStore.dispatch(r.j_.addOutputLogs([t]))}if(n.script&&(0,C.$)(n.script)){var i={id:""+n._nextErrorId++,message:strings.General.BlockSharepointExternalCallLog,severity:a.xj.Error};n.reduxStore.dispatch(r.j_.addOutputLogs([i]))}}else"fetchEnded"===e.eventName&&(e.success?n._fetchStatistics.numberOfSuccessfulFetches++:n._fetchStatistics.numberOfFailedFetches++)}}),Object.defineProperty(this,"processLogs",{configurable:!0,enumerable:!0,writable:!0,value:function(e){n.reduxStore.dispatch(r.j_.addOutputLogs(e));var t=i.j6.getIsDetailsPageVisible(n.reduxStore.getState()),o="RunFromButton"===(0,p.L3)();t||o||(n.reduxStore.dispatch(r.j_.setCurrentPivot(a.Fh.Output)),n.reduxStore.dispatch(r.j_.show()))}}),Object.defineProperty(this,"dismissMessageBar",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=F(regeneratorRuntime.mark((function e(t){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Date.now()-t,1e3,!(i<1e3)){e.next=5;break}return e.next=5,(0,v.D)(1e3-i);case 5:n.reduxStore.dispatch(r.t5.dismiss());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"onErrorRun",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=F(regeneratorRuntime.mark((function e(t,o){var s,c,u,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=o||strings.Message.UnexpectedError,n.reduxStore.dispatch(r.KH.failure({errorMessage:s,script:t})),c={id:""+n._nextErrorId++,message:s,severity:a.xj.Error},n.reduxStore.dispatch(r.j_.addOutputLogs([c])),(u=i.j6.getIsDetailsPageVisible(n.reduxStore.getState()))||(n.reduxStore.dispatch(r.j_.setCurrentPivot(a.Fh.Output)),n.reduxStore.dispatch(r.j_.show())),l=i.j_.getIsVisible(n.reduxStore.getState()),d=l&&!u,n.reduxStore.dispatch(r.t5.show({style:1,forceSingleLine:!0,text:strings.Message.ScriptRanWithErrorsError,buttons:d?[]:[{isPrimary:!0,text:strings.General.ViewLogs,actions:[r.j_.setCurrentPivot(a.Fh.Output),r.j_.show()]}]}));case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}),this.reduxStore=t,this.mutex=new y.W;var b=function(e){return function(t,n){var r=n[0].map((function(e){return{id:(++s).toString(),message:e,severity:t}}));e(r)}}(this.processLogs);this.runtimeConsole=function(e){var t=(0,o.Z)(["log","info","warn","error"]).reduce((function(t,n){return t[n]=function(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),a=1;a<r;a++)i[a-1]=arguments[a];return e(n,i)},t}),{});return t}(b),this.runtimeTracker=new T.S(this.runtimeConsole,this.telemetryChannel),this.preloadFunction=new P.P((function(){return n.runtimeTracker.preloadRuntime()}))}var t=e.prototype;return t.terminateCurrentRun=function(){var e=F(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.runtime.terminate());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.findErrors=function(){var e=F(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,w.a)(t));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e}();Object.defineProperty(A,"_instance",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(A,"_dynamicLinter",{configurable:!0,enumerable:!0,writable:!0,value:new k.Z}),Object.defineProperty(A,"instance",{configurable:!0,enumerable:!0,writable:!0,value:function(){return A._instance||(A._instance=new A((0,b.v)())),A._instance}})},46201:function(e,t,n){n.d(t,{Lc:function(){return V}});var r=n(90828),i=n(52105);function a(e){if("RunFromButton"===(0,i.L3)())return r.w.runFromButton.getActiveScript(e.getState());var t=r.w.editor.getActiveScriptId(e.getState());return r.w.scripts.get(e.getState(),t)}var o=n(35826),s=n(82750),c=n(65086),u=n(47272),l=n(86709),d=n(21830),p=n(57464),f=n(83542),g=n(15592),h=n(54050),m=n(9617),v=n(58351),b=n(64295),y=n(38104),w=n(34961),S=n(81066);function x(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function R(e,t){return R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},R(e,t)}var P=function(e){var t,n;function r(t,n,r,i){var a;return void 0===i&&(i=!0),a=e.call(this,n,r,i)||this,Object.defineProperty(k(a),"activeScript",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(k(a),"displayDialog",{configurable:!0,enumerable:!0,writable:!0,value:function(){return a.displayDialogAsync(l.rn.parameterized,[])}}),Object.defineProperty(k(a),"processDialogEvent",{configurable:!0,enumerable:!0,writable:!0,value:function(e){var t=12006===e.error;t?a.activity.succeed(v.in.Information,{dialogType:l.rn.parameterized,isDismissed:!0}):a.activity.fail(v.in.Error,{dialogType:l.rn.parameterized,errorCode:e.error},new Error("Received error event from dialog!")),a.closeDialog(t,"canceled")}}),Object.defineProperty(k(a),"processDialogMessage",{configurable:!0,enumerable:!0,writable:!0,value:function(e){if(e.error)a.activity.fail(v.in.Error,{dialogType:l.rn.parameterized,errorCode:e.error},new Error("Error found inside dialog message!")),a.closeDialog(!1,"canceled");else{var t=(0,c.r)(e.message);t&&(t.messageType===l.Q4.onRegisterMessageComplete?t.success?a.sendDialogProps():(a.activity.fail(v.in.Error,{dialogType:l.rn.parameterized},new Error("Failed to register message listener on dialog!")),a.closeDialog(!1,"canceled")):t.messageType===l.Q4.onButtonClick&&a.handleDialogButtonClick(t.props))}}}),Object.defineProperty(k(a),"handleDialogButtonClick",{configurable:!0,enumerable:!0,writable:!0,value:function(e){if(e.buttonId===l.zf.accept){var t=e.userInputs;a.closeDialog(!1,t)}else e.buttonId===l.hK.deny||e.buttonId===l.hK.close?a.closeDialog(!1,"denied"):e.buttonId===l.hK.viewScript&&(a.closeDialog(!1,"canceled"),(0,b.Z)(a.activeScript));a.activity.succeed(v.in.Information,{dialogType:l.rn.parameterized,buttonId:e.buttonId,userStates:e.userStates})}}),Object.defineProperty(k(a),"sendDialogProps",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,n,r,i,o,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,g.M)((0,h.Zd)()),n=(0,m.Y)(t),r=strings.substitute(strings.Backstage.ScriptItemUserOwnedOneDriveRootFolderText,{creator:a.activeScript.storageScript.creatorDisplayName||""}),i=r+f.jX,o=y.E.instance().getCachedValue((0,w.O3)(),a.activeScript),s={header:strings.Dialog.ParameterizedDialogHeader,description:strings.Dialog.ParameterizedDialogDescription,subDescription:strings.Dialog.ParameterizedDialogSubDescription,folderPath:S.X.instance().isTeamOwnershipUXEnabled()||(0,p.$)(a.activeScript)?null!=o?o:(0,y.R)(a.activeScript.storageScript):i,ariaLabels:{closeButton:strings.General.CloseButtonLabel},ariaDescriptions:{submitButton:strings.Dialog.ParameterizedDialogSubmitButtonAriaDescription,cancelButton:strings.Dialog.ParameterizedDialogCancelButtonAriaDescription},submitButton:strings.Dialog.ParameterizedDialogSubmitButton,cancelButton:strings.Dialog.ParameterizedDialogCancelButton,dropDownOptionLabel:strings.Dialog.ParameterizedDialogDropDownOptionLabel,dropDownFalseText:strings.Dialog.ParameterizedDialogDropDownFalseText,dropDownTrueText:strings.Dialog.ParameterizedDialogDropDownTrueText,dropDownPlaceholder:strings.Dialog.ParameterizedDialogDropDownPlaceholder},c={dialogType:l.rn.parameterized,isRTL:(0,d.zg)(),dialogProps:{script:a.activeScript,localizedStrings:s,theme:n}},a.messageChild(c);case 8:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){x(a,r,i,o,s,"next",e)}function s(e){x(a,r,i,o,s,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}()}),a.activeScript=t,a}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,R(t,n),r}(u.S),C=n(92250),I=n(75434);function O(e,t){return O=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},O(e,t)}function T(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function E(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){T(a,r,i,o,s,"next",e)}function s(e){T(a,r,i,o,s,"throw",e)}o(void 0)}))}}var D=function(){function e(){Object.defineProperty(this,"cancelCalled",{configurable:!0,enumerable:!0,writable:!0,value:!1}),Object.defineProperty(this,"currentChildren",{configurable:!0,enumerable:!0,writable:!0,value:[]})}var t=e.prototype;return t.cancel=function(){var e=E(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.cancelCalled=!0,t=this.currentChildren.map((function(e){return n.cancelChild(e)})),e.next=4,Promise.all(t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.isCanceled=function(){return this.cancelCalled},t.runChildRunnable=function(){var e=E(regeneratorRuntime.mark((function e(t){var n,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.currentChildren.push(t),this.isCanceled()&&t.cancel(),n=t.run(),r=function(){return i.removeFromChildren(t)},n.then(r).catch(r),e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),t.cancelChild=function(){var e=E(regeneratorRuntime.mark((function e(t){var n,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.cancel(),r=function(){return i.removeFromChildren(t)},n.then(r).catch(r),e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t.removeFromChildren=function(e){var t=this.currentChildren.indexOf(e);t>=0&&this.currentChildren.splice(t,1)},e}(),M=function(e){var t,n;function r(t){var n;return n=e.call(this)||this,Object.defineProperty(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n),"lambdaFn",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),n.lambdaFn=t,n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,O(t,n);var i=r.prototype;return i.run=function(){var e=E(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.lambdaFn(this));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),i.runChildLambda=function(){var e=E(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.runChildRunnable(new r(t)));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),r}(D),j=n(57222),L=n(32613),N=n(67796),B=n(2898);function F(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function A(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){F(a,r,i,o,s,"next",e)}function s(e){F(a,r,i,o,s,"throw",e)}o(void 0)}))}}function U(e){var t="function"===typeof Map?new Map:void 0;return U=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return z(e,arguments,W(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),H(r,e)},U(e)}function z(e,t,n){return z=_()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&H(i,n.prototype),i},z.apply(null,arguments)}function _(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function H(e,t){return H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},H(e,t)}function W(e){return W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},W(e)}var Z,G=function(e){var t,n;function r(t,n){var r;return r=e.call(this,t)||this,Object.defineProperty(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r),"errorCode",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),r.errorCode=n,r}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,H(t,n),r}(U(Error));!function(e){e[e.canceledEarly=0]="canceledEarly",e[e.canceledLate=1]="canceledLate",e[e.consentDenied=2]="consentDenied",e[e.scriptNotFound=3]="scriptNotFound",e[e.scriptHasNoBody=4]="scriptHasNoBody",e[e.prepareFailed=5]="prepareFailed"}(Z||(Z={}));var V=function(e,t,n,c){var u=this;Object.defineProperty(this,"rootRunnable",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"activity",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"script",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"entryPoint",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clickId",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"buttonText",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reduxStore",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=A(regeneratorRuntime.mark((function e(t){var n,r,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u.script=t,e.next=4,u.rootRunnable.run();case 4:B.L.instance().isRuntimeCanceled()?u.activity.fail(v.in.Information,{storageId:null==(n=u.script)?void 0:n.storageScript.id,version:u.version,entryPoint:u.entryPoint,clickId:u.clickId},new Error("Run cancelled.")):u.activity.succeed(v.in.Information,{storageId:null==(r=u.script)?void 0:r.storageScript.id,version:u.version,entryPoint:u.entryPoint,clickId:u.clickId}),e.next=12;break;case 7:e.prev=7,e.t0=e.catch(0),a=e.t0,u.handleRunnableError(a),u.activity.fail(v.in.Information,{storageId:null==(i=u.script)?void 0:i.storageScript.id,version:u.version,entryPoint:u.entryPoint,clickId:u.clickId,errorCode:a.errorCode},e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"cancel",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=A(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.rootRunnable.cancel();case 2:return e.next=4,B.L.instance().cancelRun();case 4:return t=e.sent,e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"getCurrentScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){return u.script}}),Object.defineProperty(this,"createRunnable",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=function(){var e=A(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u.script||(u.script=a(u.reduxStore)),u.script){e.next=3;break}throw new G("Does not have a script to run!",Z.scriptNotFound);case 3:if(!t.isCanceled()){e.next=5;break}throw new G("Runnable already canceled!",Z.canceledEarly);case 5:if(B.L.instance().ensureScriptBody(u.script,u.version)){e.next=8;break}throw new G("Active script has no body!",Z.scriptHasNoBody);case 8:return e.next=10,u.runCheckConsentLambda(t,u.script);case 10:if(n=e.sent){e.next=15;break}return e.next=14,u.runConsentDialogLambda(t,u.script);case 14:n=e.sent;case 15:if(n){e.next=18;break}throw"RunFromButton"===(0,i.L3)()&&(0,I.jN)("TaskpanelessRFB")&&(0,C.Ls)(C.vj.officeScriptsRunningStatus),new G("Consent is denied!",Z.consentDenied);case 18:if(r=[],void 0===u.script.localUpdates.parameterInfo||!(0,s.HQ)("EnableParameterizedDialog")){e.next=27;break}if(!JSON.parse(u.script.localUpdates.parameterInfo).parameterSchema.properties){e.next=27;break}return e.next=24,u.runParameterizedLambda(t,u.script);case 24:if("canceled"!==(r=e.sent)&&"denied"!==r){e.next=27;break}throw new G("Runnable already canceled!",Z.canceledEarly);case 27:if("RunFromButton"!==(0,i.L3)()||!(0,I.jN)("TaskpanelessRFB")){e.next=30;break}return e.next=30,(0,C.dA)(C.vj.officeScriptsRunningStatus,{runStatus:C.Z1.running,clickId:u.clickId,scriptLink:u.script.localUpdates.shareId,buttonText:u.buttonText});case 30:return e.next=32,u.runPrepareScriptLambda(t,u.script);case 32:if(e.sent){e.next=35;break}throw new G("Preparing script failed!",Z.prepareFailed);case 35:return e.next=37,u.runExecuteScriptLambda(t,u.script,r);case 37:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return new M(e)}}),Object.defineProperty(this,"handleRunnableError",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=A(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.errorCode,e.next=e.t0===Z.consentDenied?3:e.t0===Z.canceledLate?5:7;break;case 3:return u.reduxStore.dispatch(r.N.run.consentDenied()),e.abrupt("break",8);case 5:return u.reduxStore.dispatch(r.N.run.cancel()),e.abrupt("break",8);case 7:return e.abrupt("break",8);case 8:if(t.errorCode!==Z.canceledLate&&t.errorCode!==Z.canceledEarly){e.next=12;break}if("RunFromButton"!==(0,i.L3)()||!(0,I.jN)("TaskpanelessRFB")){e.next=12;break}return e.next=12,(0,C.dA)(C.vj.officeScriptsRunningStatus,{runStatus:C.Z1.canceled,clickId:u.clickId,scriptLink:u.script.localUpdates.shareId,buttonText:u.buttonText});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"runExecuteScriptLambda",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=A(regeneratorRuntime.mark((function e(t,n,r){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isCanceled()){e.next=2;break}throw new G("Runnable canceled before executing the script!",Z.canceledLate);case 2:return i=function(){var e=A(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",B.L.instance().executeScript(n,u.version,u.entryPoint,u.clickId,u.buttonText,r));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.abrupt("return",t.runChildLambda(i));case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"runPrepareScriptLambda",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=A(regeneratorRuntime.mark((function e(t,n){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isCanceled()){e.next=2;break}throw new G("Runnable canceled before preparing the script!",Z.canceledEarly);case 2:return u.reduxStore.dispatch(r.N.messageBar.show({isBlocking:!0,forceSingleLine:!0,text:strings.Message.ScriptRunning,buttons:[{isPrimary:!0,text:strings.General.StopButtonText,actions:[r.N.messageBar.dismiss()],additionalOnClickCallback:function(){return u.cancel()}}]})),i=function(){var e=A(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",B.L.instance().prepareScript(n,u.version,u.clickId,u.buttonText));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.abrupt("return",t.runChildLambda(i));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"runCheckConsentLambda",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=A(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isCanceled()){e.next=2;break}throw new G("Runnable canceled before checking consent!",Z.canceledEarly);case 2:return r=function(){var e=A(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!(!(0,L.H)(n)&&!(0,N.a)(n))||j.t.instance().checkConsent(n));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),e.abrupt("return",t.runChildLambda(r));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"runConsentDialogLambda",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=A(regeneratorRuntime.mark((function e(t,n){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isCanceled()){e.next=2;break}throw new G("Runnable canceled before showing consent dialog!",Z.canceledEarly);case 2:return r=new v.pX("ConsentToRun","User"),"RunFromButton"===(0,i.L3)()&&r.sendStart({clickId:u.clickId}),e.next=6,t.runChildLambda((function(){return j.t.instance().showConsentDialog(n)}));case 6:return a=e.sent,r.succeed(v.in.Information,{accepted:!!a,storageId:n.storageScript.id,entryPoint:u.entryPoint,clickId:u.clickId}),e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"runParameterizedLambda",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=A(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isCanceled()){e.next=2;break}throw new G("Runnable canceled before showing parameterized dialog!",Z.canceledEarly);case 2:return e.next=4,t.runChildLambda((function(){return new P(n,480,390).displayDialog()}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}),this.reduxStore=(0,o.v)(),this.version=e,this.entryPoint=t,this.clickId=n,this.buttonText=c,this.rootRunnable=this.createRunnable(),this.activity=new v.pX("RuntimeRunnable","User",[],!0)}},38843:function(e,t,n){n.d(t,{ZP:function(){return Me},T_:function(){return et},QH:function(){return Le},k5:function(){return je}});var r=n(24637),i=n(24654),a=n(90828),o=n(42803),s=n(80228),c=n(63252),u=n(17425),l=n(58351),d=n(52105),p=n(70546),f=n(59408),g=n(66052);function h(e){var t="function"===typeof Map?new Map:void 0;return h=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return m(e,arguments,y(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),b(r,e)},h(e)}function m(e,t,n){return m=v()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&b(i,n.prototype),i},m.apply(null,arguments)}function v(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function b(e,t){return b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},b(e,t)}function y(e){return y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},y(e)}function w(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function S(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){w(a,r,i,o,s,"next",e)}function s(e){w(a,r,i,o,s,"throw",e)}o(void 0)}))}}function x(e,t){return k.apply(this,arguments)}function k(){return(k=S(regeneratorRuntime.mark((function e(t,r){var i,a,o,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=[],e.prev=1,e.next=4,(0,p.Z)(r);case 4:i=e.sent,e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(1),new R("Could not import intellisense functions");case 10:return e.prev=10,e.next=13,(0,g.S)("parser",(function(){return n.e(7330).then(n.bind(n,93593))}));case 13:a=e.sent,e.next=19;break;case 16:throw e.prev=16,e.t1=e.catch(10),new R("Could not import parser functions");case 19:return o=a.parseTypescriptToFlow,s=a.MakerApiType,c=r===f.M.synchronous?s.MakerSyncApi:s.BatchApi,e.abrupt("return",o(t,{libSource:i,makerApiType:c,parseImplicitTypes:!0}));case 23:case"end":return e.stop()}}),e,null,[[1,7],[10,16]])})))).apply(this,arguments)}var R=function(e){var t,n;function r(){return e.apply(this,arguments)||this}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,b(t,n),r}(h(Error)),P=n(87356),C=n(54050),I=n(34676),O=n(74844),T=n(20260),E=n(13753),D=n(44434),M=n(19588),j=n(89281),L=n(98320),N=n(38186),B=n(3515),F=new(function(){function e(e){if(Object.defineProperty(this,"searches",{configurable:!0,enumerable:!0,writable:!0,value:[]}),this.searches=e.map((function(e){var t=e.tokens;if(0===t.length)throw new Error("No search terms found for key "+e.id);var n=t.map((function(e){return e.toLowerCase()})).join("|");return{linkId:e.id,exp:new RegExp(n,"i")}})),0===this.searches.length)throw new Error("No keys provided for recommender")}var t=e.prototype;return t.recommend=function(e,t){var n=this.createCounts(e);return(0,B.jP)(n,t)},t.createCounts=function(e){var t=this,n=this.emptyCounts();return e.split("\n").forEach((function(e){t.searches.forEach((function(t){e.match(t.exp)&&n[t.linkId]++}))})),n},t.getName=function(){return"NLPV1"},t.emptyCounts=function(){var e={};return this.searches.forEach((function(t){e[t.linkId]=0})),e},e}())([{id:"contextualHelpRange",tokens:["range","cell","grid",strings.Recommendations.Range]},{id:"contextualHelpWorkbook",tokens:["book","document","workbook",strings.Recommendations.Workbook]},{id:"contextualHelpPivotTable",tokens:["pivot",strings.Recommendations.PivotTable]},{id:"contextualHelpChart",tokens:["chart",strings.Recommendations.Chart]},{id:"contextualHelpComment",tokens:["comment","mention","task",strings.Recommendations.Comment]},{id:"contextualHelpRangeFormat",tokens:["format","color","range",strings.Recommendations.RangeFormat]},{id:"contextualHelpShape",tokens:["shape",strings.Recommendations.Shape]},{id:"contextualHelpTable",tokens:["table",strings.Recommendations.Table]},{id:"contextualHelpWorksheet",tokens:["worksheet","sheet",strings.Recommendations.Worksheet]}]);function A(){return F}var U=n(28722),z=n(22883),_=n(1645),H=n(72558),W=n(82750),Z=n(71849);function G(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function V(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){G(a,r,i,o,s,"next",e)}function s(e){G(a,r,i,o,s,"throw",e)}o(void 0)}))}}function X(e){return Q.apply(this,arguments)}function Q(){return Q=V(regeneratorRuntime.mark((function e(t){var n,r,i,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,W.HQ)("ScriptOM")){e.next=9;break}return e.next=3,Z.I.instance();case 3:return n=e.sent,e.next=6,Promise.all(t.map(function(){var e=V(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.getSharedScript(t).catch((function(){})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 6:return r=e.sent,i=r.filter((function(e){return void 0!==e})),e.abrupt("return",i);case 9:return e.next=11,s.X.instance();case 11:return a=e.sent,e.next=14,a.fetchAllDocAttachedScripts(t);case 14:return(o=e.sent).forEach((function(e){(0,u.HN)(e),(0,u.kg)({shareId:e.localUpdates.shareId,storageId:e.storageScript.id})})),e.abrupt("return",o);case 17:case"end":return e.stop()}}),e)}))),Q.apply(this,arguments)}function q(e,t){var n=t.map((function(e){return e.localUpdates.shareId})),r=e.filter((function(e){return!n.includes(e)}));return t.forEach((function(e){(0,u.kg)({shareId:e.localUpdates.shareId,storageId:e.storageScript.id})})),r}function J(e){return(0,u.MC)().filter((function(t){var n=!1;return e.forEach((function(e){t.shareId===e&&(n=!0)})),n}))}function K(e,t){return(e=e.filter((function(e){return void 0!==e}))).map((function(e){return e.localUpdates.shareId=(0,O.vT)(e.storageScript.id,t),e}))}function $(e,t){var n=e.filter((function(e){return void 0!==e.localUpdates.shareId})).map((function(e){return e.localUpdates.shareId}));return t.filter((function(e){return!n.includes(e)}))}var Y=n(59013),ee=n(84824),te=n(75434),ne=n(44444),re=n(23873),ie=n(48562),ae=n(88859),oe=n(89991),se=n(81066),ce=n(5523);function ue(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function le(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){ue(a,r,i,o,s,"next",e)}function s(e){ue(a,r,i,o,s,"throw",e)}o(void 0)}))}}function de(){return de=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},de.apply(this,arguments)}var pe=regeneratorRuntime.mark(Me),fe=regeneratorRuntime.mark(je),ge=regeneratorRuntime.mark(Le),he=regeneratorRuntime.mark(Ne),me=regeneratorRuntime.mark(Be),ve=regeneratorRuntime.mark(Fe),be=regeneratorRuntime.mark(Ae),ye=regeneratorRuntime.mark(Ue),we=regeneratorRuntime.mark(ze),Se=regeneratorRuntime.mark(_e),xe=regeneratorRuntime.mark(He),ke=regeneratorRuntime.mark(We),Re=regeneratorRuntime.mark(Ze),Pe=regeneratorRuntime.mark(Ge),Ce=regeneratorRuntime.mark(Ve),Ie=regeneratorRuntime.mark(qe),Oe=regeneratorRuntime.mark(Je),Te=regeneratorRuntime.mark(Ke),Ee=regeneratorRuntime.mark($e),De=regeneratorRuntime.mark(Ye);function Me(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.ib)((0,i.getType)(a.N.scripts.fetchMRUMetadataFromStorage.request),Ae);case 2:return e.next=4,(0,r.ib)((0,i.getType)(a.N.scripts.fetchMetadataFromStorage.request),Ue);case 4:return e.next=6,(0,r.ib)((0,i.getType)(a.N.scripts.fetchScriptsFromDocument.request),ze);case 6:return e.next=8,(0,r.ib)((0,i.getType)(a.N.scripts.fetchSamples.request),_e);case 8:return e.next=10,(0,r.ib)((0,i.getType)(a.N.editor.setActive),Ne);case 10:return e.next=12,(0,r.ib)((0,i.getType)(a.N.scripts.fetchScriptFromStorage.success),He);case 12:return e.next=14,(0,r.ib)((0,i.getType)(a.N.scripts.fetchSharedScriptFromStorage.success),Ze);case 14:return e.next=16,(0,r.ib)((0,i.getType)(a.N.scripts.invokeFilePicker),Be);case 16:return e.next=18,(0,r.ib)((0,i.getType)(a.N.scripts.editBody),qe);case 18:return e.next=20,(0,r.ib)((0,i.getType)(a.N.scripts.remove.request),Ge);case 20:return e.next=22,(0,r.ib)((0,i.getType)(a.N.scripts.remove.success),Ve);case 22:return e.next=24,(0,r.ib)((0,i.getType)(a.N.scripts.addButtonToWorkbook.request),Je);case 24:return e.next=26,(0,r.ib)((0,i.getType)(a.N.scripts.addScriptToWorkbook.request),Ke);case 26:return e.next=28,(0,r.ib)((0,i.getType)(a.N.scripts.removeScriptFromWorkbook.request),$e);case 28:return e.next=30,(0,r.ib)((0,i.getType)(a.N.scripts.unshareScriptFromAllWorkbooks.request),Ye);case 30:case"end":return e.stop()}}),pe)}function je(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(0,W.HQ)("ScriptOM")){t.next=8;break}return t.next=3,(0,r.RE)(ce.L.getInstance);case 3:return e=t.sent,t.next=6,(0,r.RE)(e.getRecentScripts);case 6:t.next=12;break;case 8:return t.next=10,(0,r.gz)(a.N.scripts.fetchMRUMetadataFromStorage.request());case 10:return t.next=12,(0,r.S3)({success:(0,r.qn)((0,i.getType)(a.N.scripts.fetchMRUMetadataFromStorage.success)),failure:(0,r.qn)((0,i.getType)(a.N.scripts.fetchMRUMetadataFromStorage.failure))});case 12:case"end":return t.stop()}}),fe)}function Le(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.gz)(a.N.scripts.fetchMetadataFromStorage.request());case 2:return e.next=4,(0,r.S3)({success:(0,r.qn)((0,i.getType)(a.N.scripts.fetchMetadataFromStorage.success)),failure:(0,r.qn)((0,i.getType)(a.N.scripts.fetchMetadataFromStorage.failure))});case 4:if("Editor"!==(0,d.L3)()){e.next=9;break}return e.next=7,(0,r.gz)(a.N.scripts.fetchScriptsFromDocument.request());case 7:return e.next=9,(0,r.gz)(a.N.scripts.fetchSamples.request());case 9:case"end":return e.stop()}}),ge)}function Ne(e){var t,n,i;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,r.Ys)(a.w.scripts.get,e.payload.id);case 2:if(t=o.sent,n=e.payload.forceRefetch,i=e.payload.attemptToRun,!(0,W.HQ)("EnableMRUExperience")||!t){o.next=8;break}return o.next=8,(0,r.gz)(a.N.scripts.moveMRUScriptToTop({id:t.storageScript.id}));case 8:if(!t||!t.storageScript.dateFirstPublished){o.next=16;break}if((0,ne.Gq)(t),(0,ne.W9)(t).catch((function(){})),!1===n){o.next=14;break}return o.next=14,(0,r.RE)(Fe,t,i);case 14:o.next=17;break;case 16:!0===i&&(0,ae.I)(t,"Backstage");case 17:case"end":return o.stop()}}),he)}function Be(){var e,t,n,i,s,c,u,d,p,f,g;return regeneratorRuntime.wrap((function(h){for(;;)switch(h.prev=h.next){case 0:return e=new l.pX("GetPickedScript","User"),h.next=3,(0,r.gz)(a.N.editor.setActive({id:null}));case 3:return t=void 0,n=void 0,h.prev=5,h.next=8,(0,r.RE)(C.oq);case 8:void 0!==(i=h.sent)&&(s=i.driveId,c=i.id,t=s,n=c),h.next=25;break;case 12:if(h.prev=12,h.t0=h.catch(5),!(0,ie.s)(h.t0)){h.next=18;break}e.succeed(l.in.Information,{cancelled:!0}),h.next=25;break;case 18:return e.fail(l.in.Error,{},h.t0),h.next=21,(0,r.gz)(a.N.backstage.setCurrentPivot("Recent"));case 21:return h.next=23,(0,r.gz)(a.N.backstage.show());case 23:return h.next=25,(0,r.gz)(a.N.messageBar.show({style:1,text:strings.Message.FilePickerFailed}));case 25:if(h.prev=25,void 0===t||void 0===n){h.next=53;break}return h.next=29,(0,r.gz)(a.N.editor.showDetailsPage());case 29:return h.next=31,(0,r.gz)(a.N.backstage.hide());case 31:if(!(0,W.HQ)("ScriptOM")){h.next=40;break}return h.next=34,(0,r.RE)(ce.L.getInstance);case 34:return d=h.sent,h.next=37,(0,r.RE)(d.getGraphScriptAndNavigate,t,n);case 37:u=h.sent,h.next=46;break;case 40:return h.next=42,(0,r.RE)(o.c.instance);case 42:return p=h.sent,h.next=45,(0,r.RE)(p.getGraphScript,t,n);case 45:u=h.sent;case 46:return e.succeed(l.in.Information,{storageId:u.storageScript.id}),h.next=49,(0,r.gz)(a.N.editor.setActive({id:u.storageScript.id,forceRefetch:!1}));case 49:return h.next=51,(0,r.RE)(C.vI,{operationName:"Open",scriptMetadata:(0,D.Z)(u)});case 51:return h.next=53,(0,r.gz)(a.N.scripts.fetchScriptFromStorage.success({script:u}));case 53:h.next=69;break;case 55:if(h.prev=55,h.t1=h.catch(25),f=!!h.t1.hasCached,e.fail(f?l.in.ASHA:l.in.Error,{},h.t1),f){h.next=69;break}return h.next=62,(0,r.gz)(a.N.backstage.setCurrentPivot("Recent"));case 62:return h.next=64,(0,r.gz)(a.N.editor.hideDetailsPage());case 64:return h.next=66,(0,r.gz)(a.N.backstage.show());case 66:return g=(0,z.IG)(h.t1)?strings.Message.FailedToOpenDeletedScriptMessage:(0,z.ZX)(h.t1)?strings.Message.TimeOutErrorMessage:(0,z.HZ)(h.t1)?strings.Message.NoAccessToGetScriptMessage:strings.Message.FailedToOpenScriptMessage,h.next=69,(0,r.gz)(a.N.messageBar.show({style:1,text:g}));case 69:case"end":return h.stop()}}),me,null,[[5,12],[25,55]])}function Fe(e,t){var n,i,p,f,g,h,m,v,b,y,w,S,x,k;return regeneratorRuntime.wrap((function(R){for(;;)switch(R.prev=R.next){case 0:return i=Date.now(),R.next=3,(0,r.Ys)(a.w.scripts.getAttachingStatus,e.storageScript.id);case 3:if("InProgress"===R.sent){R.next=7;break}return R.next=7,(0,r.gz)(a.N.scripts.updateAttachingStatus({id:e.storageScript.id,status:"None"}));case 7:if(!(0,T.C)(e)){R.next=64;break}return R.prev=8,R.next=11,(0,r.gz)(a.N.scripts.storageCallInProgress({id:e.storageScript.id}));case 11:return R.next=13,(0,r.RE)(o.c.instance);case 13:return p=R.sent,R.next=16,(0,r.RE)(p.getScript,(0,Y.c)(e));case 16:if(f=R.sent,!(0,W.HQ)("ScriptOM")){R.next=25;break}return R.next=20,(0,r.RE)(Z.I.instance);case 20:return g=R.sent,R.next=23,(0,r.RE)(g.updateScriptsCacheInPlace,f,Z.I.SCRIPTS_KEY);case 23:return R.next=25,(0,r.RE)(g.updateScriptsCacheInPlace,f,Z.I.RECENT_SCRIPTS_KEY);case 25:return n=f,R.next=28,(0,r.gz)(a.N.scripts.fetchScriptFromStorage.success({script:f,attemptToRun:t}));case 28:if(!(0,W.HQ)("EnableMRUExperience")){R.next=35;break}return R.next=31,(0,r.Ys)(a.w.scripts.get,f.storageScript.id);case 31:if(!(h=R.sent)){R.next=35;break}return R.next=35,(0,r.RE)(C.vI,{operationName:"Open",scriptMetadata:(0,D.Z)(h)});case 35:R.next=58;break;case 37:return R.prev=37,R.t0=R.catch(8),R.next=41,(0,r.gz)(a.N.scripts.fetchScriptFromStorage.failure({error:R.t0}));case 41:if(m=(0,z.IG)(R.t0)&&(0,W.HQ)("EnableMRUExperience"),(0,N.o)(e)&&!m){R.next=58;break}if(v=(0,z.IG)(R.t0)?strings.Message.FailedToOpenDeletedScriptMessage:(0,z.ZX)(R.t0)?strings.Message.TimeOutErrorMessage:(0,z.HZ)(R.t0)?strings.Message.NoAccessToGetScriptMessage:strings.Message.FailedToOpenScriptMessage,"Editor"!==(0,d.L3)()){R.next=58;break}if(!m){R.next=52;break}return R.next=48,(0,r.gz)(a.N.scripts.removeMRUScript(e));case 48:return R.next=50,(0,r.RE)(u.nP,e.storageScript.id);case 50:return R.next=52,(0,r.RE)(C.vI,{operationName:"Delete",scriptMetadata:(0,D.Z)(e)});case 52:return R.next=54,(0,r.gz)(a.N.backstage.setCurrentPivot("Recent"));case 54:return R.next=56,(0,r.gz)(a.N.backstage.show());case 56:return R.next=58,(0,r.gz)(a.N.messageBar.show({style:1,text:v}));case 58:return R.prev=58,R.next=61,(0,r.gz)(a.N.scripts.storageCallComplete({id:e.storageScript.id}));case 61:return R.finish(58);case 62:R.next=110;break;case 64:if(!e.localUpdates.shareId){R.next=109;break}return R.prev=65,R.next=68,(0,r.gz)(a.N.scripts.storageCallInProgress({id:e.storageScript.id}));case 68:return R.next=70,(0,r.RE)(s.X.instance);case 70:return b=R.sent,R.next=73,(0,r.RE)(b.getSharedScript,e.localUpdates.shareId);case 73:if(y=R.sent,n=y,!(0,W.HQ)("ScriptOM")){R.next=82;break}return R.next=78,(0,r.RE)(Z.I.instance);case 78:w=R.sent,S=y.storageScript.id,w.indirectionCache.write(e.localUpdates.shareId,S),w.scriptCache.setValue({id:S},y);case 82:return R.next=84,(0,r.gz)(a.N.scripts.fetchSharedScriptFromStorage.success({script:n,attemptToRun:t}));case 84:R.next=103;break;case 86:if(R.prev=86,R.t1=R.catch(65),!(0,z.HZ)(R.t1)){R.next=93;break}return R.next=91,(0,r.RE)(c.I.instance);case 91:R.sent.detachScriptFromWorkbook((0,O._n)(e.storageScript.id,e.localUpdates.shareId),"Cleanup").catch((function(){}));case 93:return x=(0,z.IG)(R.t1)?strings.Message.FailedToOpenUnsharedScriptMessage:strings.Message.FailedToOpenSharedScriptMessage,R.next=96,(0,r.gz)(a.N.scripts.fetchSharedScriptFromStorage.failure({error:R.t1}));case 96:if("Editor"!==(0,d.L3)()){R.next=103;break}return R.next=99,(0,r.gz)(a.N.backstage.setCurrentPivot("Attached"));case 99:return R.next=101,(0,r.gz)(a.N.backstage.show());case 101:return R.next=103,(0,r.gz)(a.N.messageBar.show({style:1,text:x}));case 103:return R.prev=103,R.next=106,(0,r.gz)(a.N.scripts.storageCallComplete({id:e.storageScript.id}));case 106:return R.finish(103);case 107:R.next=110;break;case 109:!0===t&&(0,ae.I)(e,"Backstage");case 110:k=Date.now(),n&&(0,l.ve)({eventName:"RefetchScript",eventType:"System",data:{logLevel:l.in.Information,storageId:e.storageScript.id,location:"setActive",hasUpdatedBody:e.localUpdates.body!==n.localUpdates.body,scriptFetchTimeMs:k-i,timeSinceLastSaveMs:Date.now()-e.localUpdates.dateLastModified}});case 112:case"end":return R.stop()}}),ve,null,[[8,37,58,62],[65,86,103,107]])}function Ae(e){var t,n,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,r.RE)(o.c.instance);case 3:return t=e.sent,e.next=6,(0,r.RE)(t.getRecentScripts);case 6:return n=e.sent,i=n.map((function(e){return(0,oe.k)(de({},e,{isCreator:!0}))})),(0,W.HQ)("EnableMRUExperience")&&se.X.instance().setMRUAndCheck(i),e.next=11,(0,r.gz)(a.N.scripts.fetchMRUMetadataFromStorage.success({scripts:i}));case 11:if(!(0,W.HQ)("EnableMRUExperience")){e.next=20;break}return e.next=14,(0,r.Ys)(a.w.scripts.getAllDocAttachedScripts);case 14:return s=e.sent,e.next=17,(0,r.gz)(a.N.scripts.updateMRUScriptsIfShared({scripts:s}));case 17:if("Editor"!==(0,d.L3)()){e.next=20;break}return e.next=20,(0,r.gz)(a.N.scripts.mruScriptMetadataReceived());case 20:e.next=26;break;case 22:return e.prev=22,e.t0=e.catch(0),e.next=26,(0,r.gz)(a.N.scripts.fetchMRUMetadataFromStorage.failure({error:e.t0}));case 26:case"end":return e.stop()}}),be,null,[[0,22]])}function Ue(e){var t,n,i,s,c,u,p,f,g,h,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=!1,e.prev=1,!(0,j.Ey)()){e.next=8;break}return t=!0,(0,l.bK)(),e.next=8,(0,r.gz)(a.N.scripts.publishedScriptMetadataReceived());case 8:if(!(0,W.HQ)("ScriptOM")){e.next=16;break}return e.next=11,(0,r.RE)(ce.L.getInstance);case 11:return n=e.sent,e.next=14,(0,r.RE)(n.getScripts);case 14:e.next=49;break;case 16:return e.next=18,(0,r.RE)(o.c.instance);case 18:return i=e.sent,e.next=21,(0,r.RE)(i.getScripts);case 21:return s=e.sent,c=s.map((function(e){return(0,oe.k)(de({},e,{isCreator:!0}))})),(0,W.HQ)("EnableMRUExperience")&&se.X.instance().setOneDriveAndCheck(c),e.next=26,(0,r.RE)(j.k5);case 26:if(u=e.sent,p=(0,te.xO)(),u||"Editor"!=p){e.next=47;break}return e.next=31,(0,r.Ys)(a.w.scripts.getAllPotentialOrphanScripts,c);case 31:if(f=e.sent,g=void 0,f.length>0&&(f.sort((function(e,t){return t.localUpdates.dateLastModified-e.localUpdates.dateLastModified})),g=f[0]),!(g&&(0,N.o)(g)&&(0,T.C)(g)&&(0,H.J)(g))){e.next=47;break}return e.next=37,(0,r.RE)(o.c.instance);case 37:return h=e.sent,e.prev=38,e.next=41,(0,r.RE)(h.getScript,(0,Y.c)(g));case 41:m=e.sent,c.push(m),e.next=47;break;case 45:e.prev=45,e.t0=e.catch(38);case 47:return e.next=49,(0,r.gz)(a.N.scripts.fetchMetadataFromStorage.success({scripts:c}));case 49:if(t||"Editor"!==(0,d.L3)()){e.next=53;break}return(0,l.bK)(),e.next=53,(0,r.gz)(a.N.scripts.publishedScriptMetadataReceived());case 53:e.next=60;break;case 55:return e.prev=55,e.t1=e.catch(1),t||(0,U.ob)({header:strings.Message.UnexpectedError,errorMessageMain:strings.Message.FetchMetadataFailed}),e.next=60,(0,r.gz)(a.N.scripts.fetchMetadataFromStorage.failure({error:e.t1}));case 60:case"end":return e.stop()}}),ye,null,[[1,55],[38,45]])}function ze(e){var t,n,i,o,s,u,d,p,f,g,h,m,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new l.pX("FetchScriptsFromDocument","System"),e.prev=1,e.next=4,(0,r.RE)(C.yG);case 4:return n=e.sent,e.next=7,(0,r.RE)(c.I.instance);case 7:return i=e.sent,e.next=10,(0,r.RE)(i.readScriptIdsFromWorkbook);case 10:if(o=e.sent,s=Array.from(new Set([].concat(n,o))),0!==s.length){e.next=19;break}return e.next=16,(0,r.gz)(a.N.scripts.fetchScriptsFromDocument.success({scripts:[]}));case 16:t.succeed(l.in.Information,{totalAttachedNumber:0,cacheNumber:0,refetchNumber:0}),e.next=46;break;case 19:return u=[],d=0,p=0,f=(0,j.lw)()||[],d+=f.length,g=q(g=s,f),h=J(g),e.next=29,(0,r.$6)(h.map((function(e){return(0,r.Ys)(a.w.scripts.get,e.storageId)})));case 29:if(m=K(m=e.sent,h),d+=m.length,u=u.concat(m),!((g=$(u,g)).length>0)){e.next=40;break}return e.next=37,(0,r.RE)(X,g);case 37:v=e.sent,p=v.length,u=u.concat(v);case 40:if(!(0,W.HQ)("EnableMRUExperience")){e.next=43;break}return e.next=43,(0,r.gz)(a.N.scripts.updateMRUScriptsIfShared({scripts:u}));case 43:return e.next=45,(0,r.gz)(a.N.scripts.fetchScriptsFromDocument.success({scripts:u}));case 45:t.succeed(l.in.Information,{totalAttachedNumber:s.length,cacheNumber:d,refetchNumber:p});case 46:e.next=53;break;case 48:return e.prev=48,e.t0=e.catch(1),t.fail(l.in.Warning,{},e.t0),e.next=53,(0,r.gz)(a.N.scripts.fetchScriptsFromDocument.failure({error:e.t0}));case 53:case"end":return e.stop()}}),we,null,[[1,48]])}function _e(e){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,r.RE)(M.Z);case 3:return t=e.sent,e.next=6,(0,r.gz)(a.N.scripts.fetchSamples.success({scripts:t}));case 6:e.next=12;break;case 8:return e.prev=8,e.t0=e.catch(0),e.next=12,(0,r.gz)(a.N.scripts.fetchSamples.failure({error:e.t0}));case 12:case"end":return e.stop()}}),Se,null,[[0,8]])}function He(e){var t,n,i,o,s,c,l,p,f;return regeneratorRuntime.wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return t=e.payload.attemptToRun,n=e.payload.script,g.next=4,(0,r.Ys)(a.w.scripts.get,n.storageScript.id);case 4:if(i=g.sent,"Editor"!==(0,d.L3)()){g.next=9;break}return g.next=8,(0,r.Ys)(a.w.editor.getActiveScriptId);case 8:o=g.sent;case 9:if(s=(0,P.Z)({incomingScript:n,existingScript:i}),c=s.selectedScript,l=s.isLocalBodyUpdated,p=s.hasConflict,!(i&&p&&o&&o===c.storageScript.id)){g.next=15;break}return g.next=13,(0,r.RE)(We,n,i);case 13:g.next=25;break;case 15:return g.next=17,(0,r.gz)(a.N.scripts.update(c));case 17:if(!l){g.next=20;break}return g.next=20,(0,r.gz)(a.N.editor.contentExternallyUpdated());case 20:if(!0!==t){g.next=25;break}return g.next=23,(0,r.Ys)(a.w.scripts.get,c.storageScript.id);case 23:f=g.sent,(0,ae.I)(f,"Backstage");case 25:(0,u.HN)(c),c.localUpdates.shareId&&(0,u.kg)({shareId:c.localUpdates.shareId,storageId:c.storageScript.id});case 27:case"end":return g.stop()}}),xe)}function We(e,t){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,r.gz)(a.N.dialog.show({title:strings.Editor.VersionConflictDialogTitle,subText:strings.Editor.VersionConflictDialogMainText,buttons:[{key:"KeepLocal",text:strings.Editor.VersionConflictDialogButton_LocalCopy,ariaLabel:strings.Editor.VersionConflictDialogButton_LocalCopyAriaLabel,lambda:it(t,"KeepLocal"),action:a.N.scripts.update((0,P.G)(e,t)),isPrimary:!1},{key:"RevertToPublished",text:strings.Editor.VersionConflictDialogButton_LatestPublished,ariaLabel:strings.Editor.VersionConflictDialogButton_LatestPublishedAriaLabel,lambda:it(t,"RevertToPublished"),action:[a.N.scripts.update(e),a.N.editor.contentExternallyUpdated()],isPrimary:!1}]}));case 2:case"end":return n.stop()}}),ke)}function Ze(e){var t,n,i;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.payload,n=t.script,i=t.attemptToRun,o.next=3,(0,r.gz)(a.N.scripts.update(n));case 3:!0===i&&(0,ae.I)(n,"Backstage"),(0,u.HN)(n),(0,u.kg)({shareId:n.localUpdates.shareId,storageId:n.storageScript.id});case 6:case"end":return o.stop()}}),Re)}function Ge(e){var t,n,i;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(t=e.payload,!(0,H.J)(t)){s.next=37;break}return s.prev=2,s.next=5,(0,r.gz)(a.N.scripts.storageCallInProgress({id:t.storageScript.id}));case 5:if(!(0,W.HQ)("ScriptOM")){s.next=13;break}return s.next=8,(0,r.RE)(Z.I.instance);case 8:return n=s.sent,s.next=11,(0,r.RE)(n.removeScript,t);case 11:s.next=18;break;case 13:return s.next=15,(0,r.RE)(o.c.instance);case 15:return i=s.sent,s.next=18,(0,r.RE)(i.removeScript,t);case 18:return s.next=20,(0,r.RE)(u.nP,t.storageScript.id);case 20:return s.next=22,(0,r.gz)(a.N.scripts.remove.success({script:t}));case 22:s.next=31;break;case 24:if(s.prev=24,s.t0=s.catch(2),"Editor"!==(0,d.L3)()){s.next=29;break}return s.next=29,(0,r.gz)(a.N.editor.setIsMakingACopy(!1));case 29:return s.next=31,(0,r.gz)(a.N.scripts.remove.failure({error:s.t0,fallbackValue:t}));case 31:return s.prev=31,s.next=34,(0,r.gz)(a.N.scripts.storageCallComplete({id:t.storageScript.id}));case 34:return s.finish(31);case 35:s.next=41;break;case 37:return s.next=39,(0,r.RE)(u.nP,t.storageScript.id);case 39:return s.next=41,(0,r.gz)(a.N.scripts.remove.success({script:t}));case 41:case"end":return s.stop()}}),Pe,null,[[2,24,31,35]])}function Ve(e){var t,n,i,o,s,u;return regeneratorRuntime.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:if(!e.payload.script.localUpdates.shareId){l.next=11;break}return l.prev=1,l.next=4,(0,r.RE)(c.I.instance);case 4:return t=l.sent,l.next=7,(0,r.RE)(t.detachScriptFromWorkbook,(0,O._n)(e.payload.script.storageScript.id,e.payload.script.localUpdates.shareId));case 7:l.next=11;break;case 9:l.prev=9,l.t0=l.catch(1);case 11:if(!(n="Editor"===(0,d.L3)())){l.next=18;break}return l.next=15,(0,r.Ys)(a.w.editor.getIsMakingACopy);case 15:l.t1=l.sent,l.next=19;break;case 18:l.t1=!1;case 19:return i=l.t1,l.next=22,(0,r.Ys)(a.w.editor.getActiveScriptId);case 22:if(o=l.sent,s=o===e.payload.script.storageScript.id||!o,u=!!n&&s,!(!i&&u)){l.next=29;break}return l.next=29,(0,r.gz)(a.N.editor.hideDetailsPage());case 29:if(!n||!i){l.next=32;break}return l.next=32,(0,r.gz)(a.N.editor.setIsMakingACopy(!1));case 32:return l.next=34,(0,r.RE)(C.vI,{operationName:"Delete",scriptMetadata:(0,D.Z)(e.payload.script)});case 34:(0,_.tc)(e.payload.script.storageScript.id);case 35:case"end":return l.stop()}}),Ce,null,[[1,9]])}var Xe,Qe=0;function qe(e){var t,n,i,o,s,c,d,p,f;return regeneratorRuntime.wrap((function(g){for(;;)switch(g.prev=g.next){case 0:return t=e.payload,n=t.id,i=t.updatedBody,g.next=3,(0,r.Ys)(a.w.scripts.get,n);case 3:if(!(o=g.sent)){g.next=21;break}return s=(0,I.R)(o,{body:i}),g.next=8,(0,r.gz)(a.N.scripts.update(s));case 8:return g.next=10,(0,r.gz)(a.N.editor.updateMonacoMarkers());case 10:return(0,u.HN)(s),c=(0,re.o)(s),d=c?"Unsaved":"None",g.next=15,(0,r.gz)(a.N.scripts.updateSavingStatus({id:o.storageScript.id,status:d}));case 15:if(!(p=rt(i))){g.next=19;break}return g.next=19,(0,r.gz)(a.N.bottomPanel.setHelpLinks(p));case 19:((f=Date.now())-Qe>6e4||Xe!==o.storageScript.id)&&(Qe=f,Xe=o.storageScript.id,(0,l.ve)({eventName:"EditScript",eventType:"User",data:{logLevel:l.in.Information,storageId:o.storageScript.id,apiInfo:o.storageScript.apiInfo}}));case 21:case"end":return g.stop()}}),Ie)}function Je(e){var t,n,i,o,u,d,p;return regeneratorRuntime.wrap((function(f){for(;;)switch(f.prev=f.next){case 0:if(t=e.payload,n=new l.pX("AddButtonToWorkbook","User"),i=!1,o="",!t.localUpdates.shareId){f.next=9;break}o=t.localUpdates.shareId,i=!0,f.next=37;break;case 9:return f.prev=9,f.next=12,(0,r.RE)(c.I.instance);case 12:if(u=f.sent,!(0,W.HQ)("ScriptOM")){f.next=22;break}return f.next=16,(0,r.RE)(Z.I.instance);case 16:return d=f.sent,f.next=19,(0,r.RE)(d.shareScript,t.storageScript.id);case 19:o=f.sent,f.next=28;break;case 22:return f.next=24,(0,r.RE)(s.X.instance);case 24:return p=f.sent,f.next=27,(0,r.RE)(p.shareScript,t.storageScript.id);case 27:o=f.sent;case 28:return f.next=30,(0,r.RE)(u.attachScriptToWorkbook,(0,O._n)(t.storageScript.id,o));case 30:return f.next=32,(0,r.gz)(a.N.scripts.partialUpdate({id:t.storageScript.id,updatedFields:{shareId:o}}));case 32:f.next=37;break;case 34:f.prev=34,f.t0=f.catch(9),n.fail(l.in.Error,{storageId:t.storageScript.id,alreadyShared:i},f.t0);case 37:if(""===o){f.next=47;break}return f.prev=38,f.next=41,(0,r.RE)(C.Y$,t.storageScript.name,o);case 41:n.succeed(l.in.Information,{storageId:t.storageScript.id,alreadyShared:i}),f.next=47;break;case 44:f.prev=44,f.t1=f.catch(38),n.fail(l.in.Error,{storageId:t.storageScript.id,alreadyShared:i},f.t1);case 47:case"end":return f.stop()}}),Oe,null,[[9,34],[38,44]])}function Ke(e){var t,n,i,o,d;return regeneratorRuntime.wrap((function(p){for(;;)switch(p.prev=p.next){case 0:return t=e.payload,n=new l.pX("AddScriptToWorkbook","User"),p.next=4,(0,r.gz)(a.N.scripts.updateAttachingStatus({id:t.storageScript.id,status:"InProgress"}));case 4:return p.next=6,(0,r.RE)(L.g);case 6:if(p.sent){p.next=11;break}return p.next=10,(0,r.gz)(a.N.scripts.updateAttachingStatus({id:t.storageScript.id,status:"Failed"}));case 10:throw new Error("Only users with sharing enabled can share scripts.");case 11:if(p.prev=11,!(0,W.HQ)("ScriptOM")){p.next=21;break}return p.next=15,(0,r.RE)(Z.I.instance);case 15:return i=p.sent,p.next=18,(0,r.RE)(i.shareScript,t.storageScript.id);case 18:t.localUpdates.shareId=p.sent,p.next=27;break;case 21:return p.next=23,(0,r.RE)(s.X.instance);case 23:return o=p.sent,p.next=26,(0,r.RE)(o.shareScript,t.storageScript.id);case 26:t.localUpdates.shareId=p.sent;case 27:if(t.localUpdates.shareId){p.next=29;break}throw new Error("shareScript returned invalid shareId.");case 29:(0,u.kg)({storageId:t.storageScript.id,shareId:t.localUpdates.shareId}),p.next=42;break;case 32:return p.prev=32,p.t0=p.catch(11),p.next=36,(0,r.gz)(a.N.shareDialog.hide());case 36:return p.next=38,(0,r.gz)(a.N.scripts.addScriptToWorkbook.failure({error:p.t0}));case 38:return p.next=40,(0,r.gz)(a.N.scripts.updateAttachingStatus({id:t.storageScript.id,status:"Failed"}));case 40:return n.fail(l.in.Error,{storageId:t.storageScript.id},p.t0),p.abrupt("return");case 42:return p.prev=42,p.next=45,(0,r.RE)(c.I.instance);case 45:return d=p.sent,p.next=48,(0,r.RE)(d.attachScriptToWorkbook,(0,O._n)(t.storageScript.id,t.localUpdates.shareId));case 48:return p.next=50,(0,r.gz)(a.N.scripts.addScriptToWorkbook.success(t));case 50:return p.next=52,(0,r.gz)(a.N.scripts.updateAttachingStatus({id:t.storageScript.id,status:"Succeeded"}));case 52:return p.next=54,(0,r.gz)(a.N.scripts.partialUpdate({id:t.storageScript.id,updatedFields:{shareId:t.localUpdates.shareId}}));case 54:return p.next=56,(0,r.gz)(a.N.scripts.updateAttachingStatus({id:t.storageScript.id,status:"Succeeded"}));case 56:return p.next=58,(0,r.RE)(C.vI,{operationName:"Attach",scriptMetadata:(0,D.Z)(t)});case 58:n.succeed(l.in.Information,{storageId:t.storageScript.id}),p.next=66;break;case 61:return p.prev=61,p.t1=p.catch(42),p.next=65,(0,r.gz)(a.N.scripts.updateAttachingStatus({id:t.storageScript.id,status:"Failed"}));case 65:n.fail(l.in.Error,{storageId:t.storageScript.id},p.t1);case 66:return p.prev=66,p.next=69,(0,r.gz)(a.N.shareDialog.hide());case 69:return p.finish(66);case 70:case"end":return p.stop()}}),Te,null,[[11,32],[42,61,66,70]])}function $e(e){var t,n,i;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.payload,o.next=3,(0,r.gz)(a.N.scripts.updateAttachingStatus({id:t.storageScript.id,status:"InProgress"}));case 3:if((0,ee.o)(t)){o.next=9;break}return o.next=6,(0,r.gz)(a.N.scripts.updateAttachingStatus({id:t.storageScript.id,status:"Failed"}));case 6:return n=new Error("Unable to find shareId for script with id "+t.storageScript.id),(0,l.m)(n,l.in.Error),o.abrupt("return");case 9:return o.prev=9,o.next=12,(0,r.RE)(C.wc,[t.localUpdates.shareId]);case 12:return o.next=14,(0,r.RE)(c.I.instance);case 14:return i=o.sent,o.next=17,(0,r.RE)(i.detachScriptFromWorkbook,(0,O._n)(t.storageScript.id,t.localUpdates.shareId));case 17:return o.next=19,(0,r.gz)(a.N.scripts.removeScriptFromWorkbook.success(t));case 19:return o.next=21,(0,r.gz)(a.N.scripts.updateAttachingStatus({id:t.storageScript.id,status:"Succeeded"}));case 21:return o.next=23,(0,r.gz)(a.N.scripts.partialUpdate({id:t.storageScript.id,updatedFields:{shareId:void 0}}));case 23:return o.next=25,(0,r.RE)(C.vI,{operationName:"Detach",scriptMetadata:(0,D.Z)(t)});case 25:if((0,T.C)(t)){o.next=31;break}return o.next=28,(0,r.gz)(a.N.backstage.show());case 28:return o.next=30,(0,r.gz)(a.N.editor.hideDetailsPage());case 30:(0,_.tc)(t.storageScript.id);case 31:o.next=39;break;case 33:return o.prev=33,o.t0=o.catch(9),o.next=37,(0,r.gz)(a.N.scripts.removeScriptFromWorkbook.failure());case 37:return o.next=39,(0,r.gz)(a.N.scripts.updateAttachingStatus({id:t.storageScript.id,status:"Failed"}));case 39:return o.next=41,(0,r.gz)(a.N.unshareDialog.hide());case 41:case"end":return o.stop()}}),Ee,null,[[9,33]])}function Ye(e){var t,n,i,o,l;return regeneratorRuntime.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:if(t=e.payload){d.next=3;break}throw new Error("Unexpected: Block access was called with no script context");case 3:if(d.prev=3,!(0,W.HQ)("ScriptOM")){d.next=12;break}return d.next=7,(0,r.RE)(Z.I.instance);case 7:return n=d.sent,d.next=10,(0,r.RE)(n.unshareScriptFromAllWorkbooks,t.storageScript.id);case 10:d.next=17;break;case 12:return d.next=14,(0,r.RE)(s.X.instance);case 14:return i=d.sent,d.next=17,(0,r.RE)(i.unshareScriptFromAllWorkbooks,t.storageScript.id);case 17:return d.next=19,(0,r.gz)(a.N.unshareDialog.hide());case 19:return d.next=21,(0,r.gz)(a.N.scripts.unshareScriptFromAllWorkbooks.success(t));case 21:return d.next=23,(0,r.RE)(C.vI,{operationName:"Detach",scriptMetadata:(0,D.Z)(t)});case 23:(0,u.qP)(t.localUpdates.shareId),d.next=32;break;case 26:return d.prev=26,d.t0=d.catch(3),d.next=30,(0,r.gz)(a.N.scripts.unshareScriptFromAllWorkbooks.failure());case 30:return d.next=32,(0,r.al)();case 32:if(!t.localUpdates.shareId){d.next=47;break}return o=t.localUpdates.shareId,t.localUpdates.shareId=void 0,d.next=37,(0,r.gz)(a.N.scripts.partialUpdate({id:t.storageScript.id,updatedFields:{shareId:t.localUpdates.shareId}}));case 37:return d.prev=37,d.next=40,(0,r.RE)(c.I.instance);case 40:return l=d.sent,d.next=43,(0,r.RE)(l.detachScriptFromWorkbook,(0,O._n)(t.storageScript.id,o));case 43:d.next=47;break;case 45:d.prev=45,d.t1=d.catch(37);case 47:case"end":return d.stop()}}),De,null,[[3,26],[37,45]])}function et(e){return tt.apply(this,arguments)}function tt(){return(tt=le(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,x(t.localUpdates.body||"",(0,E.u)(t));case 3:return n=e.sent,e.abrupt("return",JSON.stringify(n));case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",void 0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}var nt=0;function rt(e){var t=Date.now(),n=t-nt>6e4?new l.pX("RecommendLinks","System"):null,r=A().recommend(e,4);return n&&(n.succeed(l.in.Information,{recommendations:r.map((function(e){return e.id}))}),nt=t),r}function it(e,t){return function(){(0,l.ve)({eventName:"ManualConflictResolution",eventType:"User",data:{logLevel:l.in.Information,storageId:e.storageScript.id,resolution:t}})}}},81066:function(e,t,n){n.d(t,{X:function(){return l}});var r=n(82750),i=n(56222),a=n(59013),o=n(42803),s=n(58351);function c(){return c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}function u(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}var l=function(){var e=this;Object.defineProperty(this,"oneDriveScripts",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mruScripts",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"teamOwnerShipUX",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bulkUploadedInSession",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bulkUploadToMRU",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t,n=(t=regeneratorRuntime.mark((function t(){var n,r,i,c,u,l,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.bulkUploadedInSession=!0,(n=new s.pX("BulkUploadToMRU","System")).sendStart({}),e.mruScripts&&e.oneDriveScripts){t.next=6;break}return n.fail(s.in.Debug,{scriptsUndefined:e.mruScripts?"OneDrive":"MRU"},new Error("One of the Scripts are undefined")),t.abrupt("return",!1);case 6:return t.next=8,o.c.instance();case 8:r=t.sent,i=[],c=[],u=e.oneDriveScripts.length>30,l=u?e.oneDriveScripts.length-30:0,d=e.oneDriveScripts.length;case 15:if(!(l<d)){t.next=28;break}return t.prev=16,t.next=19,r.getScript((0,a.c)(e.oneDriveScripts[l]));case 19:c.push(e.oneDriveScripts[l].storageScript.id),t.next=25;break;case 22:t.prev=22,t.t0=t.catch(16),i.push(e.oneDriveScripts[l].storageScript.id);case 25:l++,t.next=15;break;case 28:if(!(i.length>=Math.floor(e.oneDriveScripts.length/2))){t.next=31;break}return n.fail(s.in.Debug,{storageIdsSucceeded:c,storageIdsFailedToLoad:i,loadAttempt:u?30:e.oneDriveScripts.length},new Error("too many scripts failed for bulk upload")),t.abrupt("return",!1);case 31:return n.succeed(s.in.Information,{storageIdsSucceeded:c,storageIdsFailedToLoad:i,loadAttempt:u?30:e.oneDriveScripts.length}),e.teamOwnerShipUX.write("teamOwnerShip",{value:!0}),t.abrupt("return",!0);case 34:case"end":return t.stop()}}),t,null,[[16,22]])})),function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(e){u(a,r,i,o,s,"next",e)}function s(e){u(a,r,i,o,s,"throw",e)}o(void 0)}))});return function(){return n.apply(this,arguments)}}()}),Object.defineProperty(this,"isTeamOwnershipUXEnabled",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=e.teamOwnerShipUX.read("teamOwnerShip"),n=t&&!!t.value&&!e.bulkUploadedInSession,i=!!e.oneDriveScripts&&!!e.mruScripts&&(0===e.oneDriveScripts.length||e.mruScripts.length>Math.floor(e.oneDriveScripts.length/2));return(0,r.HQ)("EnableMRUExperience")&&(n||i)}}),Object.defineProperty(this,"setMRUAndCheck",{configurable:!0,enumerable:!0,writable:!0,value:function(t){if(e.mruScripts=t,void 0!==e.oneDriveScripts)if(e.isTeamOwnershipUXEnabled())e.teamOwnerShipUX.write("teamOwnerShip",{value:!0});else if(!e.bulkUploadedInSession){var n=function(){};e.bulkUploadToMRU().then(n).catch(n)}}}),Object.defineProperty(this,"setOneDriveAndCheck",{configurable:!0,enumerable:!0,writable:!0,value:function(t){var n=t.map((function(e){return c({},e)}));if(e.oneDriveScripts=n.sort((function(e,t){return e.localUpdates.dateLastModified-t.localUpdates.dateLastModified})),void 0!==e.mruScripts)if(e.isTeamOwnershipUXEnabled())e.teamOwnerShipUX.write("teamOwnerShip",{value:!0});else if(!e.bulkUploadedInSession){var r=function(){};e.bulkUploadToMRU().then(r).catch(r)}}}),this.teamOwnerShipUX=new i.sH("Global",5e3,0,{compare:i.iQ,canPurge:function(){return!1}}),this.bulkUploadedInSession=!1};Object.defineProperty(l,"_instance",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(l,"instance",{configurable:!0,enumerable:!0,writable:!0,value:function(){return l._instance||(l._instance=new l),l._instance}})},88360:function(e,t,n){n.d(t,{E:function(){return r}});var r=function(e,t,n){return!!e&&!n&&!t}},32406:function(e,t,n){n.d(t,{E:function(){return a}});var r=n(38186),i=n(20260),a=function(e,t,n,a){return void 0===a&&(a=!1),!!e&&(a||(0,r.o)(e))&&(0,i.C)(e)&&!n&&!t}},47180:function(e,t,n){n.d(t,{I:function(){return a}});var r=n(20260),i=n(38186),a=function(e,t){return!!e&&(0,i.o)(e)&&(0,r.C)(e)&&!t}},18421:function(e,t,n){n.d(t,{n:function(){return i},d:function(){return a}});var r=n(38186),i=function(e,t,n){return!!e&&(0,r.o)(e)&&!(""===e.localUpdates.body)&&!t&&!n},a=function(e){return e?strings.Details.RunButtonDisabledTooltipText:""}},19588:function(e,t,n){n.d(t,{K:function(){return m},Z:function(){return g}});var r=n(12915),i=n(58351),a=n(89991),o=JSON.parse('[{"id":"2","sortIndex":1,"apiInfo":"{\\"variant\\":\\"synchronous\\"}","dateFirstPublished":1588809600000,"dateLastPublished":1592179200000,"body":"/**\\n * This sample script creates a sorted table.\\n * It also highlights a couple rows to demonstrate formatting.\\n * It does not affect any pre-existing data in your workbook.\\n *\\n * It is based off of this Office Scripts tutorial:\\n * https://docs.microsoft.com/office/dev/scripts/tutorials/excel-tutorial\\n */\\nfunction main(workbook: ExcelScript.Workbook) {\\n  // This function sets up a separate worksheet with sample data.\\n  let sampleSheet = setUpSample(workbook);\\n\\n  /*****************************\\n   * Begin Create Table sample *\\n   *****************************/\\n\\n  // Set fill color to FFC000 (the hex value for orange).\\n  sampleSheet.getRange(\\"A2:C2\\").getFormat().getFill().setColor(\\"FFC000\\");\\n\\n  // Set fill color to yellow using the string literal.\\n  sampleSheet.getRange(\\"A3:C3\\").getFormat().getFill().setColor(\\"yellow\\");\\n\\n  // Create a table using the data range.\\n  let newTable = workbook.addTable(sampleSheet.getRange(\\"A1:C5\\"), true);\\n\\n  // Sort the table based on the first column.\\n  newTable.getSort().apply([\\n    {\\n      key: 0 /* \'0\' refers to the index, not the column name. */,\\n      ascending: true,\\n    },\\n  ]);\\n}\\n\\n/*\\n * This setup function is only for the sample.\\n * It creates a new worksheet with sample data,\\n * separate from anything that you\'re working on.\\n *\\n * @param workbook - The currently open workbook.\\n * @returns - A new worksheet with the sample data.\\n */\\nfunction setUpSample(workbook: ExcelScript.Workbook): ExcelScript.Worksheet {\\n  // Create a new worksheet.\\n  let sheet = workbook.addWorksheet();\\n\\n  // Add sample data.\\n  let range = sheet.getRange(\\"A1:C5\\");\\n  range.setValues([\\n    [\\"Fruit\\", \\"2018\\", \\"2019\\"],\\n    [\\"Oranges\\", \\"1000\\", \\"1200\\"],\\n    [\\"Lemons\\", \\"800\\", \\"900\\"],\\n    [\\"Limes\\", \\"600\\", \\"500\\"],\\n    [\\"Grapefruits\\", \\"900\\", \\"700\\"],\\n  ]);\\n  range.select();\\n\\n  return sheet;\\n}\\n"},{"id":"4","sortIndex":2,"apiInfo":"{\\"variant\\":\\"synchronous\\"}","dateFirstPublished":1588809600000,"dateLastPublished":1592179200000,"body":"/**\\n * This sample script creates a PivotTable and\\n * returns the grand totals from that PivotTable.\\n * It does not affect any pre-existing data in your workbook.\\n */\\nfunction main(workbook: ExcelScript.Workbook) {\\n  // This function sets up a separate worksheet with sample data.\\n  let sampleSheet = setUpSample(workbook);\\n\\n  /**********************************\\n   * Begin Create PivotTable sample *\\n   **********************************/\\n\\n  // Get the data to create a PivotTable.\\n  let rangeToAnalyze = sampleSheet.getRange(\\"A1:E21\\");\\n\\n  // Create a new worksheet.\\n  let pivotSheet = workbook.addWorksheet();\\n\\n  // Place the PivotTable on the new worksheet.\\n  let rangeToPlacePivot = pivotSheet.getRange(\\"A2\\");\\n  let pivotTable = pivotSheet.addPivotTable(\\n    \\"Farm Sales\\",\\n    rangeToAnalyze,\\n    rangeToPlacePivot\\n  );\\n\\n  // Add row hierarchies to the PivotTable.\\n  pivotTable.addRowHierarchy(pivotTable.getHierarchy(\\"Farm\\"));\\n  pivotTable.addRowHierarchy(pivotTable.getHierarchy(\\"Type\\"));\\n\\n  // Add data hierarchies to the PivotTable.\\n  pivotTable.addDataHierarchy(pivotTable.getHierarchy(\\"Crates Sold at Farm\\"));\\n  pivotTable.addDataHierarchy(\\n    pivotTable.getHierarchy(\\"Crates Sold Wholesale\\")\\n  );\\n\\n  // Print each of the \\"Grand Totals\\" to the console.\\n  let pivotDataRange = pivotTable.getLayout().getBodyAndTotalRange();\\n  let grandTotalRange = pivotDataRange.getLastRow();\\n  console.log(\\n    `Sum of Crates Sold at Farm: ${grandTotalRange.getValues()[0][0]}`\\n  );\\n  console.log(\\n    `Sum of Crates Sold Wholesale: ${grandTotalRange.getValues()[0][1]}`\\n  );\\n\\n  // Bring the PivotTable into view.\\n  pivotDataRange.select();\\n}\\n\\n/*\\n * This setup function is only for the sample.\\n * It creates a new worksheet with sample data,\\n * separate from anything that you\'re working on.\\n *\\n * @param workbook - The currently open workbook.\\n * @returns - A new worksheet with the sample data.\\n */\\nfunction setUpSample(workbook: ExcelScript.Workbook): ExcelScript.Worksheet {\\n  // Create a new worksheet.\\n  let sheet = workbook.addWorksheet();\\n\\n  // Add sample data.\\n  let range = sheet.getRange(\\"A1:E21\\");\\n  range.setValues([\\n    [\\n      \\"Farm\\",\\n      \\"Type\\",\\n      \\"Classification\\",\\n      \\"Crates Sold at Farm\\",\\n      \\"Crates Sold Wholesale\\",\\n    ],\\n    [\\"A Farms\\", \\"Lime\\", \\"Organic\\", 300, 2000],\\n    [\\"A Farms\\", \\"Lemon\\", \\"Organic\\", 250, 1800],\\n    [\\"A Farms\\", \\"Orange\\", \\"Organic\\", 200, 2200],\\n    [\\"B Farms\\", \\"Lime\\", \\"Conventional\\", 80, 1000],\\n    [\\"B Farms\\", \\"Lemon\\", \\"Conventional\\", 75, 1230],\\n    [\\"B Farms\\", \\"Orange\\", \\"Conventional\\", 25, 800],\\n    [\\"B Farms\\", \\"Orange\\", \\"Organic\\", 20, 500],\\n    [\\"B Farms\\", \\"Lemon\\", \\"Organic\\", 10, 770],\\n    [\\"B Farms\\", \\"Kiwi\\", \\"Conventional\\", 30, 300],\\n    [\\"B Farms\\", \\"Lime\\", \\"Organic\\", 50, 400],\\n    [\\"C Farms\\", \\"Apple\\", \\"Organic\\", 275, 220],\\n    [\\"C Farms\\", \\"Kiwi\\", \\"Organic\\", 200, 120],\\n    [\\"D Farms\\", \\"Apple\\", \\"Conventional\\", 100, 3000],\\n    [\\"D Farms\\", \\"Apple\\", \\"Organic\\", 80, 2800],\\n    [\\"E Farms\\", \\"Lime\\", \\"Conventional\\", 160, 2700],\\n    [\\"E Farms\\", \\"Orange\\", \\"Conventional\\", 180, 2000],\\n    [\\"E Farms\\", \\"Apple\\", \\"Conventional\\", 245, 2200],\\n    [\\"E Farms\\", \\"Kiwi\\", \\"Conventional\\", 200, 1500],\\n    [\\"F Farms\\", \\"Kiwi\\", \\"Organic\\", 100, 150],\\n    [\\"F Farms\\", \\"Lemon\\", \\"Conventional\\", 150, 270],\\n  ]);\\n  range.select();\\n\\n  return sheet;\\n}\\n"},{"id":"5","sortIndex":3,"apiInfo":"{\\"variant\\":\\"synchronous\\"}","dateFirstPublished":1597190400000,"dateLastPublished":1597190400000,"body":"/**\\n * This sample finds overdue work items in a project management table\\n * and lets their owners know with a comment that uses an @mention.\\n * It does not affect any pre-existing data in your workbook.\\n */\\nfunction main(workbook: ExcelScript.Workbook) {\\n  // This function sets up a separate worksheet with sample data.\\n  let sampleSheet = setUpSample(workbook);\\n\\n  /**************************\\n   * Begin @Mentions sample *\\n   **************************/\\n\\n  // Get the \\"Owner\\" column range and values.\\n  let table = sampleSheet.getTables()[0];\\n  let ownerColumnRange = table\\n    .getColumn(\\"Owner\\")\\n    .getRangeBetweenHeaderAndTotal();\\n  let ownerColumnValues = ownerColumnRange.getValues();\\n\\n  // Get the \\"Due Date\\" column range and values.\\n  let dueDateColumnRange = table\\n    .getColumn(\\"Due Date\\")\\n    .getRangeBetweenHeaderAndTotal();\\n  let dueDateColumnValues = dueDateColumnRange.getValues();\\n\\n  // Look for overdue work items.\\n  for (let row = 0; row < dueDateColumnValues.length; row++) {\\n    /* Convert the Excel date into a JavaScript date.\\n     * This is necessary because Excel and JavaScript store\\n     * their dates as different numerical values.\\n     */\\n    console.log(dueDateColumnValues[row][0]);\\n    let dueDate = new Date(\\n      Math.round((dueDateColumnValues[row][0] - 25569) * 86400 * 1000)\\n    );\\n\\n    // Check if the current date is greater than the due date.\\n    if (Date.now() > dueDate.valueOf()) {\\n      /* Create a CommentMention object for the comment,\\n       * based on the work item\'s owner.\\n       *\\n       * A CommentMention\'s properties are:\\n       * `name`: The name of the person being mentioned.\\n       * `id`: The index of this mention in the comment\\n       *       (since multiple mentions can be in a single comment).\\n       * `email`: The email address of the person being mentioned.\\n       *          In this sample, \\"Owner\\" is also the user name for the email.\\n       */\\n      let mention = {\\n        name: ownerColumnValues[row][0],\\n        id: 0,\\n        email: ownerColumnValues[row][0] + \\"@contoso.com\\",\\n      };\\n\\n      /* Create the comment.\\n       * The `<at id=\\"0\\">` block embeds the mention in the comment text.\\n       * The name is displayed in the comment,\\n       * while an email is sent to the given address.\\n       *\\n       * The addComment parameters are:\\n       * `cellAddress`: The location of the comment.\\n       * `content`: The text of the comment and any embedded mentions.\\n       * `contentType`: The type of comment (\\"Mention\\" or \\"Plain\\").\\n       */\\n      sampleSheet.addComment(\\n        dueDateColumnRange.getCell(row, 0),\\n        {\\n          richContent:\\n            \'<at id=\\"0\\">\' +\\n            mention.name +\\n            \\"</at> - Your work item is overdue.\\",\\n          mentions: [mention],\\n        },\\n        ExcelScript.ContentType.mention\\n      );\\n    }\\n  }\\n}\\n/*\\n * This setup function is only for the sample.\\n * It creates a new worksheet with sample data,\\n * separate from anything that you\'re working on.\\n *\\n * @param workbook - The currently open workbook.\\n * @returns - A new worksheet with the sample data.\\n */\\nfunction setUpSample(workbook: ExcelScript.Workbook): ExcelScript.Worksheet {\\n  // Create and switch to a new worksheet.\\n  let sheet = workbook.addWorksheet();\\n  sheet.activate();\\n\\n  // Add sample data.\\n  let sampleRange = sheet.getRange(\\"A1:D5\\");\\n\\n  // Set range A1:D5 on selectedSheet\\n  sampleRange.setValues([\\n    [\\"Work Item\\", \\"Project\\", \\"Owner\\", \\"Due Date\\"],\\n    [\\"Complete Sell Sheet\\", \\"GrammarBuddies\\", \\"Alex\\", \\"5/13/2020\\"],\\n    [\\"Write Social Media Plan\\", \\"Mathpocalypse\\", \\"Emily\\", \\"6/22/2020\\"],\\n    [\\"Concept Art\\", \\"Mathpocalypse\\", \\"Jules\\", \\"10/30/2020\\"],\\n    [\\"Schedule Retail Demo\\", \\"GrammarBuddies\\", \\"Anne\\", \\"7/13/2021\\"],\\n  ]);\\n\\n  // Create a table\\n  sheet.addTable(sampleRange, true);\\n  sampleRange.getFormat().autofitColumns();\\n\\n  return sheet;\\n}\\n"},{"id":"6","sortIndex":4,"apiInfo":"{\\"variant\\":\\"synchronous\\"}","dateFirstPublished":1634169600000,"dateLastPublished":1634169600000,"body":"/**\\n * Excel table data can be represented as an array of objects in the form of JSON.\\n * Each object represents a row in the table. This helps extract the data from Excel in a consistent format that is visible to the user. The data can then be given to other systems through Power Automate flows.\\n */\\n\\nfunction main(workbook: ExcelScript.Workbook): TableData[] {\\n  // Get the first table in the \\"PlainTable\\" worksheet.\\n  // If you know the table name, use `workbook.getTable(\'TableName\')` instead.\\n  const table = workbook.getWorksheet(\\"Sheet1\\").getTables()[0];\\n\\n  // Get all the values from the table as text.\\n  const texts = table.getRange().getTexts();\\n\\n  // Create an array of JSON objects that match the row structure.\\n  let returnObjects: TableData[] = [];\\n  if (table.getRowCount() > 0) {\\n    returnObjects = returnObjectFromValues(texts);\\n  }\\n\\n  // Log the information and return it for a Power Automate flow.\\n  console.log(JSON.stringify(returnObjects));\\n  return returnObjects;\\n}\\n\\n// This function converts a 2D array of values into a generic JSON object.\\n// In this case, we have defined the TableData object, but any similar interface would work.\\nfunction returnObjectFromValues(values: string[][]): TableData[] {\\n  let objectArray: TableData[] = [];\\n  let objectKeys: string[] = [];\\n  for (let i = 0; i < values.length; i++) {\\n    if (i === 0) {\\n      objectKeys = values[i];\\n      continue;\\n    }\\n\\n    let object = {};\\n    for (let j = 0; j < values[i].length; j++) {\\n      object[objectKeys[j]] = values[i][j];\\n    }\\n\\n    objectArray.push(object as TableData);\\n  }\\n\\n  return objectArray;\\n}\\n\\ninterface TableData {\\n  \\"Event ID\\": string;\\n  Date: string;\\n  Location: string;\\n  Capacity: string;\\n  Speakers: string;\\n}\\n"},{"id":"7","sortIndex":5,"apiInfo":"{\\"variant\\":\\"synchronous\\"}","dateFirstPublished":1634169600000,"dateLastPublished":1634169600000,"body":"/*\\nThis script removes all hyperlinks in the specified sheet.\\n*/\\n\\nfunction main(workbook: ExcelScript.Workbook, sheetName: string = \\"Sheet1\\") {\\n  // Get the active worksheet.\\n  let sheet = workbook.getWorksheet(sheetName);\\n\\n  // Get the used range to operate on.\\n  // For large ranges (over 10000 entries), consider splitting the operation into batches for performance.\\n  const targetRange = sheet.getUsedRange(true);\\n  console.log(\\n    `Target Range to clear hyperlinks from: ${targetRange.getAddress()}`\\n  );\\n\\n  const rowCount = targetRange.getRowCount();\\n  const colCount = targetRange.getColumnCount();\\n  console.log(\\n    `Searching for hyperlinks in ${targetRange.getAddress()} which contains ${\\n      rowCount * colCount\\n    } cells`\\n  );\\n\\n  // Go through each individual cell looking for a hyperlink.\\n  // This allows us to limit the formatting changes to only the cells with hyperlink formatting.\\n  let clearedCount = 0;\\n  for (let i = 0; i < rowCount; i++) {\\n    for (let j = 0; j < colCount; j++) {\\n      const cell = targetRange.getCell(i, j);\\n      const hyperlink = cell.getHyperlink();\\n      if (hyperlink) {\\n        cell.clear(ExcelScript.ClearApplyTo.hyperlinks);\\n        cell\\n          .getFormat()\\n          .getFont()\\n          .setUnderline(ExcelScript.RangeUnderlineStyle.none);\\n        cell.getFormat().getFont().setColor(\\"Black\\");\\n        clearedCount++;\\n      }\\n    }\\n  }\\n\\n  console.log(`Done. Cleared hyperlinks from ${clearedCount} cells`);\\n}\\n"},{"id":"8","sortIndex":6,"apiInfo":"{\\"variant\\":\\"synchronous\\"}","dateFirstPublished":1634169600000,"dateLastPublished":1634169600000,"body":"/*\\nThis script does the following:\\n\\nSelects rows from the source table where the value in a column is equal to some value (FILTER_VALUE in the script).\\nMoves all selected rows into the target table in another worksheet.\\nReapplies the relevant filters to the source table.\\n*/\\n\\nfunction main(workbook: ExcelScript.Workbook) {\\n  // You can change these names to match the data in your workbook.\\n  const TARGET_TABLE_NAME = \\"Table1\\";\\n  const SOURCE_TABLE_NAME = \\"Table2\\";\\n\\n  // Select what will be moved between tables.\\n  const FILTER_COLUMN_INDEX = 1;\\n  const FILTER_VALUE = \\"Clothing\\";\\n\\n  // Get the Table objects.\\n  let targetTable = workbook.getTable(TARGET_TABLE_NAME);\\n  let sourceTable = workbook.getTable(SOURCE_TABLE_NAME);\\n\\n  // If either table is missing, report that information and stop the script.\\n  if (!targetTable || !sourceTable) {\\n    console.log(\\n      `Tables missing - Check to make sure both source (${TARGET_TABLE_NAME}) and target table (${SOURCE_TABLE_NAME}) are present before running the script. `\\n    );\\n    return;\\n  }\\n\\n  // Save the filter criteria currently on the source table.\\n  const originalTableFilters = {};\\n  // For each table column, collect the filter criteria on that column.\\n  sourceTable.getColumns().forEach((column) => {\\n    let originalColumnFilter = column.getFilter().getCriteria();\\n    if (originalColumnFilter) {\\n      originalTableFilters[column.getName()] = originalColumnFilter;\\n    }\\n  });\\n\\n  // Get all the data from the table.\\n  const sourceRange = sourceTable.getRangeBetweenHeaderAndTotal();\\n  const dataRows: (\\n    | number\\n    | string\\n    | boolean\\n  )[][] = sourceTable.getRangeBetweenHeaderAndTotal().getValues();\\n\\n  // Create variables to hold the rows to be moved and their addresses.\\n  let rowsToMoveValues: (number | string | boolean)[][] = [];\\n  let rowAddressToRemove: string[] = [];\\n\\n  // Get the data values from the source table.\\n  for (let i = 0; i < dataRows.length; i++) {\\n    if (dataRows[i][FILTER_COLUMN_INDEX] === FILTER_VALUE) {\\n      rowsToMoveValues.push(dataRows[i]);\\n\\n      // Get the intersection between table address and the entire row where we found the match. This provides the address of the range to remove.\\n      let address = sourceRange\\n        .getIntersection(sourceRange.getCell(i, 0).getEntireRow())\\n        .getAddress();\\n      rowAddressToRemove.push(address);\\n    }\\n  }\\n\\n  // If there are no data rows to process, end the script.\\n  if (rowsToMoveValues.length < 1) {\\n    console.log(\\n      \\"No rows selected from the source table match the filter criteria.\\"\\n    );\\n    return;\\n  }\\n\\n  console.log(`Adding ${rowsToMoveValues.length} rows to target table.`);\\n\\n  // Insert rows at the end of target table.\\n  targetTable.addRows(-1, rowsToMoveValues);\\n\\n  // Remove the rows from the source table.\\n  const sheet = sourceTable.getWorksheet();\\n\\n  // Remove all filters before removing rows.\\n  sourceTable.getAutoFilter().clearCriteria();\\n\\n  // Important: Remove the rows starting at the bottom of the table.\\n  // Otherwise, the lower rows change position before they are deleted.\\n  console.log(\\n    `Removing ${rowAddressToRemove.length} rows from the source table.`\\n  );\\n  rowAddressToRemove.reverse().forEach((address) => {\\n    sheet.getRange(address).delete(ExcelScript.DeleteShiftDirection.up);\\n  });\\n\\n  // Reapply the original filters.\\n  Object.keys(originalTableFilters).forEach((columnName) => {\\n    sourceTable\\n      .getColumnByName(columnName)\\n      .getFilter()\\n      .apply(originalTableFilters[columnName]);\\n  });\\n}\\n"},{"id":"9","sortIndex":7,"apiInfo":"{\\"variant\\":\\"synchronous\\"}","dateFirstPublished":1634169600000,"dateLastPublished":1634169600000,"body":"/*\\nThis script counts the empty rows on a given worksheet, and can return them to a Power Automate Flow.\\n*/\\n\\nfunction main(\\n  workbook: ExcelScript.Workbook,\\n  sheetName: string = \\"Sheet1\\"\\n): number {\\n  // Get the worksheet named \\"Sheet1\\".\\n  const sheet = workbook.getWorksheet(sheetName);\\n\\n  // Get the entire data range.\\n  const range = sheet.getUsedRange(true);\\n\\n  // If the used range is empty, end the script.\\n  if (!range) {\\n    console.log(`No data on this sheet.`);\\n    return;\\n  }\\n\\n  // Log the address of the used range.\\n  console.log(`Used range for the worksheet: ${range.getAddress()}`);\\n\\n  // Look through the values in the range for blank rows.\\n  const values = range.getValues();\\n  let emptyRows = 0;\\n  for (let row of values) {\\n    let emptyRow = true;\\n\\n    // Look at every cell in the row for one with a value.\\n    for (let cell of row) {\\n      if (cell.toString().length > 0) {\\n        emptyRow = false;\\n      }\\n    }\\n\\n    // If no cell had a value, the row is empty.\\n    if (emptyRow) {\\n      emptyRows++;\\n    }\\n  }\\n\\n  // Log the number of empty rows.\\n  console.log(`Total empty rows: ${emptyRows}`);\\n\\n  // Return the number of empty rows for use in a Power Automate flow.\\n  return emptyRows;\\n}\\n"},{"id":"10","sortIndex":0,"apiInfo":"{\\"variant\\":\\"synchronous\\"}","dateFirstPublished":1652659200000,"dateLastPublished":1652918400000,"body":"/**\\n * This sample will take a selected range of a table and create a new table from it.\\n * Make sure to highlight a portion of a table before running the script.\\n * Try running it with a button! Go to \\"...\\" -> \\"Add Button\\"\\n */\\n\\n// The \\"main\\" function is run when the script is executed.\\nfunction main(workbook: ExcelScript.Workbook) {\\n  // This function will create a new table from the selected range.\\n  createSubTable(workbook);\\n}\\n\\n/********************************************\\n * Begin Selected Sub Table Creation sample *\\n ********************************************/\\n\\nfunction createSubTable(workbook: ExcelScript.Workbook): void {\\n  // Get the selected range.\\n  let selectedRange = workbook.getSelectedRange();\\n\\n  // Get the data values of the selected range\\n  let data = selectedRange.getValues();\\n\\n  // Get how many columns and rows have been selected.\\n  // We need this to compute the range of the new table.\\n  const amtColumnsSelected = selectedRange.getColumnCount();\\n  const amtRowsSelected = selectedRange.getRowCount();\\n\\n  // Find the table that is encompassing the selected range\\n  let parentTable = selectedRange.getTables()[0];\\n\\n  // Get the headers of the table\\n  // If there are no headers, that means an invalid selection was made.\\n  // Tell the user to make a valid selection and terminate the script.\\n  try {\\n    // Get the header range\\n    var headers = parentTable.getHeaderRowRange();\\n  } catch (e) {\\n    console.log(\\"Please make a selection inside a table.\\");\\n    return;\\n  }\\n\\n  // Get the current worksheet we\'re working in\\n  let worksheet = parentTable.getWorksheet();\\n\\n  // We\'re going to do some math to calculate the header row we need.\\n  // We want to return only the headers within the same columns as the selected range.\\n  // The getRangeByIndexes has the following definition:\\n  // getRangeByIndexes(startRow, startColumn, rowCount, columnCount)\\n  // We are taking the intersection of the header range and the selected range (extended to the header row) to grab the valid headers.\\n  let headersToKeep = headers.getIntersection(\\n    worksheet.getRangeByIndexes(\\n      headers.getRowIndex(),\\n      selectedRange.getColumnIndex(),\\n      headers.getRowCount(),\\n      selectedRange.getColumnCount()\\n    )\\n  );\\n\\n  // Make a new sheet to store the new table\\n  let subTableSheet = workbook.addWorksheet();\\n\\n  // Calculate the range for the new table.\\n  // -> The first row is the header row, so we need to add 1 to the row count.\\n  let tableRange = subTableSheet.getRangeByIndexes(\\n    0,\\n    0,\\n    amtRowsSelected + 1,\\n    amtColumnsSelected\\n  );\\n\\n  // Add the headers to the first row of the new table\\n  data.unshift(headersToKeep.getValues()[0]);\\n\\n  // Set the data\\n  tableRange.setValues(data);\\n\\n  // Make excel recognize the range as a table and sort the values.\\n  let newTable = subTableSheet.addTable(tableRange, true);\\n  tableRange.select();\\n}\\n\\n/********************************************\\n * End Selected Sub Table Creation sample *\\n ********************************************/\\n"},{"id":"11","sortIndex":8,"apiInfo":"{\\"variant\\":\\"synchronous\\"}","dateFirstPublished":1658102400000,"dateLastPublished":1658102400000,"body":"/*\\r\\nThis script unhides all rows and columns on a given worksheet.\\r\\n*/\\r\\n\\r\\nfunction main(workbook: ExcelScript.Workbook) {\\r\\n  // Get the currently selected sheet.\\r\\n  const selectedSheet = workbook.getActiveWorksheet();\\r\\n\\r\\n  // Get the entire data range.\\r\\n  const range = selectedSheet.getUsedRange();\\r\\n\\r\\n  // If the used range is empty, end the script.\\r\\n  if (!range) {\\r\\n    console.log(`No data on this sheet.`);\\r\\n    return;\\r\\n  }\\r\\n\\r\\n  // Log the address of the used range.\\r\\n  console.log(`Used range for the worksheet: ${range.getAddress()}`);\\r\\n\\r\\n  // If no columns are hidden, log message, else, unhide columns\\r\\n  if (range.getColumnHidden() == false) {\\r\\n    console.log(`No columns hidden`);\\r\\n  } else {\\r\\n    range.setColumnHidden(false);\\r\\n  }\\r\\n\\r\\n  // If no rows are hidden, log message, else, unhide rows.\\r\\n  if (range.getRowHidden() == false) {\\r\\n    console.log(`No rows hidden`);\\r\\n  } else {\\r\\n    range.setRowHidden(false);\\r\\n  }\\r\\n}\\r\\n"},{"id":"12","sortIndex":9,"apiInfo":"{\\"variant\\":\\"synchronous\\"}","dateFirstPublished":1658102400000,"dateLastPublished":1658102400000,"body":"/*\\r\\nThis script will take a selected range of a sheet and freeze the selection.\\r\\n*/\\r\\n\\r\\nfunction main(workbook: ExcelScript.Workbook) {\\r\\n  // Get the currently selected sheet.\\r\\n  const selectedSheet = workbook.getActiveWorksheet();\\r\\n\\r\\n  // Get the current selected range.\\r\\n  const selectedRange = workbook.getSelectedRange();\\r\\n\\r\\n  // If no cells are selected, end the script.\\r\\n  if (selectedRange == null) {\\r\\n    console.log(`No cells in worksheet selected.`);\\r\\n    return;\\r\\n  }\\r\\n\\r\\n  // Log the address of the selected range\\r\\n  console.log(\\r\\n    `Selected range for the worksheet: \\" ${selectedRange.getAddress()}`\\r\\n  );\\r\\n\\r\\n  // Freeze the selected range.\\r\\n  selectedSheet.getFreezePanes().freezeAt(selectedRange);\\r\\n}\\r\\n"}]'),s=n(65506),c=n(82750),u=["id"];function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}function d(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){d(a,r,i,o,s,"next",e)}function s(e){d(a,r,i,o,s,"throw",e)}o(void 0)}))}}var f=void 0;function g(){return h.apply(this,arguments)}function h(){return(h=p(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!f){e.next=2;break}return e.abrupt("return",f);case 2:return t=new i.pX("FetchSamples","System"),e.prev=3,n=b(),(0,c.HQ)("SampleScriptSubTable")?(n[0].sortIndex=3,n[1].sortIndex=4,n[2].sortIndex=5,n[3].sortIndex=1,n[4].sortIndex=7,n[5].sortIndex=2,n[6].sortIndex=6,n[7].sortIndex=8):n[7].sortIndex=10,f=n.map((function(e){return(0,a.k)(e)})).filter((function(e){return(0,s.Z)(e)})),t.succeed(i.in.Information,{}),e.abrupt("return",f);case 11:throw e.prev=11,e.t0=e.catch(3),t.fail(i.in.Error,{},e.t0),e.t0;case 15:case"end":return e.stop()}}),e,null,[[3,11]])})))).apply(this,arguments)}function m(e){return v.apply(this,arguments)}function v(){return(v=p(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:return n=e.sent,e.abrupt("return",n.find((function(e){return e.storageScript.id===t})));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(){return o.map((function(e){var t=e.id,n=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,u),i=strings.Samples[t];return l({},n,{id:r.Fb+t,creatorId:r.D9,creatorDisplayName:r.$M,isCreator:!1,name:i.name,description:i.description})}))}},79002:function(e,t,n){n.d(t,{P:function(){return R}});var r=n(90828),i=n(42803),a=n(45752),o=n(38843),s=n(17425),c=n(54050),u=n(44434),l=n(22883),d=n(32613),p=n(58351),f=n(59013),g=n(26253),h=n(61015);var m=function(e,t){var n=(0,g.qg)(t,e.storageScript.name);return(0,h.GS)({name:n,description:e.storageScript.description,body:e.localUpdates.body||e.storageScript.body,apiInfo:e.storageScript.apiInfo})},v=n(48562),b=n(110),y=n(82750),w=n(71849);function S(){return S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},S.apply(this,arguments)}function x(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function k(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){x(a,r,i,o,s,"next",e)}function s(e){x(a,r,i,o,s,"throw",e)}o(void 0)}))}}var R=function(e){P.call(this),this.reduxStore=e};Object.defineProperty(R,"_instance",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(R,"instance",{configurable:!0,enumerable:!0,writable:!0,value:function(e){return R._instance||(R._instance=new R(e)),R._instance}});var P=function(){var e=this;Object.defineProperty(this,"reduxStore",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"createNewScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=k(regeneratorRuntime.mark((function t(){var n,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=(0,g.T3)(r.w.scripts.getScriptNames(e.reduxStore.getState()),strings.Editor.NewScriptNameText),!(i=(0,h.GS)({name:n})).localUpdates.body){t.next=7;break}return t.next=5,(0,b.B)(i.localUpdates.body);case 5:t.sent!==i.localUpdates.body&&(e.reduxStore.dispatch(a.ZP.scripts.update(i)),e.reduxStore.dispatch(a.ZP.editor.contentExternallyUpdated()));case 7:e.importScript(i);case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}),Object.defineProperty(this,"makeACopyOfScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=k(regeneratorRuntime.mark((function t(n,o){var s,c,u,l,d,g,h,v;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=new p.pX("DuplicateScript","User"),c=n||r.w.editor.getActiveScriptId(e.reduxStore.getState()),u=!0,t.prev=3,l=r.w.scripts.get(e.reduxStore.getState(),c)){t.next=7;break}throw new Error("makeACopyOfScript: Script is undefined");case 7:if(l.localUpdates.body){t.next=24;break}if(u=!1,!(0,y.HQ)("ScriptOM")){t.next=18;break}return t.next=12,w.I.instance();case 12:return d=t.sent,t.next=15,d.getScript((0,f.c)(l));case 15:l=t.sent,t.next=24;break;case 18:return t.next=20,i.c.instance();case 20:return g=t.sent,t.next=23,g.getScript((0,f.c)(l));case 23:l=t.sent;case 24:h=r.w.scripts.getScriptNames(e.reduxStore.getState()),v=m(l,h),e.reduxStore.dispatch(a.ZP.editor.setIsMakingACopy(!0)),e.importScript(v,o),s.succeed(p.in.Information,{originalScriptStorageId:l.storageScript.id,newScriptStorageId:v.storageScript.id,apiInfo:l.storageScript.apiInfo,hasBody:u}),t.next=34;break;case 31:t.prev=31,t.t0=t.catch(3),s.fail(p.in.Error,{storageId:c},t.t0);case 34:case"end":return t.stop()}}),t,null,[[3,31]])})));return function(e,n){return t.apply(this,arguments)}}()}),Object.defineProperty(this,"importScript",{configurable:!0,enumerable:!0,writable:!0,value:function(t,n){var i=r.w.editor.getIsMakingACopy(e.reduxStore.getState());e.reduxStore.dispatch(a.ZP.scripts.update(t)),e.saveScript(t,{}),"Details"===n&&i?e.reduxStore.dispatch(a.ZP.editor.openScriptInDetailsPage({id:t.storageScript.id})):e.reduxStore.dispatch(a.ZP.editor.openScriptInEditor({id:t.storageScript.id}))}}),Object.defineProperty(this,"makeACopyTo",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=k(regeneratorRuntime.mark((function t(n,o){var s,u,l,d,g,h,b,x;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=new p.pX("DuplicateScript","User"),u=!0,t.prev=2,n.localUpdates.body){t.next=20;break}if(u=!1,!(0,y.HQ)("ScriptOM")){t.next=14;break}return t.next=8,w.I.instance();case 8:return l=t.sent,t.next=11,l.getScript((0,f.c)(n));case 11:n=t.sent,t.next=20;break;case 14:return t.next=16,i.c.instance();case 16:return d=t.sent,t.next=19,d.getScript((0,f.c)(n));case 19:n=t.sent;case 20:return g=r.w.scripts.getScriptNames(e.reduxStore.getState()),h=m(n,g),t.next=24,(0,c.Gq)();case 24:b=t.sent,x={storageScript:S({},h.storageScript,{driveId:b.driveId,folderId:b.folderId,mruItemId:void 0}),localUpdates:h.localUpdates},e.reduxStore.dispatch(a.ZP.editor.setIsMakingACopy(!0)),e.importScript(x,o),s.succeed(p.in.Information,{originalScriptStorageId:n.storageScript.id,newScriptStorageId:x.storageScript.id,apiInfo:n.storageScript.apiInfo,hasBody:u}),t.next=34;break;case 31:t.prev=31,t.t0=t.catch(2),(0,v.s)(t.t0)?s.succeed(p.in.Information,{storageId:n.storageScript.id,cancelled:!0}):s.fail(p.in.Error,{storageId:n.storageScript.id},t.t0);case 34:case"end":return t.stop()}}),t,null,[[2,31]])})));return function(e,n){return t.apply(this,arguments)}}()}),Object.defineProperty(this,"revertToLastSaved",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=k(regeneratorRuntime.mark((function t(n){var r,o,c,u,d,g,h,m;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=new p.pX("RevertScript","User"),t.prev=1,!(0,y.HQ)("ScriptOM")){t.next=11;break}return t.next=5,w.I.instance();case 5:return c=t.sent,t.next=8,c.getScript((0,f.c)(n));case 8:o=t.sent,t.next=17;break;case 11:return t.next=13,i.c.instance();case 13:return u=t.sent,t.next=16,u.getScript((0,f.c)(n));case 16:o=t.sent;case 17:e.reduxStore.dispatch(a.ZP.scripts.fetchScriptFromStorage.success({script:o})),e.reduxStore.dispatch(a.ZP.scripts.update(o)),(0,s.HN)(o),e.reduxStore.dispatch(a.ZP.editor.contentExternallyUpdated()),e.reduxStore.dispatch(a.ZP.editor.updateMonacoMarkers()),r.succeed(p.in.Information,{storageId:n.storageScript.id,hasUpdatedBody:o.storageScript.body!==n.storageScript.body,timeSinceLastSaveMs:Date.now()-n.localUpdates.dateLastModified}),t.next=33;break;case 25:t.prev=25,t.t0=t.catch(1),d=(0,l.IG)(t.t0),g=(0,l.ZX)(t.t0),h=d?strings.Message.FailedToOpenDeletedScriptMessage:g?strings.Message.TimeOutErrorMessage:strings.Message.FailedToOpenScriptMessage,m=d||g?strings.General.OKButtonText:strings.General.DismissButtonText,r.fail(d?p.in.Warning:p.in.Error,{},t.t0),e.reduxStore.dispatch(a.ZP.messageBar.show({style:1,text:h,forceSingleLine:!0,isBlocking:!0,buttons:[{isPrimary:!0,text:m,actions:[a.ZP.messageBar.dismiss(),a.ZP.backstage.setCurrentPivot("Recent"),a.ZP.backstage.show()]}]}));case 33:case"end":return t.stop()}}),t,null,[[1,25]])})));return function(e){return t.apply(this,arguments)}}()}),Object.defineProperty(this,"saveScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=k(regeneratorRuntime.mark((function t(n,r){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.updateUIBeforeSave(n),r.name&&(r.name=r.name.trim()),t.next=4,(0,o.T_)(n);case 4:if(n.localUpdates.parameterInfo=t.sent,!(0,d.H)(n)){t.next=10;break}return t.next=8,e.publishNewScript(n,r);case 8:t.next=12;break;case 10:return t.next=12,e.updateCurrentScript(n,r);case 12:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}),Object.defineProperty(this,"updateCurrentScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=k(regeneratorRuntime.mark((function t(n,r){var a,o,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n,t.prev=1,!(0,y.HQ)("ScriptOM")){t.next=11;break}return t.next=5,w.I.instance();case 5:return o=t.sent,t.next=8,o.saveScript(n,r);case 8:a=t.sent,t.next=17;break;case 11:return t.next=13,i.c.instance();case 13:return c=t.sent,t.next=16,c.saveScript(n,r);case 16:a=t.sent;case 17:(0,s.HN)(a),e.postUpdateScript(a),t.next=24;break;case 21:t.prev=21,t.t0=t.catch(1),e.updateUIAfterFailure(t.t0,a);case 24:case"end":return t.stop()}}),t,null,[[1,21]])})));return function(e,n){return t.apply(this,arguments)}}()}),Object.defineProperty(this,"publishNewScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=k(regeneratorRuntime.mark((function t(n,r){var a,o,c,u;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n,t.prev=1,o=n.storageScript.id,!(0,y.HQ)("ScriptOM")){t.next=12;break}return t.next=6,w.I.instance();case 6:return c=t.sent,t.next=9,c.saveScript(n,r);case 9:a=t.sent,t.next=18;break;case 12:return t.next=14,i.c.instance();case 14:return u=t.sent,t.next=17,u.saveScript(n,r);case 17:a=t.sent;case 18:(0,s.HN)(a),e.postPublishNew(a,o),t.next=25;break;case 22:t.prev=22,t.t0=t.catch(1),e.updateUIAfterFailure(t.t0,a);case 25:case"end":return t.stop()}}),t,null,[[1,22]])})));return function(e,n){return t.apply(this,arguments)}}()}),Object.defineProperty(this,"postPublishNew",{configurable:!0,enumerable:!0,writable:!0,value:function(t,n){e.updateUIAfterSuccess(t),n===r.w.editor.getActiveScriptId(e.reduxStore.getState())&&e.reduxStore.dispatch(a.ZP.editor.setActive({id:t.storageScript.id,forceRefetch:!1}));var i=r.w.scripts.get(e.reduxStore.getState(),n);i&&e.reduxStore.dispatch(a.ZP.scripts.remove.request(i)),(0,c.vI)({operationName:"Publish",scriptMetadata:(0,u.Z)(t)})}}),Object.defineProperty(this,"postUpdateScript",{configurable:!0,enumerable:!0,writable:!0,value:function(t){e.updateUIAfterSuccess(t),(0,c.vI)({operationName:"Publish",scriptMetadata:(0,u.Z)(t)})}}),Object.defineProperty(this,"updateUIAfterFailure",{configurable:!0,enumerable:!0,writable:!0,value:function(t,n){e.reduxStore.dispatch(a.ZP.editor.setIsMakingACopy(!1)),e.reduxStore.dispatch(a.ZP.messageBar.show(e.getMessageBarProperty(t))),e.reduxStore.dispatch(a.ZP.scripts.storageCallComplete({id:n.storageScript.id})),e.reduxStore.dispatch(a.ZP.scripts.updateSavingStatus({id:n.storageScript.id,status:"Failed"}))}}),Object.defineProperty(this,"updateUIAfterSuccess",{configurable:!0,enumerable:!0,writable:!0,value:function(t){e.reduxStore.dispatch(a.ZP.scripts.updateSavingStatus({id:t.storageScript.id,status:"Succeeded"})),e.reduxStore.dispatch(a.ZP.scripts.update(t)),e.reduxStore.dispatch(a.ZP.scripts.storageCallComplete({id:t.storageScript.id}))}}),Object.defineProperty(this,"updateUIBeforeSave",{configurable:!0,enumerable:!0,writable:!0,value:function(t){e.reduxStore.dispatch(a.ZP.scripts.storageCallInProgress({id:t.storageScript.id})),e.reduxStore.dispatch(a.ZP.scripts.updateSavingStatus({id:t.storageScript.id,status:"InProgress"}))}}),Object.defineProperty(this,"getMessageBarProperty",{configurable:!0,enumerable:!0,writable:!0,value:function(e){var t=(0,l.ZX)(e)?strings.Message.TimeOutErrorMessage:(0,l.IG)(e)?strings.Message.FailedToOpenDeletedScriptMessage:(0,l.HZ)(e)?strings.Message.AccessDeniedForScriptAction:strings.Message.SaveFailed;return(0,l.ZX)(e)?{style:1,isBlocking:!0,forceSingleLine:!0,text:t,buttons:[{isPrimary:!0,text:strings.General.OKButtonText,actions:[a.ZP.messageBar.dismiss()]}]}:(0,l.IG)(e)?{style:1,isBlocking:!0,forceSingleLine:!0,text:t,buttons:[{isPrimary:!0,text:strings.General.OKButtonText,actions:[a.ZP.messageBar.dismiss(),a.ZP.backstage.setCurrentPivot("Recent"),a.ZP.backstage.show()]}]}:{style:1,isBlocking:!0,forceSingleLine:!0,text:t,buttons:[{isPrimary:!0,text:strings.General.DismissButtonText,actions:[a.ZP.messageBar.dismiss()]}]}}})}},59725:function(e,t,n){n.d(t,{Z:function(){return u},O$:function(){return s},Vg:function(){return l},Ok:function(){return c}});var r=n(15592),i=n(8797),a=n(54050);function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},o.apply(this,arguments)}var s;function c(){return Object.keys(u).reduce((function(e,t){var n;return o({},e,((n={})[t]=u[t].defaultValue,n))}),{})}!function(e){e.VS="vs",e.VSDark="vs-dark",e.HCBlack="hc-black"}(s||(s={}));var u={"editor.theme":{userFacingName:strings.Editor.SettingsThemeLabel,defaultValue:function(){if(!(0,i.Z)())return"Office";var e=(0,a.Zd)();return function(e){switch(e){case"Black":case"Dark Gray":return"Dark";case"High Contrast":return"High Contrast";case"Colorful":case"White":return"Light";default:return"Office"}}((0,r.M)(e))}(),enum:["Office","Dark","Light","High Contrast"],displayText:{EditorTheme:strings.Editor.SettingsThemeNameOffice,Dark:strings.Editor.SettingsThemeNameDark,Light:strings.Editor.SettingsThemeNameLight,"High Contrast":strings.Editor.SettingsThemeNameHighContrast}},"editor.fontSize":{userFacingName:strings.Editor.SettingsFontSizeLabel,defaultValue:12,enum:[4,8,10,12,14,16,18,20,22,24,28,32,36]},"editor.wordWrap":{userFacingName:strings.Editor.SettingsWordWrapLabel,defaultValue:"Bounded",enum:["On","Off","Bounded"],displayText:{On:strings.Editor.SettingsWordWrapOptionOn,Off:strings.Editor.SettingsWordWrapOptionOff,Bounded:strings.Editor.SettingsWordWrapOptionBounded}},"editor.tabSize":{userFacingName:strings.Editor.SettingsTabSizeLabel,defaultValue:2,enum:[2,4]},"editor.minimap":{userFacingName:strings.Editor.SettingsMinimapLabel,defaultValue:!1},"editor.folding":{userFacingName:strings.Editor.SettingsFoldingLabel,defaultValue:!0},"editor.extension":{userFacingName:strings.Editor.SettingsVisualStudioCodeConnection,defaultValue:!1,flightName:"OfficeScriptConnection"}};function l(){return{storageId:"",isOwner:!0,groupSectionStatus:{descriptionGroup:!1,scriptAccessGroup:!0,scriptActivityGroup:!0,securityGroup:!0},runCount:0,promptShare:!0}}},67833:function(e,t,n){n.d(t,{p:function(){return h}});var r=n(58351),i=n(59725);var a=n(57074);var o=n(59338),s=n(110),c=n(1645);function u(e){var t="function"===typeof Map?new Map:void 0;return u=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return l(e,arguments,f(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),p(r,e)},u(e)}function l(e,t,n){return l=d()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&p(i,n.prototype),i},l.apply(null,arguments)}function d(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function p(e,t){return p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},p(e,t)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function g(){return g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},g.apply(this,arguments)}var h=function(){var e=this;Object.defineProperty(this,"settings",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"initialize",{configurable:!0,enumerable:!0,writable:!0,value:function(t){e.settings=t}}),Object.defineProperty(this,"getSetting",{configurable:!0,enumerable:!0,writable:!0,value:function(t){return e.settings[t]}}),Object.defineProperty(this,"getAllSettings",{configurable:!0,enumerable:!0,writable:!0,value:function(){return e.settings}}),Object.defineProperty(this,"updateSetting",{configurable:!0,enumerable:!0,writable:!0,value:function(t){try{var n=Object.keys(i.Z),a=Object.keys(t).filter((function(e){return!n.includes(e)}));if(a.length>0)throw new m("Unrecognized keys: "+a.join(", "));var o={};Object.keys(t).map((function(e){return e})).forEach((function(e){var n=t[e],a=i.Z[e];if(a.enum&&!a.enum.includes(n))throw new m("'"+n+"' is not an allowed value for '"+e+"'.");(0,r.ve)({eventName:"EditorSettings",eventType:"User",data:{propName:e,propStringValue:n.toString()}}),o[e]=n})),e.settings=g({},e.settings,o),e.applySettings(),(0,c.zQ)(e.settings)}catch(s){}}}),Object.defineProperty(this,"applySettings",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=e.settings;if(t["editor.tabSize"]&&(0,s.D)({tabWidth:t["editor.tabSize"]}),o.r.editor){var n=function(e){return{theme:(t=e["editor.theme"],{Office:i.O$.VS,Light:i.O$.VS,Dark:i.O$.VSDark,"High Contrast":i.O$.HCBlack}[t]),fontFamily:["Menlo","Source Code Pro","Consolas","Courier New","monospace"].map((function(e){return e.includes(" ")?JSON.stringify(e):e})).join(", "),fontSize:e["editor.fontSize"],lineHeight:e["editor.fontSize"]*a.G9,wordWrap:e["editor.wordWrap"].toLowerCase(),tabSize:e["editor.tabSize"],minimap:{enabled:e["editor.minimap"]},folding:e["editor.folding"],lineNumbers:"on",lineNumbersMinChars:4,scrollbar:{vertical:"visible",arrowSize:15},formatOnPaste:!0,glyphMargin:!1,fixedOverflowWidgets:!0,ariaLabel:"editor",wordWrapColumn:120,wrappingIndent:"indent",selectOnLineNumbers:!0};var t}(t);o.r.editor.updateOptions(n);var r=o.r.editor.getModel();r&&r.updateOptions({tabSize:t["editor.tabSize"]}),n.theme&&monaco.editor.setTheme(n.theme)}}}),this.settings=(0,i.Ok)()};Object.defineProperty(h,"_instance",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(h,"instance",{configurable:!0,enumerable:!0,writable:!0,value:function(){return h._instance||(h._instance=new h),h._instance}});var m=function(e){var t,n;function r(){return e.apply(this,arguments)||this}return n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,p(t,n),r}(u(Error))},1645:function(e,t,n){n.d(t,{zQ:function(){return d},ri:function(){return p},vf:function(){return g},Fy:function(){return h},tc:function(){return m},oh:function(){return v}});var r=n(59725),i=n(47393),a=n.n(i),o=n(58351),s=n(56222),c="all",u=new s.sH("EditorSettings",5e3,0,{canPurge:function(){return!1},compare:function(){return 0}}),l=!1,d=function(e){var t=u.read(c);a()(e,t)||(u.write(c,e)||l||((0,o.m)(new Error("Failed to write editor settings"),o.in.Warning),l=!0))},p=function(){var e=u.read(c),t=(0,r.Ok)();return void 0===e||Object.keys(t).forEach((function(n){e[n]&&(t[n]=e[n])})),t},f=new s.sH("PerScriptSettings",5e3,0,{canPurge:function(){return!1},compare:function(){return 0}}),g=function(e,t){f.write(e,t)||(0,o.m)(new Error("Failed to write per script settings"),o.in.Warning)},h=function(e){return f.read(e)||(0,r.Vg)()},m=function(e){f.purge(e)},v=function(e){f.keys().forEach((function(t){var n=f.read(t);n&&(n.isOwner||0!==e.filter((function(e){return e.storageScript.id===t})).length||m(t))}))}},22377:function(e,t,n){var r;n.d(t,{N:function(){return r}}),function(e){e.ConnectionPageRelaunchButton="Connection Page Relaunch Button",e.DetailsPageOverflowButton="Details Page Overflow Button",e.EditorPageOverflowButton="Editor Page Overflow Button",e.BackstagePageScriptOverflowButton="Backstage Page Script Overflow Button"}(r||(r={}))},79628:function(e,t,n){n.d(t,{ZP:function(){return H},dz:function(){return V}});var r=n(84586),i=n(21914),a=n(57776),o=n(14979),s=n(23873),c=n(39747),u=n(90828),l=n(60146),d=n(88360),p=n(32406),f=n(80590),g=n(12466),h=n(7765),m=n(49225);function v(){return v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},v.apply(this,arguments)}var b=function(e,t){return{root:{height:"100%",padding:"0 "+e.spacing.xSmall,backgroundColor:"transparent",fontSize:e.fontSizes.small,selectors:{".ms-Button-menuIcon":{fontSize:e.fontSizes.icon},".ms-Icon":{marginTop:".1rem",opacity:t?.5:1},"@media screen and (-ms-high-contrast: active)":{fill:"buttonText"}}},rootHovered:{backgroundColor:e.colors.neutralQuaternary},rootPressed:{backgroundColor:e.colors.neutralTertiaryAlt}}},y=(0,r.Zz)((function(e){var t=e.buttonProps,n=e.testId,r=e.theme,a=e.additionalStyles,o=e.tooltipText,s=e.dismissTooltipOnFirstShow,c=e.isMenuOpened,u=e.setOnMenuOpenedOrClosed,l=e.overflowMenuRef,d=void 0!==n&&void 0!==o,p=(0,i.useRef)(null),f=(0,i.useState)(!d||s?"":o),y=f[0],w=f[1],S=(0,i.useState)(!1),x=S[0],k=S[1];return i.createElement(h.G,{content:y,id:n+"-tooltip",componentRef:p,onTooltipToggle:function(e){k(e)},calloutProps:(0,m.FA)(r)},i.createElement(g.Q,v({"data-testid":n,styles:v({},b(r,!!t.disabled),a)},t,{"aria-describedby":d?n+"-tooltip":void 0,onMouseEnter:function(e){s&&!y&&(w(o||""),p.current&&p.current.show())},onMouseMove:function(e){p.current&&x&&p.current.dismiss()},onMenuClick:function(){u&&u(!c)},onAfterMenuDismiss:function(){u&&u(!1)},onKeyDown:function(e){"ArrowDown"===e.key&&e.altKey?u&&!c&&u(!0):"ArrowRight"===e.key&&l&&l.current&&(l.current.focus(),e.preventDefault(),e.stopPropagation())}})))}));function w(){return w=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},w.apply(this,arguments)}var S={root:{height:"100%",selectors:{":focus":{outline:0}}}},x=function(e){return e.onRender?e.onRender(e):i.createElement(y,{buttonProps:e,additionalStyles:e.additionalStyles,tooltipText:e.tooltipText,dismissTooltipOnFirstShow:e.dismissTooltipOnFirstShow,testId:e.key,overflowMenuRef:e.overflowMenuRef})},k=function(e){var t=null==e?void 0:e.pop();return i.createElement(y,{testId:(0,l.k)("ScriptItemOverflowButton"),buttonProps:{ariaLabel:strings.Editor.MoreAriaLabel,menuIconProps:{iconName:"VerticalMore"},menuProps:{items:e.map((function(e){return w({},e,{"data-testid":e.key})})),isBeakVisible:!1,focusZoneProps:{style:{backgroundColor:t.calloutBackgroundColor}}}},tooltipText:strings.Editor.OverflowMenuTooltipText,additionalStyles:t.isHoveredOrFocused||t.isMenuOpened?void 0:{root:{display:"none"}},isMenuOpened:t.isMenuOpened,setOnMenuOpenedOrClosed:t.setOnMenuOpenedOrClosed})},R=(0,r.Zz)((function(e){var t=e.primaryCommands,n=e.overflowCommands;return i.createElement(f.p,{items:t,overflowItems:n,onRenderOverflowButton:k,onRenderItem:x,styles:S})})),P=n(20260),C=n(84824),I=n(32641),O=n(67796),T=n(98320),E=n(57158),D=n(4936),M=n(27062),j=n(98425),L=n(29086),N=n(70530),B=n(79002),F=n(36103),A=n(81066),U=n(22377),z=n(57464);function _(){return _=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_.apply(this,arguments)}var H=(0,c.$j)((function(e){return{isScriptRunning:u.w.run.getIsRunning(e),currentPivotKey:u.w.backstage.getCurrentPivot(e),isAnyStorageCallInProgress:u.w.scripts.getIsAnyStorageCallInProgress(e)}}),{showDialog:u.N.dialog.show,setIsEditingScriptName:u.N.editor.setIsEditingScriptName,setNavigationSourcePage:u.N.editor.setNavigationSourcePage})((0,r.Zz)((function(e){var t=i.createRef(),n=(0,i.useState)(!1),r=n[0],c=n[1],u=(0,i.useState)(!1),d=u[0],p=u[1],f=(0,i.useState)(!1),g=f[0],h=f[1],m=(0,C.o)(e.script),v=(0,P.C)(e.script),b=(0,O.a)(e.script),y=m&&!v?strings.substitute(strings.Backstage.ScriptItemUserOwnedOneDriveRootFolderText,{creator:e.script.storageScript.creatorDisplayName||""}):b?strings.Backstage.ScriptItemSamplesRootFolderText:strings.Backstage.ScriptItemMyFilesRootFolderText,w=(0,s.o)(e.script),S=e.script.localUpdates.shareId?"OfficeScriptsSharedIcon32":"OfficeScriptsIcon32",x=d||r,k=(0,i.useState)(!0),M=k[0],L=k[1];(0,T.g)().then((function(e){L(e)}));var N={key:"Overflow extra properties carrier",isMenuOpened:g,setOnMenuOpenedOrClosed:function(e){h(e),p(e),c(e)},overflowMenuRef:t,isHoveredOrFocused:x,theme:e.theme,calloutBackgroundColor:e.theme.colors.neutralLighterAlt},B=[].concat(J(_({},e,{isSharingEnabled:M})),[N]);return i.createElement(E.k,{style:{padding:e.theme.spacing.xSmall,display:"inline-flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer",minWidth:"100%",maxWidth:"101%",background:g?e.theme.colors.neutralQuaternaryAlt:r?e.theme.colors.neutralTertiaryAlt:d?e.theme.colors.neutralQuaternaryAlt:void 0,outline:r?"none":void 0},direction:D.U.horizontal,isCircularNavigation:!0,"data-is-focusable":"true",onClick:function(){e.openScript(e.script,"Details")},"data-testid":"testId-scriptItem_"+e.script.storageScript.id,"aria-label":(0,s.o)(e.script)?strings.substitute(strings.Backstage.UnsavedScriptAriaLabel,{name:e.script.storageScript.name}):e.script.storageScript.name,role:"button",onFocus:function(e){c(!0)},onBlur:function(e){c(!1)},onMouseEnter:function(e){p(!0)},onMouseLeave:function(e){p(!1)}},i.createElement(W,{isHoveredOrFocused:x,isMenuOpened:g},i.createElement(a.J,{iconName:S,styles:q(e.theme),"aria-hidden":"true"}),i.createElement(Z,null,i.createElement(o._,{styles:G(e.theme),"aria-hidden":"true"},e.script.storageScript.name),A.X.instance().isTeamOwnershipUXEnabled()||(0,z.$)(e.script)?i.createElement(j.Z,{script:e.script,isPointerCursor:!0,scriptHasUnsavedChanges:w,shouldSplit:!A.X.instance().isTeamOwnershipUXEnabled()||"Attached"===e.currentPivotKey}):i.createElement(I.Z,{rootFolder:y,isPointerCursor:!0,scriptHasUnsavedChanges:w,showSubFolder:!0}))),i.createElement(R,{primaryCommands:[{key:(0,l.k)("BackstageScriptEditButton")+"_"+e.script.storageScript.id,iconProps:{iconName:"EditGeneric16"},onClick:function(t){t.stopPropagation(),e.setNavigationSourcePage("BackStage"),e.openScript(e.script,"Editor")},tooltipText:strings.Backstage.EditScriptButtonTooltip,additionalStyles:x||g?void 0:{root:{display:"none"}},overflowMenuRef:t}],overflowCommands:B}))}))),W=r.ZP.div.withConfig({displayName:"ScriptItemDetailView__PullLeftWrapper",componentId:"d79rhv-0"})(["display:inline-flex;align-items:center;width:",";"],(function(e){return e.isHoveredOrFocused||e.isMenuOpened?"calc(100% - 130px)":"85%"})),Z=r.ZP.div.withConfig({displayName:"ScriptItemDetailView__ItemBodyWrapper",componentId:"d79rhv-1"})(["padding-left:",";width:100%;"],(function(e){return e.theme.spacing.smallPlus})),G=function(e){return{root:[_({},Q,{fontSize:e.fontSizes.medium,fontWeight:e.fontWeights.regular,color:e.colors.neutralDark,paddingBottom:0,width:"100%",selectors:{":hover":{textDecoration:"underline"}}})]}},V=function(e,t,n){return t?{root:[_({},Q(e),{paddingTop:0,fontWeight:n?e.fontWeights.bold:e.fontWeights.regular,fontSize:e.fontSizes.small,color:e.colors.neutralSecondary})]}:{root:[_({},X(e),{paddingTop:0,fontWeight:n?e.fontWeights.bold:e.fontWeights.regular,fontSize:e.fontSizes.small,color:e.colors.neutralSecondary})]}},X=function(e){return{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis",selectors:{":hover":{color:e.colors.linkTextHovered},"@media screen and (-ms-high-contrast: active)":{selectors:{":focus":{backgroundColor:"highlight",color:"highlighttext",MsHighContrastAdjust:"none"}}}}}},Q=function(e){return _({},X(e),{cursor:"pointer"})},q=function(e){return{root:{padding:e.spacing.xSmall,fontSize:e.fontSizes.icon,marginTop:".6rem"}}},J=function(e){var t=e.script,n=e.isAnyStorageCallInProgress,r=e.showConnectionPage,i=(0,P.C)(t),a=(0,C.o)(t),o=!a&&i&&e.isSharingEnabled,c=!!e.script,f=(0,d.E)(e.script,e.isScriptRunning,e.isAnyStorageCallInProgress),g=(0,p.E)(e.script,e.isScriptRunning,e.isAnyStorageCallInProgress,!0),h={key:(0,l.k)("BackstageOverflowRunButton"),text:strings.General.RunButtonText,iconProps:{iconName:"PlayIcon"},onClick:function(){!function(e){var t=F.u.store,n=(0,L.get)(t.getState(),e.storageScript.id);(0,s.o)(n)&&t.dispatch(u.N.scripts.updateSavingStatus({id:e.storageScript.id,status:"Unsaved"})),t.dispatch(u.N.editor.setActive({id:e.storageScript.id,attemptToRun:!0})),t.dispatch(u.N.editor.showDetailsPage()),t.dispatch(u.N.backstage.hide())}(e.script)}},m=(0,N.OC)((0,l.k)("BackStageOverflowEditButton"),(function(t){t.stopPropagation(),e.setNavigationSourcePage("BackStage"),e.openScript(e.script,"Editor")})),v=(0,M.c)({entryPoint:U.N.BackstagePageScriptOverflowButton,script:t,isStorageCallInProgress:n,callback:r}),b=(0,N.TW)((0,l.k)("BackStageShareButton"),a,e.isSharingEnabled,{onClick:function(){var t=F.u.store;e.openScript(e.script,"Details"),t.dispatch(u.N.shareDialog.show())}}),y=(0,N.O8)((0,l.k)("BackStageStopSharingButton"),{onClick:function(){var t=F.u.store;e.openScript(e.script,"Details"),t.dispatch(u.N.unshareDialog.show())}}),w=(0,N.LY)((0,l.k)("Divider")+"BackStage1"),S=(0,N.lq)((0,l.k)("BackstageOverflowDeleteButton"),e.script,g),x=(0,N.sI)((0,l.k)("BackstageOverflowRenameButton"),i,(function(){e.setIsEditingScriptName(!0),e.openScript(e.script,"Details")})),k=A.X.instance().isTeamOwnershipUXEnabled()?(0,N.co)((0,l.k)("BackStageCopyToButton"),f,(function(){B.P.instance(F.u.store).makeACopyTo(t,"BackStage")})):(0,N.xT)((0,l.k)("BackstageOverflowCopyButton"),f,(function(){B.P.instance(F.u.store).makeACopyOfScript(t.storageScript.id,"Backstage")})),R=(0,N.LY)((0,l.k)("Divider")+"Backstage2"),I=(0,N.mw)((0,l.k)("BackStageFlowButton"),e.script,"BackStage"),O=(0,N.LY)((0,l.k)("Divider")+"Backstage3"),T=(0,N.kQ)((0,l.k)("BackstageOverflowAddButtonToWorkbookButton"),e.script,e.isSharingEnabled,e.addButtonToWorkbook),E=strings.General.DetailsButtonText,D={key:(0,l.k)("BackstageOverflowDetailsButton"),text:E,ariaLabel:E,disabled:!c,iconProps:{iconName:"ShowDetailsPageMenuIcon",style:c?{marginTop:".0rem"}:{marginTop:".0rem",opacity:"50%"}},onClick:function(){e.openScript(e.script,"Details")}};return[h,m].concat(v,[o&&b,a&&y,w,S,x,k,R,I,T,O,D]).filter(Boolean)}},36103:function(e,t,n){n.d(t,{u:function(){return r}});var r=function(){};Object.defineProperty(r,"store",{configurable:!0,enumerable:!0,writable:!0,value:void 0})},27946:function(e,t,n){n.d(t,{d:function(){return r}});var r=function(){};Object.defineProperty(r,"store",{configurable:!0,enumerable:!0,writable:!0,value:void 0})},64295:function(e,t,n){var r=n(44434),i=n(99627),a=n(75434),o=n(54050);t.Z=function(e){var t=(0,a.nz)(),n=i.if.instance().getCachedStorageToken(),s={storageAuth:n?{token:n.token,timeStamp:n.expirationTime-i.if.getExpirationTime()}:{token:"",timeStamp:void 0}},c={Script:JSON.stringify((0,r.Z)(e)),Source:"RunFromButton",Destination:"Details",IsOwner:"true",invocationContext:JSON.stringify(s),UnconditionalForceRefresh:""};return(0,o.dp)("Editor",t,c)}},35826:function(e,t,n){n.d(t,{v:function(){return o}});var r=n(36103),i=n(52105),a=n(27946);function o(){return"RunFromButton"===(0,i.L3)()?a.d.store:r.u.store}},3515:function(e,t,n){n.d(t,{jP:function(){return a},sI:function(){return o}});var r=n(30747);function i(e){var t=r.e3.filter((function(t){return t.id===e}));if(1!==t.length)throw new Error("Did not find link for key "+e+". This is an internal bug.");return t[0]}function a(e,t){for(var n=function(e){var t=Object.keys(e).map((function(t){return{linkId:t,count:e[t]}}));return t.sort((function(e,t){return t.count-e.count})),t}(e),a=n.filter((function(e){return e.count>0}));a.length>t;)a.pop();var o=a.map((function(e){return e.linkId}));return r.NX.forEach((function(e){o.length<t&&o.indexOf(e)<0&&o.push(e)})),o.map((function(e){return i(e)}))}function o(){return r.NX.map((function(e){return i(e)}))}},30757:function(e,t,n){var r;n.d(t,{C:function(){return r}}),function(e){e.WebSocket="websocket",e.Single="single",e.Persistent="persistent"}(r||(r={}))},90845:function(e,t,n){var r;n.d(t,{a:function(){return r}}),function(e){e.None="none",e.Local="local",e.LocalInsiders="localinsiders",e.Insiders="insiders",e.Production="production"}(r||(r={}))},29159:function(e,t,n){n.d(t,{l:function(){return r}});var r=n(30757).C.Single},93275:function(e,t,n){n.d(t,{P:function(){return r}});var r=n(90845).a.Insiders},91981:function(e,t,n){n.d(t,{F:function(){return a}});var r=n(52766),i=n(24350);function a(e){var t=e.entryPoint,n=e.target,a=e.channel,o=e.script,s=e.callback;return function(){(0,i.f)(o),(0,r.U)({target:n,channel:a,entryPoint:t}),s&&s()}}},27062:function(e,t,n){n.d(t,{c:function(){return l}});var r=n(82750),i=n(93275),a=n(91981),o=n(65506),s=n(47180),c=n(67833),u=n(29159);function l(e){var t=c.p.instance().getAllSettings()["editor.extension"];if((0,r.HQ)("OfficeScriptConnection")&&t||(0,r.HQ)("OfficeScriptConnectionOn")){var n=e.isStorageCallInProgress,l=e.script,d=e.callback,p=e.entryPoint,f=(0,s.I)(l,n)&&(0,o.Z)(l),g=!f,h=(0,a.F)({entryPoint:p,target:i.P,channel:u.l,script:l,callback:d});return[{key:"MainHeaderOverflowExtensionOptionButton",text:strings.Details.OpenInVSCode,iconProps:{iconName:"VisualStudioCode16",style:f?{marginTop:".1rem"}:{marginTop:".1rem",opacity:"50%"}},disabled:g,tooltipText:f?"Open the script in an external editor":"You cannot edit the script because you are not the owner",onClick:h}]}return[]}},38758:function(e,t,n){n.d(t,{AR:function(){return a},Ry:function(){return o},so:function(){return s}});var r=n(58351),i=function(){};function a(e){i=e}function o(e){i&&i(e)}function s(e){o(e),(0,r.ve)({eventName:"MceConnection",eventType:"System",data:{operation:"StatusChange",status:e}})}},24350:function(e,t,n){n.d(t,{f:function(){return i},s:function(){return a}});var r=void 0;function i(e){r=e}function a(){return r}},52766:function(e,t,n){n.d(t,{x:function(){return Ot},U:function(){return It}});var r=n(36030),i=n(58351),a=n(30757),o="[OfficeScripts:Connection]",s=n(99212);function c(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){c(a,r,i,o,s,"next",e)}function s(e){c(a,r,i,o,s,"throw",e)}o(void 0)}))}}function l(e,t){return d.apply(this,arguments)}function d(){return(d=u(regeneratorRuntime.mark((function e(t,n){var r,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:logger.log(o+" commandTelemetryEvent ["+n.messageType+"]"),r=n.data,a=r.name,s=r.data,e.t0=a,e.next="Activated"===e.t0?5:7;break;case 5:return(0,i.ve)({eventName:"Extension",eventType:"System",data:{operationName:a,version:s.version}}),e.abrupt("break",8);case 7:return e.abrupt("break",8);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function p(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){p(a,r,i,o,s,"next",e)}function s(e){p(a,r,i,o,s,"throw",e)}o(void 0)}))}}function g(e,t){return h.apply(this,arguments)}function h(){return(h=f(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:logger.log(o+" commandAlive ["+n.messageType+"]"),t.sendAliveResult();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var m=n(54050);function v(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function b(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){v(a,r,i,o,s,"next",e)}function s(e){v(a,r,i,o,s,"throw",e)}o(void 0)}))}}function y(e,t){return w.apply(this,arguments)}function w(){return(w=b(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return logger.log(o+" commandGetConnectedDocumentName ["+n.messageType+"]"),e.next=3,(0,m.wH)();case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0="";case 6:r=e.t0,t.sendGetConnectedDocumentNameResult(r);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var S=n(59406),x=n(49724),k=n(12880),R=n(68495),P=n(73613),C=n(42803),I=n(82750),O=n(71849);function T(e){if(void 0!==e)return JSON.parse(e).id}function E(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function D(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){E(a,r,i,o,s,"next",e)}function s(e){E(a,r,i,o,s,"throw",e)}o(void 0)}))}}function M(e,t){return j.apply(this,arguments)}function j(){return(j=D(regeneratorRuntime.mark((function e(t,n){var r,a,s,c,u,l,d,p,f,g,h,m,v;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.messageType,a=new i.pX("MceConnection","System"),logger.log(o+" commandLintScript ["+n.messageType+"]"),s=n.data.script,c=s.id,u=s.body,l=T(c),!(0,I.HQ)("ScriptOM")){e.next=14;break}return e.next=8,O.I.instance();case 8:return p=e.sent,e.next=11,p.getScript(JSON.parse(c));case 11:d=e.sent,e.next=20;break;case 14:return e.next=16,C.c.instance();case 16:return f=e.sent,e.next=19,f.getScript(JSON.parse(c));case 19:d=e.sent;case 20:return e.next=22,(0,S.x)((0,R.v)(d));case 22:return g=e.sent,e.next=25,(0,x.L)(u,g);case 25:return h=e.sent,e.next=28,(0,P.D)();case 28:m=e.sent,v=h.linterErrors.map((function(e){var t=e.errorCode,n=e.position,r=e.severity,i=new Map([[k.LinterErrorSeverity.Hint,"hint"],[k.LinterErrorSeverity.Info,"info"],[k.LinterErrorSeverity.Warning,"warn"],[k.LinterErrorSeverity.Error,"error"]]).get(r);if(void 0===i)throw new Error("unknown severity "+r);return{code:t,message:m.errorCodeToMessage(t),severity:i,position:n}})),t.sendLintScriptResult({id:c},v),a.succeed(i.in.Information,{operation:r,storageId:l});case 32:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function L(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function N(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){L(a,r,i,o,s,"next",e)}function s(e){L(a,r,i,o,s,"throw",e)}o(void 0)}))}}function B(e,t){return F.apply(this,arguments)}function F(){return(F=N(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:logger.log(o+" commandPing ["+n.messageType+"]"),t.sendPong();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var A=n(88527);function U(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function z(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){U(a,r,i,o,s,"next",e)}function s(e){U(a,r,i,o,s,"throw",e)}o(void 0)}))}}function _(e,t){return H.apply(this,arguments)}function H(){return(H=z(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return logger.log(o+" commandGetOfficeScriptIntellisense ["+n.messageType+"]"),e.next=3,(0,A.v)();case 3:r=e.sent,t.sendGetOfficeScriptIntellisenseResult(r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var W=n(59013),Z=n(22883),G=n(5523);function V(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function X(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){V(a,r,i,o,s,"next",e)}function s(e){V(a,r,i,o,s,"throw",e)}o(void 0)}))}}var Q=function(){function e(){Object.defineProperty(this,"cache",{configurable:!0,enumerable:!0,writable:!0,value:new Map})}var t=e.prototype;return t.clear=function(){this.cache=new Map},t.getScriptById=function(){var e=X(regeneratorRuntime.mark((function e(t,n){var r,i,a,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=JSON.parse(t),i=r.id,a=this.cache.get(i),!(null!=n&&n.update||void 0===a)){e.next=11;break}return e.next=6,q(t);case 6:if(void 0!==(o=e.sent)){e.next=9;break}return e.abrupt("return",void 0);case 9:return this.cache.set(i,o),e.abrupt("return",o);case 11:return e.abrupt("return",a);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),e}();function q(e){return J.apply(this,arguments)}function J(){return(J=X(regeneratorRuntime.mark((function e(t){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.parse(t),e.prev=1,e.next=4,C.c.instance();case 4:return i=e.sent,e.next=7,i.getScript(n);case 7:r=e.sent,e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),K(e.t0),e.abrupt("return",void 0);case 14:return e.abrupt("return",r);case 15:case"end":return e.stop()}}),e,null,[[1,10]])})))).apply(this,arguments)}function K(e){var t=(0,Z.IG)(e),n=(0,Z.ZX)(e),r=t?strings.Message.FailedToOpenDeletedScriptMessage:n?strings.Message.TimeOutErrorMessage:strings.Message.FailedToOpenScriptMessage;logger.log(o+" retrieveScript error message: ["+r+"]")}var $=new Q;function Y(e,t){return ee.apply(this,arguments)}function ee(){return(ee=X(regeneratorRuntime.mark((function e(t,n){var r,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,I.HQ)("ScriptOM")){e.next=16;break}return r=JSON.parse(t),e.next=4,G.L.getInstance();case 4:return i=e.sent,e.prev=5,e.next=8,i.getScript(r,null==n?void 0:n.update);case 8:return a=e.sent,e.abrupt("return",a);case 12:return e.prev=12,e.t0=e.catch(5),K(e.t0),e.abrupt("return",void 0);case 16:return e.abrupt("return",$.getScriptById(t,n));case 17:case"end":return e.stop()}}),e,null,[[5,12]])})))).apply(this,arguments)}function te(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function ne(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){te(a,r,i,o,s,"next",e)}function s(e){te(a,r,i,o,s,"throw",e)}o(void 0)}))}}function re(e,t){return ie.apply(this,arguments)}function ie(){return(ie=ne(regeneratorRuntime.mark((function e(t,n){var r,a,s,c,u,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.messageType,a=new i.pX("MceConnection","System"),logger.log(o+" commandGetScript ["+n.messageType+"]"),s=n.data.script.id,c=T(s),e.prev=5,e.next=8,Y(s,{update:!0});case 8:if(void 0!==(u=e.sent)){e.next=13;break}return t.sendGetScriptResultFail(),a.fail(i.in.Error,{operation:r,storageId:c},"script undefined"),e.abrupt("return");case 13:l={id:JSON.stringify((0,W.c)(u)),name:u.storageScript.name,body:u.localUpdates.body||u.storageScript.body||""},t.sendGetScriptResult(l),a.succeed(i.in.Information,{operation:r,storageId:c}),e.next=23;break;case 18:throw e.prev=18,e.t0=e.catch(5),t.sendGetScriptResultFail(),a.fail(i.in.Error,{operation:r,storageId:c},e.t0),e.t0;case 23:case"end":return e.stop()}}),e,null,[[5,18]])})))).apply(this,arguments)}var ae=n(89991);function oe(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function se(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){oe(a,r,i,o,s,"next",e)}function s(e){oe(a,r,i,o,s,"throw",e)}o(void 0)}))}}function ce(){return ue.apply(this,arguments)}function ue(){return(ue=se(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,I.HQ)("ScriptOM")){e.next=8;break}return e.next=3,O.I.instance();case 3:return e.next=5,e.sent.getRecentScripts();case 5:t=e.sent.map((function(e){return(0,ae.k)(e)})),e.next=14;break;case 8:return e.next=10,C.c.instance();case 10:return n=e.sent,e.next=13,n.getRecentScripts();case 13:t=e.sent.map((function(e){return(0,ae.k)(e)}));case 14:return r=t.map((function(e){var t=JSON.stringify((0,W.c)(e));return{name:e.storageScript.name,id:t}})),e.abrupt("return",r);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function le(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function de(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){le(a,r,i,o,s,"next",e)}function s(e){le(a,r,i,o,s,"throw",e)}o(void 0)}))}}function pe(e,t){return fe.apply(this,arguments)}function fe(){return(fe=de(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return logger.log(o+" commandGetRecentScriptList ["+n.messageType+"]"),e.next=3,ce();case 3:r=e.sent,t.sendGetRecentScriptListResult(r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ge=n(79002),he=n(36103);function me(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function ve(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){me(a,r,i,o,s,"next",e)}function s(e){me(a,r,i,o,s,"throw",e)}o(void 0)}))}}function be(e,t){return ye.apply(this,arguments)}function ye(){return(ye=ve(regeneratorRuntime.mark((function e(t,n){var r,a,s,c,u,l,d,p,f,g;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.messageType,a=new i.pX("MceConnection","System"),logger.log(o+" commandSaveScript ["+n.messageType+"]"),s=n.data.script,c=s.id,u=s.body,l=T(c),!(0,I.HQ)("ScriptOM")){e.next=14;break}return e.next=8,O.I.instance();case 8:return p=e.sent,e.next=11,p.getScript(JSON.parse(c));case 11:d=e.sent,e.next=20;break;case 14:return e.next=16,C.c.instance();case 16:return f=e.sent,e.next=19,f.getScript(JSON.parse(c));case 19:d=e.sent;case 20:return e.next=22,ge.P.instance(he.u.store).saveScript(d,{body:u});case 22:g=Date.now(),!0,t.sendSaveScriptResult({id:c,dateLastModified:g},true),a.succeed(i.in.Information,{operation:r,storageId:l});case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function we(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function Se(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){we(a,r,i,o,s,"next",e)}function s(e){we(a,r,i,o,s,"throw",e)}o(void 0)}))}}function xe(e,t){return ke.apply(this,arguments)}function ke(){return(ke=Se(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:logger.log(o+" commandGetFlights ["+n.messageType+"]"),t.sendGetFlightsResult({OfficeScriptConnectionTest:(0,I.HQ)("OfficeScriptConnectionTest")});case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Re=n(64945),Pe=n(29086),Ce=n(24350);function Ie(e){return{id:JSON.stringify((0,W.c)(e)),name:e.storageScript.name,body:e.localUpdates.body||e.storageScript.body||"",apiInfo:e.localUpdates.apiInfo||e.storageScript.apiInfo}}function Oe(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function Te(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){Oe(a,r,i,o,s,"next",e)}function s(e){Oe(a,r,i,o,s,"throw",e)}o(void 0)}))}}function Ee(e,t){return De.apply(this,arguments)}function De(){return(De=Te(regeneratorRuntime.mark((function e(t,n){var r,i,a,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(logger.log(o+" commandGetActiveScript ["+n.messageType+"]"),r=void 0,!(i=(0,Ce.s)())){e.next=7;break}r=i,e.next=13;break;case 7:if(a=he.u.store.getState(),s=(0,Re.getActiveScriptId)(a)){e.next=12;break}return logger.log(o+" commandGetActiveScript - no recent scripts"),e.abrupt("return");case 12:r=(0,Pe.get)(a,s);case 13:c=Ie(r),t.sendGetActiveScriptResult(c);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Me=n(3136),je=n(81908),Le=n(82143),Ne=n(76140),Be=n(67207),Fe=n(99824);function Ae(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function Ue(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){Ae(a,r,i,o,s,"next",e)}function s(e){Ae(a,r,i,o,s,"throw",e)}o(void 0)}))}}var ze={runtimeTracker:void 0,runtime:void 0,runtimeTerminated:!0};function _e(){var e=ze.runtime,t=ze.runtimeTerminated;if(void 0===e||t)return!0;var n=e.getState();return n===Fe.tu.Done||n===Fe.tu.Error}function He(){return We.apply(this,arguments)}function We(){return(We=Ue(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(t=ze.runtime)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,t.terminate();case 5:ze.runtimeTerminated=!0;case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ze(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function Ge(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){Ze(a,r,i,o,s,"next",e)}function s(e){Ze(a,r,i,o,s,"throw",e)}o(void 0)}))}}function Ve(e,t){return Xe.apply(this,arguments)}function Xe(){return(Xe=Ge(regeneratorRuntime.mark((function e(t,n){var r,a,s,c,u,l,d,p,f,g,h,m,v,b;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.messageType,a=new i.pX("MceConnection","System"),logger.log(o+" commandRunScriptStart ["+n.messageType+"]"),s=n.data.script,c=s.id,u=s.body,l=T(c),_e()){e.next=9;break}return t.sendRunScriptStartResultFail(),a.succeed(i.in.Information,{operation:r,storageId:l,message:"script already running"}),e.abrupt("return");case 9:return e.prev=9,e.next=12,Y(c);case 12:if(void 0!==(d=e.sent)){e.next=17;break}return t.sendRunScriptStartResultFail(),a.fail(i.in.Error,{operation:r,storageId:l},"script undefined"),e.abrupt("return");case 17:return p=Qe((function(e){logger.log(o+" sendRunScriptLogResult "+e),t.sendRunScriptLogResult(e)})),ze.runtimeTracker=new je.S(p,(function(){})),e.next=21,(0,Le.$)(d);case 21:return f=e.sent,e.prev=22,e.next=25,(0,Ne.sz)(u,d,f);case 25:return g=e.sent,e.next=28,ze.runtimeTracker.getRuntime(d);case 28:return h=e.sent,ze.runtime=h,ze.runtimeTerminated=!1,e.next=33,h.loadCode(g);case 33:return t.sendRunScriptStartResult(h.getId()),e.next=36,h.executeFunction(Be.gM,[]);case 36:m=e.sent,t.sendRunScriptReturnResult(m),e.next=48;break;case 40:return e.prev=40,e.t0=e.catch(22),e.next=44,(0,Me.a)(e.t0);case 44:v=e.sent,b=v.errorMessage,t.sendRunScriptErrorResult(b),a.succeed(i.in.Information,{operation:r,storageId:l,message:"error"});case 48:return e.prev=48,He(),e.finish(48);case 51:e.next=58;break;case 53:throw e.prev=53,e.t1=e.catch(9),t.sendRunScriptStartResultFail(),a.fail(i.in.Error,{operation:r,storageId:l},e.t1),e.t1;case 58:case"end":return e.stop()}}),e,null,[[9,53],[22,40,48,51]])})))).apply(this,arguments)}function Qe(e){var t=function(t,n){e(n)};return{log:t,info:t,warn:t,error:t}}function qe(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function Je(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){qe(a,r,i,o,s,"next",e)}function s(e){qe(a,r,i,o,s,"throw",e)}o(void 0)}))}}function Ke(e,t){return $e.apply(this,arguments)}function $e(){return($e=Je(regeneratorRuntime.mark((function e(t,n){var r,a,s,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.messageType,a=new i.pX("MceConnection","System"),logger.log(o+" commandRunScriptStop ["+n.messageType+"]"),s=n.data.runtimeId,c=ze.runtimeTerminated,e.next=7,He();case 7:c?t.sendRunScriptStopResultFail(s):t.sendRunScriptStopResult(s),a.succeed(i.in.Information,{operation:r});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ye(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function et(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){Ye(a,r,i,o,s,"next",e)}function s(e){Ye(a,r,i,o,s,"throw",e)}o(void 0)}))}}function tt(e,t){return nt.apply(this,arguments)}function nt(){return(nt=et(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:logger.log(o+" commandHitDebuggerStatement ["+n.messageType+"]");case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var rt=n(38758);function it(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function at(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){it(a,r,i,o,s,"next",e)}function s(e){it(a,r,i,o,s,"throw",e)}o(void 0)}))}}function ot(e,t){return st.apply(this,arguments)}function st(){return(st=at(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:logger.log(o+" commandAliveResult ["+n.messageType+"]"),(0,rt.Ry)(s.MceConnectionStatus.Connected);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ct(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function ut(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){ct(a,r,i,o,s,"next",e)}function s(e){ct(a,r,i,o,s,"throw",e)}o(void 0)}))}}function lt(e,t){return dt.apply(this,arguments)}function dt(){return(dt=ut(regeneratorRuntime.mark((function e(t,n){var r,a,s,c,u,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.messageType,a=new i.pX("MceConnection","System"),logger.log(o+" commandGetInitialSetup ["+n.messageType+"]"),e.prev=3,void 0!==(s=(0,Ce.s)())){e.next=9;break}return t.sendGetInitialSetupResultFail(),a.fail(i.in.Error,{operation:r},"script undefined"),e.abrupt("return");case 9:return c=Ie(s),e.next=12,ce();case 12:return u=e.sent,e.next=15,(0,A.v)();case 15:l=e.sent,t.sendGetInitialSetupResult(c,u,l),a.succeed(i.in.Information,{operation:r}),e.next=25;break;case 20:throw e.prev=20,e.t0=e.catch(3),t.sendGetInitialSetupResultFail(),a.fail(i.in.Error,{operation:r},e.t0),e.t0;case 25:case"end":return e.stop()}}),e,null,[[3,20]])})))).apply(this,arguments)}function pt(e){var t=new s.MceConnection(e,"server",{log:function(){}});return t.on("Ping",B),t.on("Alive",g),t.on("AliveResult",ot),t.on("GetRecentScriptList",pe),t.on("GetScript",re),t.on("LintScript",M),t.on("RunScriptStop",Ke),t.on("RunScriptStart",Ve),t.on("GetActiveScript",Ee),t.on("SaveScript",be),t.on("GetOfficeScriptIntellisense",_),t.on("GetConnectedDocumentName",y),t.on("GetInitialSetup",lt),t.on("HitDebuggerStatement",tt),t.on("TelemetryEvent",l),t.on("GetFlights",xe),t.onConnectionStatusChange((function(e){(0,rt.so)(e)})),t}var ft=n(90845);function gt(e,t,n){var r=t.target,c=t.entryPoint;void 0===n&&(n="");var u=function(e){var t=void 0;return void 0!==e&&(t=new i.pX("OpenCode","User")),{done:function(){t&&t.succeed(i.in.Information,{entryPoint:e})}}}(c);logger.log(o+" Open Visual Studio Code Online ["+r+"] ["+c+"]");var l=function(e){var t="http://localhost:3000",n={origin:t,url:"http://localhost:3000/office"},r={origin:t,url:"http://localhost:3000/office?vscode-quality=insider"},i={origin:"https://insiders.vscode.dev",url:"https://insiders.vscode.dev/office"},a={origin:"https://vscode.dev",url:"https://vscode.dev/office"};return new Map([[ft.a.Local,n],[ft.a.LocalInsiders,r],[ft.a.Insiders,i],[ft.a.Production,a]]).get(e)||a}(r),d=l.url,p=l.origin,f=""+d+n;window.addEventListener("message",(function t(n){if("vscode.ready"===n.data.type){window.removeEventListener("message",t);var r=new MessageChannel,i=r.port1,o=r.port2,c=new s.ConnectionMessagePort(i);e.channel=a.C.Single,e.connection=pt(c),e.vscode&&e.vscode.postMessage({type:"vscode.port",port:o},p,[o]),u.done()}})),e.vscode=window.open(f,"_blank")}function ht(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}var mt,vt=function(){function e(e,t){Object.defineProperty(this,"iframe",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"port",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),this.iframe=e,this.port=t}return e.open=function(){var t,n=(t=regeneratorRuntime.mark((function t(n){var r,i,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=void 0,t.next=3,new Promise((function(e){window.addEventListener("message",(function t(r){if(r){var i=r.origin,a=r.source,o=r.data;if(i===n)if("ready"===(null==o?void 0:o.type))a.postMessage({type:"trust"},i);else if("port"===(null==o?void 0:o.type)){var s;window.removeEventListener("message",t);var c=null==(s=r.data)?void 0:s.port;if(!c)return void e(void 0);e(c)}}}));var t=n+"/connection/channel.html";(r=document.createElement("iframe")).hidden=!0,r.style.display="none",r.setAttribute("sandbox","allow-scripts allow-same-origin"),r.src=t,document.body.appendChild(r)}));case 3:if(i=t.sent,void 0!==r&&void 0!==i){t.next=6;break}return t.abrupt("return",void 0);case 6:return a=new e(r,i),t.abrupt("return",a);case 8:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(e){ht(a,r,i,o,s,"next",e)}function s(e){ht(a,r,i,o,s,"throw",e)}o(void 0)}))});return function(e){return n.apply(this,arguments)}}(),e}(),bt=n(85341);function yt(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function wt(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){yt(a,r,i,o,s,"next",e)}function s(e){yt(a,r,i,o,s,"throw",e)}o(void 0)}))}}function St(e){return xt.apply(this,arguments)}function xt(){return(xt=wt(regeneratorRuntime.mark((function e(t){var n,r,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==mt){e.next=15;break}return"https://api.test.arbitraryrunner.com","https://api.officescripts.microsoftusercontent.com",n="https://api.test.arbitraryrunner.com",t===ft.a.Production&&(n="https://api.officescripts.microsoftusercontent.com"),e.next=7,vt.open(n);case 7:if(void 0!==(r=e.sent)){e.next=10;break}return e.abrupt("return",void 0);case 10:return i=r.port,e.next=13,bt.Y.create(i);case 13:a=e.sent,mt=a;case 15:return e.abrupt("return",mt);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function kt(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function Rt(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){kt(a,r,i,o,s,"next",e)}function s(e){kt(a,r,i,o,s,"throw",e)}o(void 0)}))}}function Pt(){return Pt=Rt(regeneratorRuntime.mark((function e(t,n){var r,i,o,c,u,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.target,i=n.entryPoint,logger.log("openConnectionPersistent"),e.next=4,St(r);case 4:if(o=e.sent,c=void 0,void 0!==o){e.next=9;break}e.next=16;break;case 9:if(e.t0=o.isOtherAvailable(),!e.t0){e.next=14;break}return e.next=13,o.connectOtherAvailableLatest();case 13:e.t0=e.sent;case 14:if(!e.t0){e.next=16;break}c=o.getCurrentPort();case 16:void 0===c?("?connect=all&mode=prod","?connect=all&mode=test",u="?connect=all&mode=test",r===ft.a.Production&&(u="?connect=all&mode=prod"),gt(t,{target:r,entryPoint:i},u)):(l=new s.ConnectionMessagePort(c),t.channel=a.C.Persistent,t.connection=pt(l));case 17:case"end":return e.stop()}}),e)}))),Pt.apply(this,arguments)}var Ct={connection:void 0,channel:void 0,id:(0,r.v4)(),vscode:null};function It(e){switch(e.channel){case a.C.WebSocket:!function(e){logger.log(o+" open"),e.connection&&(e.connection.close(),e.connection=void 0,e.channel=void 0);var t=new s.ConnectionWebSocket({log:function(e){logger.log(o+"\n"+e)}});t.onOpen((function(t){e.channel=a.C.WebSocket,e.connection=pt(t),e.connection.sendIdentify(e.id)})),t.open()}(Ct);break;case a.C.Single:gt(Ct,e);break;case a.C.Persistent:!function(e,t){Pt.apply(this,arguments)}(Ct,e)}}function Ot(){var e=new i.pX("CloseCode","User");switch(Ct.channel){case a.C.WebSocket:!function(e){logger.log(o+" close"),e.connection&&(e.connection.close(),e.connection=void 0,e.channel=void 0)}(Ct);break;case a.C.Single:!function(e){e.vscode&&e.vscode.close(),e.connection&&(e.connection.close(),e.connection=void 0,e.channel=void 0)}(Ct);break;case a.C.Persistent:!function(e){var t;null==(t=e.connection)||t.close(),e.channel=void 0}(Ct)}e.succeed(i.in.Information,{})}},47272:function(e,t,n){n.d(t,{S:function(){return u}});var r=n(17317);function i(e){return r.x||r.Y8?e:function(){return Excel.run({delayForCellEdit:!0},e)}}var a=n(58351),o=n(56136);function s(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){s(a,r,i,o,c,"next",e)}function c(e){s(a,r,i,o,c,"throw",e)}o(void 0)}))}}var u=function(e,t,n){var r=this;void 0===n&&(n=!0),Object.defineProperty(this,"displayInIframe",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"height",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"width",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"resolveDialog",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"activity",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dialog",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"displayDialogAsync",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=c(regeneratorRuntime.mark((function e(t,n){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=i(c(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve());case 1:case"end":return e.stop()}}),e)})))),e.next=3,a();case 3:return e.abrupt("return",r.displayDialogAsyncInner(t,n));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"displayDialogAsyncInner",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=c(regeneratorRuntime.mark((function e(t,n){var i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=(0,o.c)(),s=r.convertPixelToPercentage(),Office.context.ui.displayDialogAsync(i,{height:s.height,width:s.width,displayInIframe:r.displayInIframe,hideTitle:!0},(function(e){e.status!==Office.AsyncResultStatus.Failed?(r.activity.sendStart({dialogType:t}),r.dialog=e.value,r.dialog.addEventHandler(Office.EventType.DialogMessageReceived,r.processDialogMessage),r.dialog.addEventHandler(Office.EventType.DialogEventReceived,r.processDialogEvent)):(r.activity.fail(a.in.Error,{dialogType:t},e.error),r.resolveDialogPromise(n))})),e.abrupt("return",new Promise((function(e){r.resolveDialog=e})));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"resolveDialogPromise",{configurable:!0,enumerable:!0,writable:!0,value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){r.resolveDialog&&r.resolveDialog(e)}))}),Object.defineProperty(this,"closeDialog",{configurable:!0,enumerable:!0,writable:!0,value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){r.dialog&&!e&&r.dialog.close(),r.resolveDialogPromise(t)}))}),Object.defineProperty(this,"messageChild",{configurable:!0,enumerable:!0,writable:!0,value:function(e){if(!r.dialog)throw new Error("Trying to send message while dialog is not yet created!");r.dialog.messageChild(JSON.stringify(e))}}),Object.defineProperty(this,"processDialogMessage",{configurable:!0,enumerable:!0,writable:!0,value:function(e){}}),Object.defineProperty(this,"processDialogEvent",{configurable:!0,enumerable:!0,writable:!0,value:function(e){}}),Object.defineProperty(this,"handleDialogButtonClick",{configurable:!0,enumerable:!0,writable:!0,value:function(e){}}),Object.defineProperty(this,"sendDialogProps",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=c(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"convertPixelToPercentage",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=window.screen.availHeight,t=window.screen.availWidth,n=100*r.height/e,i=100*r.width/t;return{height:Math.min(100,n),width:Math.min(90,i)}}}),this.height=e,this.width=t,this.displayInIframe=n,this.activity=new a.pX("FloatingDialog","User",[],!0)}},86709:function(e,t,n){var r,i,a,o;n.d(t,{Q4:function(){return r},rn:function(){return i},hK:function(){return a},zf:function(){return o}}),function(e){e[e.onRegisterMessageComplete=0]="onRegisterMessageComplete",e[e.onButtonClick=1]="onButtonClick"}(r||(r={})),function(e){e[e.consent=0]="consent",e[e.parameterized=1]="parameterized"}(i||(i={})),function(e){e[e.accept=0]="accept",e[e.deny=1]="deny",e[e.viewScript=2]="viewScript",e[e.close=3]="close"}(a||(a={})),function(e){e[e.accept=0]="accept",e[e.deny=1]="deny",e[e.viewScript=2]="viewScript",e[e.close=3]="close"}(o||(o={}))},56136:function(e,t,n){function r(){var e=window.location.pathname,t=e.slice(0,e.lastIndexOf("/"))+"/dialog.html";return window.location.origin+t}n.d(t,{c:function(){return r}})},97650:function(e,t,n){function r(e){return e.length>2?strings.substitute(strings.Dialog.ConsentLastModifiedBy3UsersAndMore,{firstUserName:e[0].lastModifiedByUserName,numberOfUsers:e.length-1}):2===e.length?strings.substitute(strings.Dialog.ConsentLastModifiedBy2Users,{firstUserName:e[0].lastModifiedByUserName,secondUserName:e[1].lastModifiedByUserName}):e[0].lastModifiedByUserName}n.d(t,{N:function(){return r}})},70546:function(e,t,n){n.d(t,{Z:function(){return o}});var r=n(88527);function i(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(e){i(o,r,a,s,c,"next",e)}function c(e){i(o,r,a,s,c,"throw",e)}s(void 0)}))}}function o(e){return s.apply(this,arguments)}function s(){return(s=a(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,r.S)(t));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},19100:function(e,t,n){n.d(t,{W:function(){return o}});var r=n(11899),i=n(58351);function a(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}var o=function(){function e(){Object.defineProperty(this,"outstandingToken",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"waitQueue",{configurable:!0,enumerable:!0,writable:!0,value:[]})}var t=e.prototype;return t.release=function(e){if((0,i.ve)({eventName:"MutexEvent",eventType:"System",data:{operationType:"Release"}}),e!==this.outstandingToken)throw new Error("Release attempted by non-owner");this.outstandingToken=void 0,this.processQueue()},t.processQueue=function(){if(this.waitQueue.length>0){var e=this.tryAcquire();if(e)this.waitQueue.shift().resolveFn(e)}},t.tryAcquire=function(){if((0,i.ve)({eventName:"MutexEvent",eventType:"System",data:{operationType:"TryAcquire",tokenExists:!!this.outstandingToken}}),!this.outstandingToken){var e=new s(this.release.bind(this));return this.outstandingToken=e,e}},t.waitFor=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Promise((function(e,n){t=new r.xJ(e,n),i.waitQueue.push(t)})),this.processQueue(),e.abrupt("return",n);case 3:case"end":return e.stop()}}),e,this)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){a(o,r,i,s,c,"next",e)}function c(e){a(o,r,i,s,c,"throw",e)}s(void 0)}))});return function(){return t.apply(this,arguments)}}(),e}(),s=function(){function e(e){Object.defineProperty(this,"relFn",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),this.relFn=e}return e.prototype.release=function(){this.relFn(this)},e}()},68495:function(e,t,n){function r(e){if(e){var t=e.storageScript.apiInfo;if(t)return JSON.parse(t)}}n.d(t,{v:function(){return r}})},59406:function(e,t,n){function r(e){if(e){var t=e.variantVersion;if(void 0!==t&&"number"===typeof(n=t)&&Number.isInteger(n)&&n>=0)return t}var n;return 0}n.d(t,{x:function(){return c}});var i=n(41435);function a(){return a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a.apply(this,arguments)}function o(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function s(e){o(a,r,i,s,c,"next",e)}function c(e){o(a,r,i,s,c,"throw",e)}s(void 0)}))}}function c(e){return u.apply(this,arguments)}function u(){return(u=s(regeneratorRuntime.mark((function e(t){var n,o,s,c,u,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r(t),o=n>=1,s=n>=1,c=n>=2,e.next=6,(0,i.C)();case 6:return u=e.sent,l=a({},{enableNoImplicitAny:o,enableNoIdentifiersPassedToArrayMethodCallbacks:s,enableNoImplicitAnyAssignment:c},u),e.abrupt("return",l);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},82143:function(e,t,n){n.d(t,{$:function(){return s}});var r=n(68495),i=n(59406);function a(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function o(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function s(e){a(o,r,i,s,c,"next",e)}function c(e){a(o,r,i,s,c,"throw",e)}s(void 0)}))}}function s(e){return c.apply(this,arguments)}function c(){return(c=o(regeneratorRuntime.mark((function e(t){var n,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(0,r.v)(t),a=(0,i.x)(n),e.abrupt("return",a);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},13753:function(e,t,n){n.d(t,{u:function(){return a}});var r=n(59408),i=n(65506);function a(e){return(0,i.Z)(e)?r.M.synchronous:r.M.batch}},65506:function(e,t,n){n.d(t,{Z:function(){return i}});var r=n(24753);function i(e){if(e){var t=e.storageScript.apiInfo;return!!t&&JSON.parse(t).variant===r.$}return!0}},92250:function(e,t,n){n.d(t,{vj:function(){return r},Z1:function(){return i},dA:function(){return l},Ls:function(){return p}});var r,i,a=n(8797),o=n(58351),s=n(54050);function c(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){c(a,r,i,o,s,"next",e)}function s(e){c(a,r,i,o,s,"throw",e)}o(void 0)}))}}function l(e,t){return d.apply(this,arguments)}function d(){return d=u(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,a.Z)()){e.next=3;break}return r=new o.pX("ShowOrHideBusinessBar","System"),e.abrupt("return",Excel.run({delayForCellEdit:!0},function(){var e=u(regeneratorRuntime.mark((function e(r){var i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.workbook.businessBar,(0,s.e8)()&&(a={shareId:n.scriptLink},n.scriptLink=JSON.stringify(a)),i.show(t,n),e.next=5,r.sync();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(){r.succeed(o.in.Information,{clickId:n.clickId,runStatus:n.runStatus,isHide:!1})})).catch((function(e){r.fail(o.in.Error,{clickId:n.clickId,runStatus:n.runStatus,isHide:!1},e)})));case 3:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}function p(e,t){return f.apply(this,arguments)}function f(){return f=u(regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(0,a.Z)()&&(r=new o.pX("ShowOrHideBusinessBar","System"),Excel.run(function(){var e=u(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.workbook.businessBar.hide(t,n),e.next=4,r.sync();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(){r.succeed(o.in.Information,{isHide:!0})})).catch((function(e){r.fail(o.in.ASHA,{isHide:!0},e)})));case 1:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}!function(e){e[e.officeScriptsRunningStatus=0]="officeScriptsRunningStatus"}(r||(r={})),function(e){e.preparing="preparing",e.running="running",e.succeeded="succeeded",e.fetchFailed="fetchFailed",e.runFailed="runFailed",e.canceled="canceled",e.alreadyRunning="alreadyRunning",e.initializing="initializing"}(i||(i={}))},89281:function(e,t,n){n.d(t,{k5:function(){return d},Gp:function(){return p},Ey:function(){return f},lw:function(){return g}});var r=n(12915),i=n(19588),a=n(85359),o=n(89991),s=n(75434),c=n(54050);function u(){return u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},u.apply(this,arguments)}function l(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}var d=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,n,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=(0,c.Jk)("Script"))){e.next=19;break}if(e.prev=2,(n=JSON.parse(t)).id){e.next=6;break}throw new Error("Object does not contain an 'id'.");case 6:if(!n.id.startsWith(r.Fb)){e.next=12;break}return e.next=9,(0,i.K)(n.id);case 9:return e.abrupt("return",e.sent);case 12:return s=(0,o.k)(n,{shareId:n.shareId}),e.abrupt("return",s);case 14:e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(2),new a.sH("Unable to parse initial active script",e.t0);case 19:return e.abrupt("return",void 0);case 20:case"end":return e.stop()}}),e,null,[[2,16]])})),function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){l(a,r,i,o,s,"next",e)}function s(e){l(a,r,i,o,s,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}(),p=function(){var e=(0,s.u8)();if(e)return e.recentScripts?e.recentScripts.map((function(e){return(0,o.k)(u({},e,{isCreator:!0}))})):void 0},f=function(){var e=(0,s.u8)();if(e)return e.publishedScripts?e.publishedScripts.map((function(e){return(0,o.k)(u({},e,{isCreator:!0}))})):void 0},g=function(){var e=(0,s.u8)();if(e)return e.workbookScripts?e.workbookScripts.map((function(e){return(0,o.k)(e)})):void 0}},48562:function(e,t,n){function r(e){return 500===e.httpStatusCode&&"Canceled"===e.message&&"GeneralException"===e.code}n.d(t,{s:function(){return r}})},81908:function(e,t,n){n.d(t,{S:function(){return x}});var r=n(99824),i=n(67207),a=n(57464),o=n(66052);function s(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){s(a,r,i,o,c,"next",e)}function c(e){s(a,r,i,o,c,"throw",e)}o(void 0)}))}}function u(){return l.apply(this,arguments)}function l(){return(l=c(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,o.S)("office.script.synchronous.library",(function(){return n.e(1239).then(n.bind(n,19708))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var d=n(8797),p=n(68495),f=n(59406),g=n(75434),h=n(54050),m=n(91493),v=n(58351),b=n(19100);function y(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function w(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){y(a,r,i,o,s,"next",e)}function s(e){y(a,r,i,o,s,"throw",e)}o(void 0)}))}}var S=(0,d.Z)()&&(0,h.Xf)()===Office.PlatformType.PC?"https://appsforoffice.microsoft.com/lib/beta/hosted/excel-win32-16.01.js":(0,d.Z)()&&(0,h.Xf)()===Office.PlatformType.Mac?"https://appsforoffice.microsoft.com/lib/beta/hosted/excel-mac-16.00.js":"https://appsforoffice.microsoft.com/lib/beta/hosted/excel-web-16.00.js",x=function(){function e(e,t){Object.defineProperty(this,"runtimeConsole",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"telemetryChannel",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"preloads",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mutex",{configurable:!0,enumerable:!0,writable:!0,value:new b.W}),this.runtimeConsole=e,this.telemetryChannel=t,this.preloads=new m.N}var t=e.prototype;return t.preloadRuntime=function(){var e=w(regeneratorRuntime.mark((function e(t,n){var r,i,a,o,s,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t={variant:"synchronous",variantVersion:2}),void 0===n&&(n=!0),r=new v.pX("PreloadRuntime","System"),i=this.getPreloads(t,n),e.prev=4,e.next=7,this.mutex.waitFor();case 7:return a=e.sent,o=this.createRuntime(t,n),i.push(o),e.next=12,o;case 12:return s=e.sent,r.succeed(v.in.Information,{id:s.getId()}),e.abrupt("return",s);case 17:throw e.prev=17,e.t0=e.catch(4),r.fail(v.in.Warning,{},e.t0),c=i.findIndex((function(e){return e===o})),i.splice(c,1),e.t0;case 23:return e.prev=23,null==(u=a)||u.release(),e.finish(23);case 26:case"end":return e.stop()}}),e,this,[[4,17,23,26]])})));return function(t,n){return e.apply(this,arguments)}}(),t.getPreloadCountFor=function(e,t){return void 0===e&&(e={variant:"synchronous",variantVersion:2}),void 0===t&&(t=!0),this.getPreloads(e,t).length},t.getRuntime=function(){var e=w(regeneratorRuntime.mark((function e(t){var n,r,i,o,s,c,u,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new v.pX("GetRuntime","System"),e.prev=1,e.next=4,this.mutex.waitFor();case 4:if(r=e.sent,i=(0,p.v)(t)){e.next=8;break}throw new Error("Attempting to get runtime for script with no apiInfo");case 8:return o=!(0,g.Sq)()&&!(0,a.$)(t),s=this.getPreloads(i,o),c=s.shift(),u=!!c,c||(c=this.createRuntime(i,o)),e.next=15,c;case 15:return l=e.sent,n.succeed(v.in.Information,{id:l.getId(),storageId:t.storageScript.id,usedPreload:u}),e.abrupt("return",l);case 20:throw e.prev=20,e.t0=e.catch(1),n.fail(v.in.Error,{storageId:t.storageScript.id},e.t0),e.t0;case 24:return e.prev=24,null==(d=r)||d.release(),e.finish(24);case 27:case"end":return e.stop()}}),e,this,[[1,20,24,27]])})));return function(t){return e.apply(this,arguments)}}(),t.loadCodeForRuntime=function(){var e=w(regeneratorRuntime.mark((function e(t,n){var r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u();case 2:return r=e.sent,i=n.codeOverride||r.officeScriptLibraryCode,e.next=6,t.loadCode(i);case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t.createRuntime=function(){var e=w(regeneratorRuntime.mark((function e(t,n){var a,o,s=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t={variant:"synchronous",variantVersion:2}),void 0===n&&(n=!0),e.next=4,(0,f.x)(t);case 4:return a=e.sent,o={officeJsUrl:a.officeJsOverride||S,runtimeConsole:this.runtimeConsole,allowExternalCalls:n,telemetryChannel:this.telemetryChannel,serviceUrl:(0,i.Oh)()},e.abrupt("return",r.lZ.createRuntimeInstance(o).then((function(e){return s.loadCodeForRuntime(e,a)})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}(),t.getPreloads=function(e,t){var n=JSON.stringify([e,t]);return this.preloads.keys().indexOf(n)<0&&this.preloads.create(n,[]),this.preloads.read(n)},e}()},8855:function(e,t,n){n.d(t,{d:function(){return r},K:function(){return i}});var r=[{id:"ReadWriteCurrentDocument",text:strings.Dialog.ConsentViewAndModifyScopeText,infoLink:"https://aka.ms/script-run-permissions"}];function i(){return r.map((function(e){return{text:e.text,ariaLabel:strings.substitute(strings.Dialog.ConsentViewScopeDetailAriaLabel,{scope:e.text}),infoLink:e.infoLink}}))}},83542:function(e,t,n){n.d(t,{jX:function(){return r},YL:function(){return i}});n(90828),n(20260),n(35826);var r=" \xbb ... \xbb Office Scripts";var i=function(e){return void 0!==e?e.map((function(e){return e.name})).join(" \u200f\xbb "):""}},5523:function(e,t,n){n.d(t,{L:function(){return f}});var r=n(71849),i=n(35826),a=n(90828),o=n(89991),s=n(82750),c=n(81066),u=n(52105);function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},l.apply(this,arguments)}function d(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){d(a,r,i,o,s,"next",e)}function s(e){d(a,r,i,o,s,"throw",e)}o(void 0)}))}}var f=function(){function e(e){var t=this;Object.defineProperty(this,"reduxStore",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"getRecentScripts",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=p(regeneratorRuntime.mark((function e(){var n,i,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.I.instance();case 3:return n=e.sent,e.next=6,n.getRecentScripts();case 6:return i=e.sent,d=i.map((function(e){return(0,o.k)(l({},e,{isCreator:!0}))})),(0,s.HQ)("EnableMRUExperience")&&c.X.instance().setMRUAndCheck(d),t.reduxStore.dispatch(a.N.scripts.fetchMRUMetadataFromStorage.success({scripts:d})),"Editor"===(0,u.L3)()&&t.reduxStore.dispatch(a.N.scripts.mruScriptMetadataReceived()),e.abrupt("return",i);case 14:return e.prev=14,e.t0=e.catch(0),e.abrupt("return",[]);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"getScripts",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=p(regeneratorRuntime.mark((function e(){var n,i,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.I.instance();case 3:return n=e.sent,e.next=6,n.getScripts();case 6:return i=e.sent,u=i.map((function(e){return(0,o.k)(l({},e,{isCreator:!0}))})),(0,s.HQ)("EnableMRUExperience")&&c.X.instance().setOneDriveAndCheck(u),t.reduxStore.dispatch(a.N.scripts.fetchMetadataFromStorage.success({scripts:u})),e.abrupt("return",i);case 13:return e.prev=13,e.t0=e.catch(0),e.abrupt("return",[]);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"getGraphScriptAndNavigate",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=p(regeneratorRuntime.mark((function e(n,i){var o,s,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.I.instance();case 2:if(o=e.sent,s=n+":"+i,!(c=o.indirectionCache.read(s))||!o.scriptCache.isCached({id:c})){e.next=10;break}return e.next=8,o.scriptCache.getValue({id:c});case 8:u=e.sent,o.scriptCache.forget({id:c});case 10:return u&&t.reduxStore.dispatch(a.N.editor.setActive({id:u.storageScript.id,forceRefetch:!1})),e.prev=11,e.next=14,o.getGraphScript(n,i);case 14:return u=e.sent,e.abrupt("return",u);case 18:throw e.prev=18,e.t0=e.catch(11),u&&g(e.t0)&&(e.t0.hasCached=!0,o.scriptCache.setValue({id:u.storageScript.id},u)),e.t0;case 22:case"end":return e.stop()}}),e,null,[[11,18]])})));return function(t,n){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"getScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=p(regeneratorRuntime.mark((function e(t,n){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===n&&(n=!1),e.next=3,r.I.instance();case 3:return i=e.sent,n&&i.scriptCache.isCached(t)&&i.scriptCache.forget(t),e.abrupt("return",i.getScript(t));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}),this.reduxStore=e}return e.getInstance=function(){var t=p(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e._somcInstance||(e._somcInstance=new e((0,i.v)())),t.abrupt("return",e._somcInstance);case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),e}();function g(e){return"object"===typeof e&&!Array.isArray(e)&&null!==e}Object.defineProperty(f,"_somcInstance",{configurable:!0,enumerable:!0,writable:!0,value:void 0})},38104:function(e,t,n){n.d(t,{E:function(){return l},R:function(){return p}});var r=n(71849),i=n(11899),a=n(42803),o=n(83542),s=n(58351),c=n(56222);function u(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}var l=function(){function e(e){Object.defineProperty(this,"cache",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"innerKey",{configurable:!0,enumerable:!0,writable:!0,value:function(e){return e.folderUrl+e.locale}}),this.cache=e}var t=e.prototype;return t.getCachedValue=function(e,t){var n=d(t.storageScript.fileUrl);if(n){var r={folderUrl:n,locale:e};return this.cache.read(this.innerKey(r))}},t.getBreadcrumb=function(){var e,t=(e=regeneratorRuntime.mark((function e(t,n){var o,c,u,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o=this.getCachedValue(t,n))){e.next=3;break}return e.abrupt("return",o);case 3:return e.next=5,r.I.instance();case 5:return e.next=7,e.sent.getRecentScripts();case 7:if(!(c=e.sent.find((function(e){return e.id===n.storageScript.id})))){e.next=10;break}return e.abrupt("return",this.addBreadcrumb(c,t));case 10:return e.next=12,a.c.instance();case 12:if(u=e.sent,l=[500,3e3],!n.storageScript.driveId){e.next=25;break}return e.prev=15,e.next=18,(0,i.hP)((function(){return u.getRecentScript(n.storageScript,n.storageScript.driveId)}),l);case 18:return d=e.sent,e.abrupt("return",this.addBreadcrumb(d,t));case 22:return e.prev=22,e.t0=e.catch(15),e.abrupt("return",p(n.storageScript));case 25:return(0,s.m)(new Error("script is missing driveId"),s.in.ASHA),e.abrupt("return",p(n.storageScript));case 27:case"end":return e.stop()}}),e,this,[[15,22]])})),function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){u(a,r,i,o,s,"next",e)}function s(e){u(a,r,i,o,s,"throw",e)}o(void 0)}))});return function(e,n){return t.apply(this,arguments)}}(),t.addBreadcrumb=function(e,t){var n=d(e.fileUrl);if(!e.path)return p(e);var r=(0,o.YL)(e.path);if(n){var i={folderUrl:n,locale:t};this.cache.write(this.innerKey(i),r)}return r},e}();Object.defineProperty(l,"_instance",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(l,"instance",{configurable:!0,enumerable:!0,writable:!0,value:function(){if(!l._instance){l._instance=new l(new c.sH("breadcrumbs",1e4,0,{compare:c.iQ,canPurge:function(){return!0}}))}return l._instance}});var d=function(e){if(e)return e.substring(0,e.lastIndexOf("/"))},p=function(e){var t=e.fileUrl;return t?decodeURI(t.substring(t.indexOf("//")+2,t.lastIndexOf("/")).replace(/\//g," \u200f\xbb ")):((0,s.m)(new Error("script is missing fileUrl"),s.in.ASHA),"")}},44444:function(e,t,n){n.d(t,{Gq:function(){return R},W9:function(){return x}});var r=n(26634),i=n(67796),a=n(72558),o=n(58679),s=n(83359),c=n(66052),u=n(58351),l=n(39711),d=n(84195),p=n(59013),f=n(22883),g=n(11899);function h(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}var m=function(){Object.defineProperty(this,"getAllVersionsOfScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new u.pX("GetAllScriptVersionsFromStorage","System",[{level:u.in.ASHA,timeout:u.NJ.UserUnsatisfied}]),e.prev=1,e.next=4,(0,l.$I)((function(e){return(0,d.ri)((0,p.c)(t),e)}),n,(0,g.or)(f.kH,f.H));case 4:return r=e.sent,n.succeed(u.in.Information,{storageId:t.storageScript.id,uniqueUsers:new Set(r.map((function(e){return e.lastModifiedByUser}))).size}),e.abrupt("return",r);case 9:throw e.prev=9,e.t0=e.catch(1),i=(0,f.kH)(e.t0)?u.in.Information:(0,f.mF)(e.t0)||(0,f.HZ)(e.t0)?u.in.Warning:u.in.Error,n.fail(i,{storageId:t.storageScript.id},e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[1,9]])})),function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){h(a,r,i,o,s,"next",e)}function s(e){h(a,r,i,o,s,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}()})};function v(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}var b=function(){};function y(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function w(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){y(a,r,i,o,s,"next",e)}function s(e){y(a,r,i,o,s,"throw",e)}o(void 0)}))}}Object.defineProperty(b,"_instance",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(b,"instance",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e,t=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!b._instance){e.next=2;break}return e.abrupt("return",b._instance);case 2:e.t0=(0,s.mi)(),e.next=e.t0===s.B1.makerserviceprodnew||e.t0===s.B1.makerserviceint||e.t0===s.B1.makerservicetest||e.t0===s.B1.makerservicelocal?5:e.t0===s.B1.localstorage?6:7;break;case 5:return e.abrupt("return",b._instance=new m);case 6:return e.abrupt("return",(0,c.S)("LocalStorageVersion",(function(){return n.e(5781).then(n.bind(n,26567))})).then((function(e){return b._instance=new e.LocalStorageVersion})));case 7:throw new Error(s.Qg);case 8:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){v(a,r,i,o,s,"next",e)}function s(e){v(a,r,i,o,s,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}()});var S={};function x(e){return k.apply(this,arguments)}function k(){return(k=w(regeneratorRuntime.mark((function e(t){var n,r,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(0,i.a)(t)){e.next=5;break}return n={versionId:"1.0",lastModifiedByUser:t.storageScript.creatorId,lastModifiedByUserName:t.storageScript.creatorDisplayName,lastModifiedByUserEmail:"",dateLastModified:t.storageScript.dateLastPublished},e.abrupt("return",[n]);case 5:if((0,a.J)(t)){e.next=7;break}return e.abrupt("return",[]);case 7:if(r=S[t.storageScript.id]){e.next=12;break}return s=new o.P(w(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.instance();case 2:return n=e.sent,e.abrupt("return",n.getAllVersionsOfScript(t));case 4:case"end":return e.stop()}}),e)})))),S[t.storageScript.id]=s,e.abrupt("return",s.promise());case 12:return e.abrupt("return",r.promise());case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function R(e){var t=S[e.storageScript.id];t&&t.forget(),r.T.instance().isCached(e)&&r.T.instance().forget(e)}},28041:function(e,t,n){n.d(t,{q:function(){return h}});var r=n(83359),i=n(66052),a=n(84195),o=n(58351),s=n(75434);function c(){return(0,s.N6)().ServerDocId+":"+(0,s.N6)().TenantId}var u=n(39711),l=n(8855);function d(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){d(a,r,i,o,s,"next",e)}function s(e){d(a,r,i,o,s,"throw",e)}o(void 0)}))}}var f=function(){var e=this;Object.defineProperty(this,"getConsent",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=p(regeneratorRuntime.mark((function e(t){var n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new o.pX("GetConsent","System"),e.prev=1,r=c(),e.next=5,(0,u.$I)((function(e){return(0,a.Q1)(t,r,e)}),n,(function(){return!1}));case 5:return i=e.sent,n.succeed(o.in.Information,{storageId:t,isConsented:!!i}),e.abrupt("return",i);case 10:throw e.prev=10,e.t0=e.catch(1),n.fail(o.in.ASHA,{storageId:t},e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"putConsent",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=p(regeneratorRuntime.mark((function e(t,n){var r,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new o.pX("PutConsent","User"),e.prev=1,i=c(),s={documentId:i,scriptId:t,scopes:l.d.map((function(e){return e.id})),userIds:n},e.next=6,(0,u.$I)((function(e){return(0,a.S7)(s,e)}),r,(function(){return!1}));case 6:r.succeed(o.in.Information,{storageId:t}),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(1),r.fail(o.in.ASHA,{storageId:t},e.t0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,n){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"deleteConsent",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=p(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new o.pX("DeleteConsent","User"),e.prev=1,e.next=4,(0,u.$I)((function(e){return(0,a.N1)(t,e)}),n,(function(){return!1}));case 4:n.succeed(o.in.Information,{storageId:t}),e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(1),n.fail(o.in.ASHA,{},e.t0),e.t0;case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"acceptConsentUsers",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=p(regeneratorRuntime.mark((function t(n,r){var i,a,o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getConsent(n);case 2:return i=t.sent,a=r.map((function(e){return e.lastModifiedByUser})),o=i?i.userIds.concat(a):a,t.next=7,e.putConsent(n,o);case 7:return t.abrupt("return");case 8:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}),Object.defineProperty(this,"denyConsent",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=p(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.deleteConsent(n.storageScript.id);case 2:return t.abrupt("return");case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}),Object.defineProperty(this,"getScriptConsentRecord",{configurable:!0,enumerable:!0,writable:!0,value:function(){var t=p(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.getConsent(n.storageScript.id);case 3:return t.abrupt("return",t.sent);case 6:return t.prev=6,t.t0=t.catch(0),t.abrupt("return",null);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}()})};function g(e,t,n,r,i,a,o){try{var s=e[a](o),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}var h=function(){};Object.defineProperty(h,"_instance",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(h,"instance",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e,t=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h._instance){e.next=7;break}e.t0=(0,r.mi)(),e.next=e.t0===r.B1.makerserviceprodnew||e.t0===r.B1.makerserviceint||e.t0===r.B1.makerservicetest||e.t0===r.B1.makerservicelocal?4:e.t0===r.B1.localstorage?5:6;break;case 4:return e.abrupt("return",h._instance=new f);case 5:return e.abrupt("return",(0,i.S)("LocalStorageConsent",(function(){return n.e(9889).then(n.bind(n,57662))})).then((function(e){return h._instance=new e.LocalStorageConsent})));case 6:throw new Error(r.Qg);case 7:return e.abrupt("return",h._instance);case 8:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function o(e){g(a,r,i,o,s,"next",e)}function s(e){g(a,r,i,o,s,"throw",e)}o(void 0)}))});return function(){return t.apply(this,arguments)}}()})},65086:function(e,t,n){function r(e){try{return JSON.parse(e)}catch(t){return}}n.d(t,{r:function(){return r}})},19885:function(e,t,n){function r(e){return e.filter((function(e,t,n){return n.findIndex((function(t){return t.lastModifiedByUser===e.lastModifiedByUser}))===t})).map((function(e){return{lastModifiedByUser:e.lastModifiedByUser,lastModifiedByUserName:e.lastModifiedByUserName,lastModifiedByUserEmail:e.lastModifiedByUserEmail}}))}n.d(t,{L:function(){return r}})},51361:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.RuntimeState=void 0,function(e){e.Loading="Loading",e.Ready="Ready",e.Executing="Executing",e.Done="Done",e.Error="Error"}(t.RuntimeState||(t.RuntimeState={}))},40239:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return i(t,e),t},o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},s=this&&this.__generator||function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(s){a=[6,s],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebRuntime=void 0;var c=n(46425),u=n(7527),l=n(51361),d=a(n(36030)),p=n(43344),f=function(){function e(e,t){if(this.runtimeConfiguration=t,this.metrics={runtimeCreatedTime:0,iframeLoadedTime:0,loadCodeTotalMilliseconds:0,loadCodeStartTime:0,executeStartTime:0,executeEndTime:0,syncStarted:0,totalSyncMilliseconds:0,syncsOutstanding:0,syncsPerformed:0},p.getIsIEBrowser()&&n(37511),this.metrics={runtimeCreatedTime:0,iframeLoadedTime:0,loadCodeStartTime:0,loadCodeTotalMilliseconds:0,executeStartTime:0,executeEndTime:0,syncStarted:0,syncsPerformed:0,syncsOutstanding:0,totalSyncMilliseconds:0},this.metrics.runtimeCreatedTime=Date.now(),this.state=l.RuntimeState.Loading,this.messageHandler=this.handleMessage.bind(this),window.addEventListener("message",this.messageHandler,!1),this.callbackList=new u.ObjectStore,this.id=e,this.sequenceId=0,this.origin=new URL(t.serviceUrl),this.origin.host=d.v4()+"."+this.origin.host,t&&!t.allowExternalCalls){var r=encodeURIComponent(btoa("'none'"));this.origin.searchParams.set("allowedSources",r)}this.runtimeConsole=null===t||void 0===t?void 0:t.runtimeConsole,this.telemetryChannel=(null===t||void 0===t?void 0:t.telemetryChannel)||function(){},this.iframe=document.createElement("iframe"),this.iframe.setAttribute("id",e),this.iframe.src=this.origin.href,this.iframe.style.display="none"}return e.createRuntimeInstance=function(t){return o(this,void 0,void 0,(function(){return s(this,(function(n){return[2,new Promise((function(n,r){var i=new e(d.default(),t);i.callbackList.create(++i.sequenceId,{resolve:n,reject:r}),i.iframe.onload=function(){i.metrics.iframeLoadedTime=Date.now();var e=[],n=null===t||void 0===t?void 0:t.officeJsUrl;if(void 0!==n){var r={name:"office.js",load:"url",value:n};e.push(r)}i.metrics.loadCodeStartTime=Date.now();var a={scriptId:i.id,runtimeId:i.id,sequenceId:i.sequenceId,eventType:"loadCode",libraries:e};i.iframe.contentWindow.postMessage(a,i.origin.href)},document.body.appendChild(i.iframe)}))]}))}))},e.prototype.getId=function(){return this.id},e.prototype.getState=function(){return this.state},e.prototype.getStats=function(){var e=this.state===l.RuntimeState.Done,t=this.metrics;return{runCompleted:e,iframeLoadMilliseconds:t.iframeLoadedTime-t.runtimeCreatedTime,codeLoadMilliseconds:t.loadCodeTotalMilliseconds,syncsPerformed:t.syncsPerformed,syncMilliseconds:t.totalSyncMilliseconds,executeMilliseconds:t.executeEndTime-t.executeStartTime}},e.prototype.loadCode=function(e){return o(this,void 0,void 0,(function(){var t=this;return s(this,(function(n){return this.setState(l.RuntimeState.Loading),[2,new Promise((function(n,r){t.callbackList.create(++t.sequenceId,{resolve:n,reject:r}),t.metrics.loadCodeStartTime=Date.now();var i={name:"library",load:"code",value:e},a={scriptId:t.id,runtimeId:t.id,sequenceId:t.sequenceId,eventType:"loadCode",libraries:[i]};t.iframe.contentWindow.postMessage(a,t.origin.href)}))]}))}))},e.prototype.executeFunction=function(e,t){return o(this,void 0,void 0,(function(){var n=this;return s(this,(function(r){return this.setState(l.RuntimeState.Executing),[2,new Promise((function(r,i){n.metrics.executeStartTime=Date.now(),n.metrics.syncsPerformed=0,n.metrics.totalSyncMilliseconds=0,n.metrics.syncsOutstanding=0,c.Assert.True(null!=n.iframe.parentNode,"invalid iframe, no parent node found"),c.Assert.True(null!=n.iframe.contentWindow,"invalid iframe, no content window found"),n.callbackList.create(++n.sequenceId,{resolve:r,reject:i});var a={scriptId:n.id,runtimeId:n.id,sequenceId:n.sequenceId,eventType:"execute",functionName:e,functionArgs:t};n.runtimeConfiguration.skipWrappingInRunFunction&&(a.skipWrappingInRunFunction=!0),n.iframe.contentWindow.postMessage(a,n.origin.href)}))]}))}))},e.prototype.handleMessage=function(e){if(0===this.origin.href.indexOf(e.origin)&&e.data.scriptId===this.id&&e.source===this.iframe.contentWindow){var t=e.data.eventType;"scriptCodeLoaded"===t&&this.handleMessageScriptCodeLoaded(e),"loadCodeComplete"===t&&this.handleMessageLoadCodeComplete(e),"executeComplete"!==t&&"executionFinished"!==t||this.handleMessageExecuteComplete(e),"officeJsMessage"===t&&this.handleMessageOfficeJsMessage(e),"consoleLog"===t&&this.handleMessageConsoleLog(e),"telemetry"===t&&this.handleMessageTelemetry(e)}},e.prototype.handleMessageScriptCodeLoaded=function(e){this.metrics.loadCodeTotalMilliseconds=Date.now()-this.metrics.loadCodeStartTime,this.metrics.loadCodeStartTime=0,this.setState(l.RuntimeState.Ready),this.handlePromiseResolving(e,this)},e.prototype.handleMessageLoadCodeComplete=function(e){this.metrics.loadCodeTotalMilliseconds=Date.now()-this.metrics.loadCodeStartTime,this.metrics.loadCodeStartTime=0,this.setState(l.RuntimeState.Ready),this.handlePromiseResolving(e,this)},e.prototype.handleMessageExecuteComplete=function(e){this.metrics.executeEndTime=Date.now(),this.setState(l.RuntimeState.Done),this.handlePromiseResolving(e,e.data.message.result)},e.prototype.handleMessageOfficeJsMessage=function(e){var t=this;0===this.metrics.syncsOutstanding&&(this.metrics.syncStarted=Date.now()),this.metrics.syncsOutstanding++;var n=e.data;this.runtimeConfiguration&&this.runtimeConfiguration.ignoreMakerSafe||(n.message[6]|=1024),OSF.DDA.RichApi.executeRichApiRequestAsync(n.message,(function(r){if(t.metrics.syncsPerformed++,t.metrics.syncsOutstanding--,0===t.metrics.syncsOutstanding&&(t.metrics.totalSyncMilliseconds+=Date.now()-t.metrics.syncStarted),t.iframe.parentNode&&t.iframe.contentWindow){var i={scriptId:n.scriptId,runtimeId:n.runtimeId,eventType:"officeJsMessageResponse",sequenceId:n.sequenceId,result:r};t.iframe.contentWindow.postMessage(i,e.origin)}else t.completeAllPromises()}))},e.prototype.handleMessageConsoleLog=function(e){var t=e.data;this.runtimeConsole&&this.runtimeConsole[t.logType](t.scriptId,t.consoleArgs)},e.prototype.handleMessageTelemetry=function(e){var t=e.data,n={runtimeId:this.id,success:t.success,eventName:t.eventName,data:t.data};this.telemetryChannel(n)},e.prototype.handlePromiseResolving=function(e,t){var n=e.data,r=this.callbackList.read(n.sequenceId);this.callbackList.delete(n.sequenceId),"Success"===n.message.status?r.resolve(t):(this.setState(l.RuntimeState.Error),r.reject(e))},e.prototype.terminate=function(){return o(this,void 0,void 0,(function(){return s(this,(function(e){return this.completeAllPromises(),this.metrics.executeEndTime=Date.now(),window.removeEventListener("message",this.messageHandler),this.iframe.parentNode&&this.iframe.parentNode.removeChild(this.iframe),[2]}))}))},e.prototype.completeAllPromises=function(){var e=this;this.callbackList.keys().forEach((function(t){var n=e.callbackList.read(t);e.callbackList.delete(t),n.resolve(!1)}))},e.prototype.setState=function(e){var t=new Map([[l.RuntimeState.Ready,[l.RuntimeState.Loading,l.RuntimeState.Executing,l.RuntimeState.Error]],[l.RuntimeState.Executing,[l.RuntimeState.Done,l.RuntimeState.Error]],[l.RuntimeState.Loading,[l.RuntimeState.Ready,l.RuntimeState.Error]],[l.RuntimeState.Done,[l.RuntimeState.Error]],[l.RuntimeState.Error,[l.RuntimeState.Error]]]).get(this.state)||[];c.Assert.True(t.includes(e),"Runtime state ["+this.state+"] may not transition to state ["+e+"]"),this.state=e},e}();t.WebRuntime=f},99824:function(e,t,n){t.lZ=t.tu=void 0;var r=n(51361);Object.defineProperty(t,"tu",{enumerable:!0,get:function(){return r.RuntimeState}});var i=n(40239);Object.defineProperty(t,"lZ",{enumerable:!0,get:function(){return i.WebRuntime}})},46425:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Assert=void 0;var n=function(){function e(){}return e.Equals=function(e,t){if(e!==t)throw new Error(JSON.stringify(e)+" does not match expected "+JSON.stringify(t))},e.True=function(e,t){if(!e)throw new Error("Bad program state. "+(t||""))},e}();t.Assert=n},43344:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getIsIEBrowser=void 0,t.getIsIEBrowser=function(){return/MSIE|Trident/.test(window.navigator.userAgent)}},7527:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectStore=void 0;var n=function(){function e(){this.store={}}return e.prototype.create=function(e,t){return!this.store[e]&&(this.store[e]=t,!0)},e.prototype.read=function(e){if(void 0!==this.store[e])return this.store[e];throw new Error("No such item: "+JSON.stringify(e))},e.prototype.keyExists=function(e){return void 0!==this.store[e]},e.prototype.delete=function(e){var t=!!this.store[e];return delete this.store[e],t},e.prototype.keys=function(){return Object.keys(this.store)},e}();t.ObjectStore=n},87004:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.code=void 0;var r=n(40149);t.code=r.code}}]);
//# sourceMappingURL=9744.7e7ea398.chunk.js.map