"use strict";(self.webpackChunkmaker_code_editor=self.webpackChunkmaker_code_editor||[]).push([[1875],{57710:function(e,t,n){n.r(t),n.d(t,{default:function(){return dt},showAuthDialog:function(){return mt}});var r=n(21914),i=n(39747),a=n(45752),s={runFromButton:a.wG,authDialog:a.OT,dialog:a.WZ,misc:a.ai,run:a.KH,consentDialog:a.fw,scripts:a.v1,bottomPanel:a.j_},o=n(25509),c={runFromButton:o.wG,run:o.KH,editor:o.j6,consentDialog:o.fw,scripts:o.v1,bottomPanel:o.j_},u=n(81343),l=n(40106),p=n(78095),m=n(6503),d=n(13732),g=n(89311),f=n(94232),h=n(50578),v=n(9180),S=n(2015),x=n(9580),b=n(24637),k=n(24654),w=n(90828),R=n(22883),P=n(80228),y=n(64295),B=n(58351),E=n(44444),T=n(46201),F=n(17317),I=function(){Object.defineProperty(this,"item",{configurable:!0,enumerable:!0,writable:!0,value:void 0})},C=function(){var e=this;Object.defineProperty(this,"holder",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setRunnable",{configurable:!0,enumerable:!0,writable:!0,value:function(t){e.holder.item=t}}),Object.defineProperty(this,"getRunnable",{configurable:!0,enumerable:!0,writable:!0,value:function(){return e.holder.item}}),this.holder=new I};Object.defineProperty(C,"_instance",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(C,"instance",{configurable:!0,enumerable:!0,writable:!0,value:function(){return C._instance||(C._instance=new C),C._instance}});var Z=n(2898),L=n(92250),O=n(52105),_=n(75434),N=n(82750),j=n(71849),M=regeneratorRuntime.mark(D),z=regeneratorRuntime.mark(W),G=regeneratorRuntime.mark(H),A=regeneratorRuntime.mark(U);function D(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,b.ib)((0,k.getType)(a.wG.attemptToRunScriptFromLink),W);case 2:return e.next=4,(0,b.Fm)((0,k.getType)(a.wG.viewScript),H);case 4:case"end":return e.stop()}}),M)}function W(e){var t,n,r,i,s,o,c,u,l,p,m;return regeneratorRuntime.wrap((function(d){for(;;)switch(d.prev=d.next){case 0:return t=new B.pX("RunFromButton","System"),n=e.payload,r=n.shareId,i=n.clickId,d.next=4,(0,b.Ys)(w.w.run.getIsRunning);case 4:if(!d.sent){d.next=9;break}t.fail(B.in.Warning,{clickId:i},new Error("Another script is already running.")),d.next=56;break;case 9:if(!r){d.next=55;break}return Z.L.instance().ensurePreload(),d.next=13,(0,b.RE)(U);case 13:if(d.prev=13,!(0,N.HQ)("ScriptOM")){d.next=23;break}return d.next=17,(0,b.RE)(j.I.instance);case 17:return o=d.sent,d.next=20,(0,b.RE)(o.getSharedScript,r,i);case 20:s=d.sent,d.next=29;break;case 23:return d.next=25,(0,b.RE)(P.X.instance);case 25:return c=d.sent,d.next=28,(0,b.RE)(c.getSharedScript,r,i);case 28:s=d.sent;case 29:if(!s){d.next=40;break}return d.next=32,(0,b.gz)(a.v1.update(s));case 32:return d.next=34,(0,b.gz)(a.wG.setActiveScript({script:s}));case 34:(0,E.Gq)(s),(0,E.W9)(s).catch((function(){})),F.x&&(u=new T.Lc("lastPublished","RunFromButton",i),C.instance().setRunnable(u)),(l=C.instance().getRunnable())&&l.run().then((function(){Z.L.instance().releaseMutexToken()})).catch((function(){Z.L.instance().releaseMutexToken()})),t.succeed(B.in.Information,{clickId:i,startTimeMs:t.createdTime,storageId:s.storageScript.id});case 40:d.next=53;break;case 42:return d.prev=42,d.t0=d.catch(13),(p=C.instance().getRunnable())&&(p.cancel(),Z.L.instance().releaseMutexToken()),m=(0,R.IG)(d.t0)?strings.Message.FailedToOpenUnsharedScriptMessage:strings.Message.FailedToOpenSharedScriptMessage,t.fail(B.in.ASHA,{clickId:i},d.t0),d.next=50,(0,b.gz)(a.wG.setFetchErrorText({text:m}));case 50:if("RunFromButton"!==(0,O.L3)()||!(0,_.jN)("TaskpanelessRFB")){d.next=53;break}return d.next=53,(0,b.RE)(L.dA,L.vj.officeScriptsRunningStatus,{runStatus:L.Z1.fetchFailed,clickId:i,scriptLink:r});case 53:d.next=56;break;case 55:t.fail(B.in.Error,{clickId:i},new Error("ShareId was not present"));case 56:case"end":return d.stop()}}),z,null,[[13,42]])}function H(e){var t,n,r,i,s,o;return regeneratorRuntime.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(t=e.payload,n=t.shareId,r=t.clickId,!n){c.next=23;break}return c.next=4,(0,b.RE)(U);case 4:return c.prev=4,c.next=7,(0,b.RE)(P.X.instance);case 7:return i=c.sent,c.next=10,(0,b.RE)(i.getSharedScript,n,r);case 10:if(!(s=c.sent)){c.next=17;break}return c.next=14,(0,b.gz)(a.wG.setActiveScript({script:s}));case 14:return c.next=16,(0,b.RE)(Office.addin.hide);case 16:(0,y.Z)(s);case 17:c.next=23;break;case 19:c.prev=19,c.t0=c.catch(4),o=(0,R.IG)(c.t0)?strings.Message.FailedToOpenUnsharedScriptMessage:strings.Message.FailedToOpenSharedScriptMessage,logger.error("[OfficeScripts:RFB]",o);case 23:case"end":return c.stop()}}),G,null,[[4,19]])}function U(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,b.gz)(a.wG.setActiveScript({script:null}));case 2:return e.next=4,(0,b.gz)(a.wG.setFetchErrorText({text:null}));case 4:return e.next=6,(0,b.gz)(a.fw.hide());case 6:return e.next=8,(0,b.gz)(a.KH.clearPreviousRun());case 8:return e.next=10,(0,b.gz)(a.j_.hide());case 10:case"end":return e.stop()}}),A)}var V=n(13683),X=n(38843),K=regeneratorRuntime.mark($);function $(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,b.$6)([D(),(0,V.Z)(),(0,X.ZP)()]);case 2:case"end":return e.stop()}}),K)}var q=n(43067),Q=(0,i.$j)((function(e){return{dialogProps:e.dialog}}),(function(e){return{dispatch:e,dismiss:function(){return e(s.dialog.dismiss())}}}))(q.Z),J=n(6974),Y=n(99627),ee=n(84586),te=n(28722),ne=n(76293),re=(0,i.$j)((function(e){return{isOpen:c.consentDialog.getIsVisible(e),script:c.runFromButton.getActiveScript(e)}}),(function(e){return{dispatch:e,hideConsentDialog:function(){return e(s.consentDialog.hide())},viewScript:function(e){(0,y.Z)(e)}}}))(ne.ZP),ie=n(87913),ae=n(47387),se=n(44696),oe=n(40608),ce=n(21830),ue=n(60146),le=n(18639),pe=n(49225),me=n(26460),de=n(57776),ge=n(14979),fe=n(32641),he=n(81066),ve=n(57464),Se=n(98425);function xe(){return xe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},xe.apply(this,arguments)}var be,ke=(0,ee.Zz)((function(e){var t=e.theme,n=e.script,i=e.showSpinner,a=void 0!==i&&i,s=null==n?void 0:n.storageScript.creatorDisplayName,o=strings.substitute(strings.Backstage.ScriptItemUserOwnedOneDriveRootFolderText,{creator:s||""}),c=n?n.storageScript.name:"",u=he.X.instance().isTeamOwnershipUXEnabled();return r.createElement(r.Fragment,null,n&&r.createElement(me.z,{styles:(0,pe.Qf)(t,!1),"data-testid":(0,ue.k)("RunFromButtonScriptCard"),onClick:function(){(0,y.Z)(n)}},r.createElement(we,null,r.createElement(Re,null,a?r.createElement(ie.$,{size:ae.E.large,styles:(0,pe.H_)(ae.E.large,t),"data-testid":(0,ue.k)("RunFromButtonRunSpinner")}):r.createElement(de.J,{styles:Be(),iconName:"OfficeScriptsSharedIcon32"})),r.createElement(Pe,null,r.createElement(ge._,{styles:ye(t,600,t.fontSizes.medium)},c),u||(0,ve.$)(n)?r.createElement(Se.Z,{script:n,isPointerCursor:!1,scriptHasUnsavedChanges:!1,shouldSplit:u}):r.createElement(fe.Z,{rootFolder:o,isPointerCursor:!0,showSubFolder:!1})))))})),we=ee.ZP.div.withConfig({displayName:"SimpleScriptDocumentCard__TextAndIconWrapper",componentId:"im7kk8-0"})(["display:flex;padding:",";"],(function(e){return e.theme.spacing.small})),Re=ee.ZP.div.withConfig({displayName:"SimpleScriptDocumentCard__IconWrapper",componentId:"im7kk8-1"})(["display:flex;align-items:center;padding:",";"],(function(e){return(0,ce.zg)()?"0 "+e.theme.spacing.xSmall+" 0 "+e.theme.spacing.medium:"0 "+e.theme.spacing.medium+" 0 "+e.theme.spacing.xSmall})),Pe=ee.ZP.div.withConfig({displayName:"SimpleScriptDocumentCard__ScriptInfoWrapper",componentId:"im7kk8-2"})(["width:calc(100% - 60px);display:flex;flex-direction:column;"]),ye=function(e,t,n){return xe({},(0,pe.xm)(e,t,n),{root:{cursor:"pointer"}})},Be=function(){return{root:{display:"flex"}}},Ee=(0,ee.Zz)((function(e){var t=e.theme,n=e.isErrorState,i=e.messageText,a=n?"Warning20":"CompleteIcon",s=n?"bold":"normal";return r.createElement(r.Fragment,null,i&&r.createElement(Te,{isErrorState:n},r.createElement(Fe,null,r.createElement(de.J,{styles:Ie(),iconName:a})),r.createElement(ge._,{styles:(0,pe.xm)(t,s,t.fontSizes.small),"data-testid":(0,ue.k)("RunFromButtonRunStatusText")},i)))})),Te=ee.ZP.div.withConfig({displayName:"StaticMessageBar__SimpleMessageBar",componentId:"dle4s2-0"})(["display:flex;background-color:",";margin:",";padding:",";"],(function(e){return e.isErrorState?e.theme.colors.warning:e.theme.colors.success}),(function(e){return e.theme.spacing.small+" "+e.theme.spacing.small+" "+e.theme.spacing.medium+" 0"}),(function(e){return e.theme.spacing.xSmall})),Fe=ee.ZP.div.withConfig({displayName:"StaticMessageBar__IconWrapper",componentId:"dle4s2-1"})(["display:flex;align-items:center;padding:",";"],(function(e){return(0,ce.zg)()?"0 "+e.theme.spacing.xSmall+" 0 "+e.theme.spacing.medium:"0 "+e.theme.spacing.medium+" 0 "+e.theme.spacing.xSmall})),Ie=function(){return{root:{display:"flex"}}},Ce=(0,ee.Zz)((function(e){var t=e.theme,n=e.script,i=e.isErrorState,a=e.messageText,s=e.helpLink,o=e.helpLinkText,c=e.primaryButtonText,u=e.primaryButtonAction,l=e.showSpinner,p=void 0!==l&&l;return r.createElement(Ze,null,r.createElement(Ee,{isErrorState:i,messageText:a}),r.createElement(ke,{script:n,showSpinner:p}),s&&r.createElement(Le,null,r.createElement(se.r,{href:s,target:"_blank",styles:(0,pe.Ti)(t)},o)),r.createElement(Oe,null,u&&r.createElement(_e,{"data-testid":(0,ue.k)("RunFromButtonPrimaryButton")},r.createElement(oe.Z,{text:c,ariaLabel:c,onClick:function(){u()},primary:!0}))))})),Ze=ee.ZP.div.withConfig({displayName:"RunStatusSection__RunningStatusWrapper",componentId:"sc-1gvoq5l-0"})(["display:flex;padding:"," ",";justify-content:flex-start;flex-direction:column;width:100%;height:100%;"],(function(e){return(0,le._)()?"6px":e.theme.spacing.mediumPlus}),(function(e){return e.theme.spacing.medium})),Le=ee.ZP.div.withConfig({displayName:"RunStatusSection__LinkWrapper",componentId:"sc-1gvoq5l-1"})(["padding-top:",";font-size:",";"],(function(e){return e.theme.spacing.small}),(function(e){return e.theme.fontSizes.small})),Oe=ee.ZP.div.withConfig({displayName:"RunStatusSection__ButtonGroupWrapper",componentId:"sc-1gvoq5l-2"})(["display:flex;justify-content:flex-end;padding-top:",";"],(function(e){return e.theme.spacing.mediumPlus})),_e=ee.ZP.div.withConfig({displayName:"RunStatusSection__ButtonWrapper",componentId:"sc-1gvoq5l-3"})(["padding:",";"],(function(e){return(0,ce.zg)()?"0 "+e.theme.spacing.small+" 0 0":"0 0 0 "+e.theme.spacing.small})),Ne=n(30747),je=n(21849),Me=n(88061);!function(e){e.Output="Output"}(be||(be={}));var ze=function(e){var t,n=e.outputLogs,i=e.currentPivotKey,a=e.setCurrentPivotKey,s=e.shouldFocusBottomPanel,o=e.setShouldFocusBottomPanel,c=e.hide,u=[{key:be.Output,testId:(0,ue.k)("BottomPanelOutputPivot"),text:strings.Editor.OutputTabLabel,ariaLabel:strings.Editor.OutputTabLabel,itemCount:n.length}],l=((t={})[be.Output]=r.createElement(je.Z,{"data-testid":(0,ue.k)("BottomPanelOutputPanel"),logs:n}),t);return r.createElement(Me.ZP,{pivotBarItems:u,pivotPages:l,currentPivotKey:i,shouldFocusBottomPanel:s,setShouldFocusBottomPanel:o,hideBottomPanel:c,setCurrentPivotKey:a,allowClose:!1,allowMinimize:!0})},Ge=(0,i.$j)((function(e){return{outputLogs:c.bottomPanel.getOutputLogs(e),currentPivotKey:c.bottomPanel.getCurrentPivot(e)}}),{hide:s.bottomPanel.hide,setCurrentPivotKey:s.bottomPanel.setCurrentPivot})(ze),Ae=n(31985),De=n(20260),We=n(54050);var He=function(e,t,n){var r=e.storageScript.creatorEmail,i=null!=t?t:"["+strings.RunFromButton.ContactOwnerDocumentUrlInstructionsText+"]",a=n.length>0?n.map((function(e){return e.message})).join("\n"):"["+strings.RunFromButton.ContactOwnerMailToOutputLogsInstructionsText+"]";return"mailto:"+r+"?subject="+window.encodeURIComponent(strings.substitute(strings.RunFromButton.ContactOwnerMailToSubjectText,{scriptName:e.storageScript.name}))+"&body="+window.encodeURIComponent(strings.substitute(strings.RunFromButton.ContactOwnerMailToBodyText,{scriptName:e.storageScript.name,documentLink:i,prettyLogs:a}))},Ue=(0,ee.Zz)((function(e){var t,n,i,a,s=(0,r.useState)(!1),o=s[0],c=s[1],u=function(){if(e.script&&Z.L.instance().acquireMutexToken()){var t=C.instance().getRunnable(),n=new T.Lc("lastPublished","RunFromButton",null==t?void 0:t.clickId,null==t?void 0:t.buttonText);C.instance().setRunnable(n),n.run().then((function(){Z.L.instance().releaseMutexToken()})).catch((function(){Z.L.instance().releaseMutexToken()}))}},l=function(){e.script&&((0,B.ve)({eventName:"ContactOwner",eventType:"User"}),window.open(He(e.script,(0,We.uF)(),e.outputLogs),"_blank"))},p=e.script?e.script.storageScript.name:"",m=e.isViewingScript?!e.script:!e.fetchErrorText&&"None"===e.runningStatus&&!e.isViewingScript,d="",g=!0;return e.fetchErrorText?d=e.fetchErrorText:e.isViewingScript?(g=!1,t="https://go.microsoft.com/fwlink/p/?LinkId=2135335",n=strings.RunFromButton.LearnMoreDocsLink):"InProgress"===e.runningStatus?(i=strings.General.StopButtonText,a=function(){var e=C.instance().getRunnable();e&&e.cancel()}):"Succeeded"===e.runningStatus?(d=strings.substitute(strings.RunFromButton.ScriptRanSuccessfullyText,{scriptName:p}),g=!1,t="https://go.microsoft.com/fwlink/p/?LinkId=2135335",n=strings.RunFromButton.LearnMoreDocsLink,e.outputLogs.length>0&&(i=strings.General.ViewLogs,a=function(){e.setBottomPanelPivot(Ne.Fh.Output),e.showBottomPanel()})):"Failed"===e.runningStatus?(d=strings.substitute(strings.RunFromButton.ScriptRanWithErrorsText,{scriptName:p}),t="https://go.microsoft.com/fwlink/p/?LinkId=2166138",n=strings.RunFromButton.TroubleshootingDocsLink,e.script&&(0,De.C)(e.script)||(i=strings.RunFromButton.ContactOwnerButtonText,a=l)):"Unsupported"===e.runningStatus?(d=strings.RunFromButton.ScriptContainsUnsupportedAPIs,t="https://go.microsoft.com/fwlink/p/?LinkId=2166138",n=strings.RunFromButton.TroubleshootingDocsLink,e.script&&(0,De.C)(e.script)||(i=strings.RunFromButton.ContactOwnerButtonText,a=l)):"Canceled"===e.runningStatus?(d=strings.substitute(strings.RunFromButton.ScriptCanceledText,{scriptName:p}),i=strings.RunFromButton.RunScriptButtonText,a=u):"ConsentDenied"===e.runningStatus&&(d=strings.substitute(strings.RunFromButton.ScriptConsentDeniedText,{scriptName:p}),i=strings.RunFromButton.ConsentAndRunScriptButtonText,a=u),m?r.createElement(Ve,null,r.createElement(Xe,null,r.createElement(ie.$,{size:ae.E.large,styles:(0,pe.H_)(ae.E.large,e.theme)})),r.createElement(Ke,null,strings.RunFromButton.LoadingScriptText)):r.createElement(r.Fragment,null,r.createElement(Ce,{script:e.script,isErrorState:g,messageText:d,helpLink:t,helpLinkText:n,primaryButtonText:i,primaryButtonAction:a,showSpinner:"InProgress"===e.runningStatus}),r.createElement(Ae.Z,{when:e.isBottomPanelVisible},r.createElement(Ge,{shouldFocusBottomPanel:o,setShouldFocusBottomPanel:function(e){return c(e)}})))})),Ve=ee.ZP.div.withConfig({displayName:"RunningStatusPage__LoadingIndicatorWrapper",componentId:"wz5jb9-0"})(["height:100%;width:100%;display:flex;align-items:center;justify-content:center;flex-direction:column;"]),Xe=ee.ZP.div.withConfig({displayName:"RunningStatusPage__SpinnerWrapper",componentId:"wz5jb9-1"})(["position:absolute;"]),Ke=ee.ZP.div.withConfig({displayName:"RunningStatusPage__TextWrapper",componentId:"wz5jb9-2"})(["position:absolute;padding-top:",";"],(function(e){return""+e.theme.spacing.superLarge})),$e=n(3033),qe=(0,i.$j)((function(e){return{script:c.runFromButton.getActiveScript(e),runningStatus:c.run.getRunningStatus(e),isBottomPanelVisible:c.bottomPanel.getIsVisible(e),fetchErrorText:c.runFromButton.getFetchErrorText(e),outputLogs:c.bottomPanel.getOutputLogs(e),isViewingScript:c.runFromButton.getIsViewingScript(e)}}),{showBottomPanel:s.bottomPanel.show,setBottomPanelPivot:s.bottomPanel.setCurrentPivot})((function(e){return(0,te.hf)(),r.createElement(r.Fragment,null,r.createElement(Qe,null,r.createElement(re,null),r.createElement(Ue,{script:e.script,isBottomPanelVisible:e.isBottomPanelVisible,runningStatus:e.runningStatus,fetchErrorText:e.fetchErrorText,outputLogs:e.outputLogs,showBottomPanel:e.showBottomPanel,setBottomPanelPivot:e.setBottomPanelPivot,isViewingScript:e.isViewingScript})),r.createElement($e.Z,null))})),Qe=ee.ZP.div.withConfig({displayName:"RunFromButtonMain__Wrapper",componentId:"sc-1u7kaeu-0"})(["display:flex;height:100%;width:100%;"]),Je=n(4100),Ye=n(4283),et=n(68598),tt=n(39711),nt=n(27946),rt=n(83359),it=n(96228),at=n(57222);function st(){F.x||Office.addin.showAsTaskpane()}var ot=n(35826),ct=n(24287),ut=n(98320);function lt(e,t,n,r,i,a,s){try{var o=e[a](s),c=o.value}catch(u){return void n(u)}o.done?t(c):Promise.resolve(c).then(r,i)}function pt(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function s(e){lt(a,r,i,s,o,"next",e)}function o(e){lt(a,r,i,s,o,"throw",e)}s(void 0)}))}}var mt=function(e,t){return new Promise((function(n,r){nt.d.store.dispatch(s.authDialog.show({acceptFn:function(){J.F.getAccessTokenInternal(e,t,!0).then(n).catch(r)},cancelFn:r}))}))},dt=function(){var e=(0,r.useState)(nt.d.store),t=e[0],n=e[1],a=(0,r.useState)(!1),o=a[0],c=a[1];return(0,r.useEffect)((function(){if(!nt.d.store&&o){var e=F.x&&window.initialState;nt.d.store=(0,u.Z)({initialState:e,rootReducer:(0,p.UY)({runFromButton:m.Z,authDialog:d.Z,dialog:g.Z,run:f.Z,editor:h.Z,consentDialog:v.Z,scripts:S.ZP,bottomPanel:x.Z}),rootSaga:$}),Y.if.putFallbackFn(mt),nt.d.store.dispatch(s.misc.initialize()),F.x&&(window.store=nt.d.store),n(nt.d.store),(0,N.HQ)("Win32AdminCheck")?function(){gt.apply(this,arguments)}():(Ye.Z.register(Je.GN,xt),Ye.Z.register(Je.jy,St),Ye.Z.register(Je.Ln,ft),Ye.Z.register(Je.lg,ht),Ye.Z.register(Je.Wh,vt)),(0,B.bK)()}}),[o]),(0,r.useEffect)((function(){o||Ye.Z.register(Je.RQ,(function(e){!function(e,t){var n=e.wacFlights,r=e.invocationContext,i=e.documentHostInfo,a=e.storageModePreference,s=e.taskpaneWidth,o=e.blockExternalCalls,c=e.headerCssClass,u=e.titleCssClass,l=e.clickId,p=e.ring,m=new B.pX("InitializeActionHandler","System");(0,We.GX)("wacFlights",n),(0,We.GX)("invocationContext",r),(0,We.GX)("DocumentHostInfo",i),(0,We.GX)("StorageModePreference",a),(0,We.GX)("blockExternalCalls",o),(0,We.GX)("taskpaneWidth",s),(0,We.GX)("headerCssClass",c),(0,We.GX)("titleCssClass",u),(0,We.GX)("clickId",l),(0,We.GX)("ring",p),(0,rt.bn)(),(0,et.b)()||(0,tt.Jt)(m.id);it.D.instance().forceRefresh(),(0,N.HQ)("Win32AdminCheck")?(0,ct.a)().then((function(){d()})):d();function d(){t(!0),(0,B.Qm)(),(0,We.c$)((function(e){var t="Hidden"===e.visibilityMode;if(t){var n=C.instance().getRunnable();n&&n.cancel(),at.t.instance().resolveDialogPromise(!1)}(0,B.ve)({eventName:"TaskpaneVisibilityChanged",eventType:"User",data:{hidden:t}})})),m.succeed(B.in.Information,{})}}(e,c)})),F.x&&Ye.Z.add({key:Je.RQ,value:{taskpaneWidth:"360"}})}),[]),t?r.createElement(i.zt,{store:t},r.createElement(r.Fragment,null,r.createElement(l.Z,null,r.createElement(qe,null)),r.createElement(Q,null))):null};function gt(){return(gt=pt(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((0,We.Xf)()!==Office.PlatformType.PC){e.next=11;break}return e.next=3,(0,ut.K)();case 3:if(e.sent){e.next=11;break}return Ye.Z.register(Je.GN,st),Ye.Z.register(Je.jy,st),Ye.Z.register(Je.Ln,ft),Ye.Z.register(Je.lg,ht),Ye.Z.register(Je.Wh,vt),e.abrupt("return");case 11:Ye.Z.register(Je.GN,xt),Ye.Z.register(Je.jy,St),Ye.Z.register(Je.Ln,ft),Ye.Z.register(Je.lg,ht),Ye.Z.register(Je.Wh,vt);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ft(e){(0,B.ve)({eventName:"BusinessBarActionHandler",eventType:"User",data:{clickId:e.clickId,actionName:Je.Ln}}),Office.addin.showAsTaskpane()}function ht(e){var t=C.instance().getRunnable(),n=t?t.getCurrentScript():void 0;n&&window.open(He(n,(0,We.uF)(),w.w.bottomPanel.getOutputLogs((0,ot.v)().getState())),"_blank"),(0,B.ve)({eventName:"BusinessBarActionHandler",eventType:"User",data:{clickId:e.clickId,hasScript:!!n,actionName:Je.lg}})}function vt(e){var t=C.instance().getRunnable();t&&t.cancel(),(0,B.ve)({eventName:"BusinessBarActionHandler",eventType:"User",data:{clickId:e.clickId,hasRunnable:!!t,actionName:Je.Wh}})}function St(e){var t=e.scriptLink,n=e.clickId;(0,B.ve)({eventName:"ViewScriptActionHandler",eventType:"User",data:{clickId:n}});var r=JSON.parse(t).shareId;nt.d.store.dispatch(s.runFromButton.viewScript({shareId:r,clickId:n})),(0,_.jN)("TaskpanelessRFB")||st()}function xt(e){return bt.apply(this,arguments)}function bt(){return(bt=pt(regeneratorRuntime.mark((function e(t){var n,r,i,a,o,c,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.scriptLink,r=t.clickId,i=t.buttonText,(0,B.ve)({eventName:"RunFromButtonActionHandler",eventType:"User",data:{clickId:r}}),a=JSON.parse(n),o=a.shareId,!w.w.consentDialog.getIsVisible(nt.d.store.getState())){e.next=9;break}return at.t.instance().resolveDialogPromise(!1),nt.d.store.dispatch(s.consentDialog.hide()),e.next=9,Z.L.instance().mutexTokenReleasePromise();case 9:if(!Z.L.instance().acquireMutexToken()){e.next=18;break}if(c=new T.Lc("lastPublished","RunFromButton",r,i),C.instance().setRunnable(c),!(0,_.jN)("TaskpanelessRFB")){e.next=15;break}return e.next=15,(0,L.dA)(L.vj.officeScriptsRunningStatus,{runStatus:L.Z1.preparing,clickId:r,scriptLink:n,buttonText:i});case 15:nt.d.store.dispatch(s.runFromButton.attemptToRunScriptFromLink({shareId:o,clickId:r})),e.next=23;break;case 18:if(!(0,_.jN)("TaskpanelessRFB")){e.next=23;break}if(!(u=C.instance().getRunnable())){e.next=23;break}return e.next=23,(0,L.dA)(L.vj.officeScriptsRunningStatus,{runStatus:L.Z1.alreadyRunning,clickId:r,scriptLink:n,buttonText:u.buttonText});case 23:(0,_.jN)("TaskpanelessRFB")||st();case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}},17530:function(e,t,n){n.d(t,{G:function(){return a}});var r=n(21914),i=n(21178);function a(e,t,n){var a=r.useState(t),s=a[0],o=a[1],c=(0,i.B)(void 0!==e),u=c?e:s,l=r.useRef(u),p=r.useRef(n);r.useEffect((function(){l.current=u,p.current=n}));var m=(0,i.B)((function(){return function(e,t){var n="function"===typeof e?e(l.current):e;p.current&&p.current(t,n),c||o(n)}}));return[u,m]}},25824:function(e,t,n){n.d(t,{M:function(){return r}});var r=n(83081).K}}]);
//# sourceMappingURL=run-from-button.48a3383c.chunk.js.map