"use strict";(self.webpackChunkmaker_code_editor=self.webpackChunkmaker_code_editor||[]).push([[2181],{81844:function(e,r,t){t.r(r),t.d(r,{LocalStorageScript:function(){return R}});var n=t(2983),a=t(89991),i=t(7565),o=t(76128),u=t(84195),c=t(72558),s=t(61015);t(36030);function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e){var r="function"===typeof Map?new Map:void 0;return f=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof r){if(r.has(e))return r.get(e);r.set(e,n)}function n(){return l(e,arguments,h(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),b(n,e)},f(e)}function l(e,r,t){return l=d()?Reflect.construct:function(e,r,t){var n=[null];n.push.apply(n,r);var a=new(Function.bind.apply(e,n));return t&&b(a,t.prototype),a},l.apply(null,arguments)}function d(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function b(e,r){return b=Object.setPrototypeOf||function(e,r){return e.__proto__=r,e},b(e,r)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function g(){return g=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},g.apply(this,arguments)}function v(e){var r=g({},(0,s.OE)(),m,e);return{storageScript:r,localUpdates:y(r)}}var m={description:"Default example description",dateFirstPublished:1565634144474,dateLastPublished:1565634199999,parameterInfo:void 0,lastModifiedBy:"lastModifiedBy",creatorId:t(52997).H,creatorDisplayName:"Creator Display Name",isCreator:!0,creatorEmail:"test-creator@microsoft.com"},y=function(e){return{dateLastModified:15659e8,body:e.body,parameterInfo:e.parameterInfo}},S=(Error,t(32613));function w(){return w=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},w.apply(this,arguments)}function O(e,r,t,n,a,i,o){try{var u=e[i](o),c=u.value}catch(s){return void t(s)}u.done?r(c):Promise.resolve(c).then(n,a)}function P(e){return function(){var r=this,t=arguments;return new Promise((function(n,a){var i=e.apply(r,t);function o(e){O(i,n,a,o,u,"next",e)}function u(e){O(i,n,a,o,u,"throw",e)}o(void 0)}))}}var R=function(){var e=this;Object.defineProperty(this,"getScripts",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=P(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=[],n._.getScriptsMap().forEach((function(e){return r.push({id:e.id,name:e.name,dateFirstPublished:e.dateFirstPublished,dateLastPublished:e.dateLastPublished,creatorId:e.creatorId})})),e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"getRecentScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){var r=P(regeneratorRuntime.mark((function r(t,n){var a;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.getScript(t);case 2:return a=r.sent,r.abrupt("return",w({},a.storageScript,{path:[{name:"Local Storage",parentId:"",id:""},{name:"Office Scripts",parentId:"",id:""}]}));case 4:case"end":return r.stop()}}),r)})));return function(e,t){return r.apply(this,arguments)}}()}),Object.defineProperty(this,"getRecentScripts",{configurable:!0,enumerable:!0,writable:!0,value:function(){var r=P(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.getScripts();case 2:return r.abrupt("return",r.sent.map((function(e){return w({},e,{path:[{name:"Local Storage",parentId:"",id:""},{name:"Office Scripts",parentId:"",id:""}]})})));case 3:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}()}),Object.defineProperty(this,"saveScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=P(regeneratorRuntime.mark((function e(r,t){var u,c,s,p,f,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=(0,i.r)(r,t),s=n._.getScriptsMap(),p=Date.now(),f=w({},c,{id:(0,S.H)(r)?c.id+"-published":c.id,dateFirstPublished:null!=(u=c.dateFirstPublished)?u:p,dateLastPublished:p}),s.set(f.id,f),n._.updateLocalStorageScriptsMap(o.dR.recordedScriptsKey,s),l=(0,a.k)(f,{shareId:r.localUpdates.shareId}),e.abrupt("return",l);case 8:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"getGraphScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=P(regeneratorRuntime.mark((function e(r,t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",v());case 1:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"getScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=P(regeneratorRuntime.mark((function e(r){var t,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n._.getScriptsMap(),i=t.get(r.id)){e.next=4;break}throw new u.po("Script does not exist!",u.QD.ItemNotFound);case 4:return o=(0,a.k)(w({},i,{isCreator:!0}),{shareId:r.shareId}),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"removeScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=P(regeneratorRuntime.mark((function e(r){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(0,c.J)(r)&&(t=n._.getScriptsMap()).has(r.storageScript.id)&&t.delete(r.storageScript.id)&&n._.updateLocalStorageScriptsMap(o.dR.recordedScriptsKey,t),e.abrupt("return",r);case 2:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()})}},9522:function(e,r,t){t.r(r),t.d(r,{LocalStorageSharedScript:function(){return p}});var n=t(84195),a=t(89991),i=t(76128),o=t(2983);function u(){return u=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},u.apply(this,arguments)}function c(e,r,t,n,a,i,o){try{var u=e[i](o),c=u.value}catch(s){return void t(s)}u.done?r(c):Promise.resolve(c).then(n,a)}function s(e){return function(){var r=this,t=arguments;return new Promise((function(n,a){var i=e.apply(r,t);function o(e){c(i,n,a,o,u,"next",e)}function u(e){c(i,n,a,o,u,"throw",e)}o(void 0)}))}}var p=function(){var e=this;Object.defineProperty(this,"fetchAllDocAttachedScripts",{configurable:!0,enumerable:!0,writable:!0,value:function(){var r=s(regeneratorRuntime.mark((function r(t){var n,a;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=Promise.all(t.map(function(){var r=s(regeneratorRuntime.mark((function r(t){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",e.getSharedScript(t).catch((function(){})));case 1:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())),a=n.then((function(e){return e.filter((function(e){return void 0!==e}))})),r.abrupt("return",a);case 3:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()}),Object.defineProperty(this,"getSharedScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=s(regeneratorRuntime.mark((function e(r,t){var i,c,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=o._.getSharedScriptsMap(),c=null,i.forEach((function(e){e.shareId===r&&(c=e)})),!c){e.next=8;break}return s=u({},(0,a.k)(c,{shareId:r})),e.abrupt("return",s);case 8:throw new n.po("Shared script does not exist!",n.QD.ItemNotFound);case 9:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"shareScript",{configurable:!0,enumerable:!0,writable:!0,value:function(){var r=s(regeneratorRuntime.mark((function r(t){var a,c,s,p,f,l;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(a=o._.getSharedScriptsMap(),!(c=a.get(t))){r.next=6;break}return r.abrupt("return",c.shareId||"");case 6:if(s=e.generateTestShareId(t),p=o._.getScriptsMap(),f=p.get(t)){r.next=11;break}throw new n.po("Script does not exist!",n.QD.ItemNotFound);case 11:return l=u({},f,{shareId:s}),p.set(t,l),o._.updateLocalStorageScriptsMap(i.dR.sharedScriptsKey,p),r.abrupt("return",s);case 15:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()}),Object.defineProperty(this,"unshareScriptFromAllWorkbooks",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=s(regeneratorRuntime.mark((function e(r){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=o._.getSharedScriptsMap()).has(r)&&t.delete(r)&&o._.updateLocalStorageScriptsMap(i.dR.sharedScriptsKey,t);case 2:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()}),Object.defineProperty(this,"generateTestShareId",{configurable:!0,enumerable:!0,writable:!0,value:function(e){return"shareId-"+e}})}},2983:function(e,r,t){t.d(r,{_:function(){return a}});var n=t(76128),a=function(){};Object.defineProperty(a,"getScriptsMap",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=JSON.parse(localStorage.getItem(n.dR.recordedScriptsKey)||"{}");return new Map(Object.entries(e))}}),Object.defineProperty(a,"updateLocalStorageScriptsMap",{configurable:!0,enumerable:!0,writable:!0,value:function(e,r){window.localStorage.setItem(e,JSON.stringify(a.convertMapToObject(r)))}}),Object.defineProperty(a,"updateLocalStorageGeneral",{configurable:!0,enumerable:!0,writable:!0,value:function(e,r){window.localStorage.setItem(e,r)}}),Object.defineProperty(a,"convertMapToObject",{configurable:!0,enumerable:!0,writable:!0,value:function(e){var r={};return e.forEach((function(e,t){return r[t]=e})),r}}),Object.defineProperty(a,"getSharedScriptsMap",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=JSON.parse(localStorage.getItem(n.dR.sharedScriptsKey)||"{}");return new Map(Object.entries(e))}}),Object.defineProperty(a,"getAttachedIds",{configurable:!0,enumerable:!0,writable:!0,value:function(){return JSON.parse(localStorage.getItem(n.dR.attachedIdsKey)||"[]")}})}}]);
//# sourceMappingURL=LocalStorageScript.4ec77c4e.chunk.js.map