"use strict";(self.webpackChunkmaker_code_editor=self.webpackChunkmaker_code_editor||[]).push([[1189],{44412:function(e,t,n){var r=n(84586),i=n(21914);t.Z=function(e){var t=e.header,n=e.main;return i.createElement(o,null,t,i.createElement(a,null,n))};var o=r.ZP.div.withConfig({displayName:"HeaderAndMain__HeaderAndMainWrapper",componentId:"sc-16guzhj-0"})(["height:100%;width:100%;display:flex;flex-direction:column;background:",";"],(function(e){return e.theme.colors.neutralLight})),a=r.ZP.div.withConfig({displayName:"HeaderAndMain__MainArea",componentId:"sc-16guzhj-1"})(["overflow:hidden;flex:1;"])},63699:function(e,t,n){var r,i=n(84586),o=n(21914),a=n(31183);t.Z=(0,i.Zz)((function(e){var t=e["data-testid"]?{"data-testid":e["data-testid"]}:void 0;return o.createElement(c,null,o.createElement(a.X,{ariaLabel:strings.substitute(strings.Editor.SettingCheckboxAriaLabel,{settingName:e.settingTitle}),label:e.settingTitle,onChange:function(t,n){return void 0!==n&&e.onChange(n)},checked:e.checked,boxSide:"end",styles:s(e.theme),inputProps:t}))}));var s=function(e){return{root:{width:"100%"},label:{width:"100%",justifyContent:"space-between"},text:{fontSize:e.fontSizes.small,fontWeight:e.fontWeights.semibold}}},c=i.ZP.div(r||(r=function(e,t){return t||(t=e.slice(0)),e.raw=t,e}(["\n  margin: ",";\n  margin-top: ",";\n"])),(function(e){return e.theme.spacing.small}),(function(e){return e.theme.spacing.mediumPlus}))},45502:function(e,t,n){n.d(t,{Z:function(){return p}});var r,i=n(84586),o=n(21914),a=n(42090),s=n(54346),c=n(14979),l=n(31985);var u=(0,i.Zz)((function(e){return o.createElement(d,{"data-testid":e["data-testid"]},o.createElement(c._,{styles:{root:{fontWeight:e.theme.fontWeights.semibold,fontSize:e.theme.fontSizes.small}}},e.label),e.children)})),d=i.ZP.div(r||(r=function(e,t){return t||(t=e.slice(0)),e.raw=t,e}(["\n  margin: ",";\n  margin-bottom: ",";\n"])),(function(e){return e.theme.spacing.small}),(function(e){return e.theme.spacing.medium})),p=(0,i.Zz)((function(e){return o.createElement(u,{label:e.settingTitle},o.createElement(l.Z,{when:!!e.description},o.createElement(c._,null,e.description)),o.createElement(a.L,{"data-testid":e["data-testid"],ariaLabel:strings.substitute(strings.Editor.SettingsDropdownAriaLabel,{settingTitle:e.settingTitle}),selectedKey:m(e.settingTitle,e.currentValue),onChange:function(t,n){return n&&e.onChange(n.data)},options:e.possibleValues.map((function(t){return{key:m(e.settingTitle,t),text:e.displayValues&&e.displayValues[t]?e.displayValues[t]:t,data:t}})),responsiveMode:s.eD.large,styles:g(e.theme)}))})),m=function(e,t){return e+"_"+t+"_key"},g=function(e){return{title:{backgroundColor:e.colors.neutralLighterAlt},dropdown:{fontSize:e.fontSizes.small,selectors:{"&:focus:after":{borderWidth:"1.5px"}}},dropdownItem:{backgroundColor:e.colors.neutralLighterAlt,fontSize:e.fontSizes.small,selectors:{"&:focus":{backgroundColor:e.colors.neutralLight}}},dropdownItemSelected:{fontSize:e.fontSizes.small}}}},99684:function(e,t,n){n.d(t,{r:function(){return o}});var r=n(58351),i=n(13664);function o(e){e.fails.authFailures>0?((0,r.m)(new Error("Terminated with auth failure"),r.in.ASHA),(0,i.l)()):e.fails.disabledFailures>0&&((0,r.m)(new Error("Terminated with platform disabled"),r.in.ASHA),(0,i.q)())}},20440:function(e,t,n){n.d(t,{Z:function(){return h}});var r=n(39747),i=n(21914),o=n(81329),a=n(78574),s=n(32225),c=n(47525),l=n(33143),u=n(84586),d=n(49225),p=(0,u.Zz)((function(e){var t=e.theme,n=e.isOpen,r=e.acceptFn,s=e.cancelFn,u=e.hideAuthDialog;return i.createElement(o.V,{hidden:!n,onDismiss:u,dialogContentProps:m(t),modalProps:{isBlocking:!1,styles:(0,d.De)()}},i.createElement(a.c,null,i.createElement(c.K,{onClick:function(){r(),u()},text:strings.Dialog.AuthRetryRefreshButton}),i.createElement(l.a,{onClick:function(){s(new Error("User canceled final auth attempt")),u()},text:strings.General.CancelButtonText})))})),m=function(e){return{type:s.i.normal,title:strings.Dialog.AuthRetryTitle,styles:{title:{fontSize:e.fontSizes.large,fontWeight:e.fontWeights.semibold,color:e.colors.primary},subText:{color:e.colors.neutralPrimary},content:{backgroundColor:e.colors.neutralLight}},closeButtonAriaLabel:strings.General.CloseButtonLabel,subText:strings.Dialog.AuthRetrySubtext}},g=n(76974),f=n(76831),h=(0,r.$j)((function(e){return{isOpen:f.ZP.authDialog.getIsVisible(e),acceptFn:f.ZP.authDialog.getAcceptFn(e),cancelFn:f.ZP.authDialog.getCancelFn(e)}}),(function(e){return{dispatch:e,hideAuthDialog:function(){return e(g.ZP.authDialog.hide())}}}))(p)},1375:function(e,t,n){n.r(t),n.d(t,{default:function(){return Wc},showAuthDialog:function(){return Fc}});var r,i=n(21914),o=n(39747),a=n(20661),s=n(81343),c=n(84586),l=n(58351),u=n(60146),d=n(76293),p=n(76974),m=n(76831),g=(0,o.$j)((function(e){return{isOpen:m.ZP.consentDialog.getIsVisible(e),script:m.ZP.scripts.get(e,m.ZP.editor.getActiveScriptId(e))}}),(function(e){return{dispatch:e,hideConsentDialog:function(){return e(p.ZP.consentDialog.hide())}}}))(d.ZP),f=n(44412),h=n(31378),v=n(57158),S=n(4936),y=n(90271),E=n(66867);var b,w=(0,c.Zz)((function(e){return i.createElement(k,null,i.createElement(y.q,{key:e.key,shimmerColors:P(e.alpha,e.theme),shimmerElements:[{type:E.s.line,height:32,width:32},{type:E.s.gap,width:16},{type:E.s.line,height:32,width:e.titleLength}]}))})),k=c.ZP.div(r||(r=function(e,t){return t||(t=e.slice(0)),e.raw=t,e}(["\n  padding: 0.6rem ",";\n  margin-bottom: ",";\n  display: flex;\n  align-items: center;\n"])),(function(e){return e.theme.spacing.small}),(function(e){return e.theme.spacing.xSmall})),P=function(e,t){return void 0===e&&(e=1),{shimmer:"rgba(225,223,221,"+e+")",shimmerWave:"rgba(210,208,206,"+e+")",background:t.colors.neutralLight}},x=[142,156,110,134,157,101,147,152,108,114,121,122,153,125,140,156,155,142,151,100,157,127,110,135,121,151,145,156,144,130];var C=function(){return i.createElement(N,null,x.map((function(e,t){return i.createElement(w,{key:t,alpha:1-t/x.length,titleLength:e})})))},N=c.ZP.div(b||(b=function(e,t){return t||(t=e.slice(0)),e.raw=t,e}(["\n  height: 100%;\n  overflow-y: hidden;\n"]))),M=n(79628),R=n(7765),I=n(22713),B=n(21830),T=n(516),D=n(49225),O=["theme","items","openScript","addButtonToWorkbook","showConnectionPage","shouldShowShimmer"];function L(){return L=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},L.apply(this,arguments)}var A,z,Z=function(e){var t=e.theme,n=e.items,r=e.openScript,o=e.addButtonToWorkbook,a=e.showConnectionPage,s=e.shouldShowShimmer,c=void 0!==s&&s,l=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,O);(0,i.useEffect)((function(){window.document.title=strings.PageTitles.ScriptsList}));var u=(0,i.useMemo)((function(){return n}),[n]);return c?i.createElement(C,null):i.createElement(F,null,i.createElement(v.k,L({shouldEnterInnerZone:W,isCircularNavigation:!0,direction:S.U.vertical},l),u.map((function(e){return i.createElement(R.G,{key:"script_item_"+e.storageScript.id,content:e.storageScript.name,overflowMode:I.y.Self,styles:{root:{minWidth:"100%",maxWidth:"100%",display:"inline-flex"}},calloutProps:(0,D.FA)(t)},i.createElement(M.ZP,{script:e,openScript:r,addButtonToWorkbook:o,showConnectionPage:a}))}))))},F=c.ZP.div.withConfig({displayName:"ScriptList__ScriptListWrapper",componentId:"sc-1n5g9n9-0"})(["overflow-y:auto;overflow-x:hidden;"]),W=function(e){return e.which===(0,B.dP)(T.m.right)},_=n(80590),U=n(20968);function H(e,t){return t||(t=e.slice(0)),e.raw=t,e}function j(){return j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},j.apply(this,arguments)}var V={root:{selectors:{":focus":{outline:0}}}},K=function(e){return e.onRender?e.onRender(e):i.createElement(U.ZP,{buttonProps:e,additionalStyles:e.additionalStyles,tooltipText:e.tooltipText,dismissTooltipOnFirstShow:e.dismissTooltipOnFirstShow,testId:e.key,onTooltipToggle:e.onTooltipToggle})},G=function(e){var t=null==e?void 0:e.pop();return i.createElement(U.ZP,{testId:(0,u.k)("CommandBarOverflowButton"),buttonProps:{ariaLabel:strings.Editor.MoreAriaLabel,menuIconProps:{iconName:"OverflowIcon"},menuProps:{items:e.map((function(e){return j({},e,{"data-testid":e.key})})),isBeakVisible:!1,focusZoneProps:{style:{backgroundColor:t.calloutBackgroundColor}}}},tooltipText:strings.Editor.OverflowMenuTooltipText})},X=function(e){var t=null==e?void 0:e.pop();return i.createElement(U.ZP,{testId:(0,u.k)("CommandBarOverflowButton"),buttonProps:{ariaLabel:strings.Editor.MoreAriaLabel,menuIconProps:{iconName:"OverflowIcon"},menuProps:{items:e.map((function(e){return j({},e,{"data-testid":e.key})})),isBeakVisible:!1,focusZoneProps:{style:{backgroundColor:t.calloutBackgroundColor}}},componentRef:t.overflowButtonRef},tooltipText:strings.Editor.OverflowMenuTooltipText,additionalStyles:t.additionalStyles,isMenuOpened:t.isMenuOpened,setIsMenuOpened:t.setIsMenuOpened})},$=c.ZP.div(A||(A=H(["\n  display: flex;\n  height: 3.2rem;\n"]))),q=c.ZP.div(z||(z=H(["\n  flex-grow: 1;\n  height: 3.2rem;\n"]))),Q=(0,c.Zz)((function(e){var t=e.primaryCommands,n=e.overflowCommands,r=e.disabled;return i.createElement($,null,i.createElement(q,null,i.createElement(_.p,{items:t.map((function(e){return j({disabled:r},e)})),onRenderOverflowButton:function(){return null},onRenderItem:K,styles:V})),i.createElement(_.p,{overflowItems:n,onRenderOverflowButton:e.isDetailsPage?X:G,onRenderItem:function(){return null},styles:V}))})),Y=n(60683),J=n(44696),ee=n(31985);function te(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,i)}function ne(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){te(o,r,i,a,s,"next",e)}function s(e){te(o,r,i,a,s,"throw",e)}a(void 0)}))}}function re(e){return ie.apply(this,arguments)}function ie(){return(ie=ne(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=document.getElementsByTagName("script"),i=r[r.length-1],o=document.createElement("script");o.setAttribute("src",t),o.onload=function(){return e()},o.onerror=function(e,r,i,o,a){return n(a||new Error("failed to load "+t))},i.parentNode.insertBefore(o,i.nextSibling)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var oe=n(67746),ae=n(87913),se=n(47387),ce={"monaco-editor-latest":"0.20.0","office-ui-fabric-core":"10.0.0"},le=function(){var e={};for(var t in ce)e[t]=ce[t].replace(/\./g,"-");return e}();var ue=n(17317),de=n(35676),pe=n(54050),me=n(8797),ge=de.lF+"/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.0.2108.30011/en-us_web/external/monaco-editor-0-20-0/";function fe(){return!ue.ZP&&(0,me.Z)()&&(0,pe.Xf)()===Office.PlatformType.PC?ge+"min/vs":"external/monaco-editor-"+le["monaco-editor-latest"]+"/"+(ue.ZP?"dev":"min")+"/vs"}function he(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,i)}function ve(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){he(o,r,i,a,s,"next",e)}function s(e){he(o,r,i,a,s,"throw",e)}a(void 0)}))}}function Se(e){return ye.apply(this,arguments)}function ye(){return(ye=ve(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.require){e.next=2;break}throw new Error("window.require is not defined");case 2:return e.abrupt("return",new Promise((function(e){return window.require(t,(function(){return e()}))})));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ee,be=n(23386),we=n(70546),ke=n(41410),Pe=n(13753);function xe(e){return"office-scripts-"+e}!function(e){e.FunctionArgument="MarkFunctionArgumentError",e.SyncAPI="MarkLinter",e.Dynamic="DynamicLinter",e.ApiSet="ApiSetLinter"}(Ee||(Ee={}));var Ce=n(20260),Ne=n(23873),Me=n(38186),Re=function(e,t){return!!e&&(0,Me.o)(e)&&(0,Ce.C)(e)&&!t&&(0,Ne.o)(e)},Ie=n(36103),Be=n(79002),Te=n(82750),De=n(6986),Oe=n(76123),Le=n(35064),Ae=(n(38281),n(36892));function ze(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return Ze(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ze(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Fe=new Le.Z;function We(e,t,n){for(var r=e.split("\n"),i=0,o=-1,a=-1,s=0;s<r.length;s++){var c=i+r[s].length+1;if(c>t&&(o=s+1,a=t-i+1),c>n)return{startLineNumber:o,endLineNumber:s+1,startColumn:a,endColumn:n-i+1};i=c}return null}function _e(){return{provideCodeActions:function(e,t,n,r){var i=[],o=De.c.value();if(o)try{!function(){for(var t=e.getValue(),r=function(e,t){return Fe.lint(e,t).filter((function(e){return e.messageType===Ae.Z.AllowedGetEntityStrings}))}(t,new Oe.Z(o.getCache())),a=function(o){var a=n.markers[o],s=r.find((function(e){var n=We(t,e.startPos,e.endPos);return n.startColumn===a.startColumn&&n.startLineNumber===a.startLineNumber&&n.endColumn===a.endColumn&&n.endLineNumber===a.endLineNumber}));s&&s.data.allowedNames.forEach((function(t){i.push({title:t,diagnostics:[a],kind:"quickfix",edit:{edits:[{resource:e.uri,edit:{range:{startColumn:a.startColumn,startLineNumber:a.startLineNumber,endColumn:a.endColumn,endLineNumber:a.endLineNumber},text:JSON.stringify(t)}}]},isPreferred:!0})}))},s=0;s<n.markers.length;s++)a(s)}()}catch(a){}return{actions:i,dispose:function(){}}}}}function Ue(){return{triggerCharacters:['"'],provideCompletionItems:function(e,t){var n=De.c.value();if(!n)return{suggestions:[]};try{var r=function(e,t,n,r){for(var i,o=ze(Fe.lint(e,t));!(i=o()).done;){var a=i.value;if(a.messageType===Ae.Z.AllowedGetEntityStrings){var s=We(e,a.startPos,a.endPos);if(s.startLineNumber<=n&&s.endLineNumber>=n&&s.startColumn<=r&&s.endColumn>=r)return a.data.allowedNames}}return[]}(e.getValue(),new Oe.Z(n.getCache()),t.lineNumber,t.column);return{suggestions:r.map((function(e){return{range:null,kind:18,label:e,insertText:e}}))}}catch(i){}return{suggestions:[]}}}}var He=n(75434);function je(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,i)}function Ve(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){je(o,r,i,a,s,"next",e)}function s(e){je(o,r,i,a,s,"throw",e)}a(void 0)}))}}function Ke(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ge(e,t){return Ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ge(e,t)}var Xe=function(e){var t,n;function r(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=e.call.apply(e,[this].concat(r))||this,Object.defineProperty(Ke(t),"editor",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(Ke(t),"container",{configurable:!0,enumerable:!0,writable:!0,value:null}),Object.defineProperty(Ke(t),"isKeyboardListenerAlreadyAttached",{configurable:!0,enumerable:!0,writable:!0,value:!1}),Object.defineProperty(Ke(t),"isUndoInProgress",{configurable:!0,enumerable:!0,writable:!0,value:!1}),Object.defineProperty(Ke(t),"undoCount",{configurable:!0,enumerable:!0,writable:!0,value:0}),Object.defineProperty(Ke(t),"isRedoInProgress",{configurable:!0,enumerable:!0,writable:!0,value:!1}),Object.defineProperty(Ke(t),"redoCount",{configurable:!0,enumerable:!0,writable:!0,value:0}),Object.defineProperty(Ke(t),"debounceTime",{configurable:!0,enumerable:!0,writable:!0,value:100}),Object.defineProperty(Ke(t),"language",{configurable:!0,enumerable:!0,writable:!0,value:"typescript"}),Object.defineProperty(Ke(t),"disposableMonacoProviders",{configurable:!0,enumerable:!0,writable:!0,value:[]}),Object.defineProperty(Ke(t),"setMonacoContainerRef",{configurable:!0,enumerable:!0,writable:!0,value:function(e){t.container=e}}),Object.defineProperty(Ke(t),"onValueChange",{configurable:!0,enumerable:!0,writable:!0,value:(0,oe.D)((function(e){var n=e.getModel();n&&t.props.script&&t.props.onValueChange({id:t.props.script.storageScript.id,updatedBody:n.getValue()})}),t.debounceTime)}),Object.defineProperty(Ke(t),"onKeyDown",{configurable:!0,enumerable:!0,writable:!0,value:function(e){(0,ke.hD)(e)&&(t.isUndoInProgress=!0),(0,ke.UL)(e)&&(t.isRedoInProgress=!0)}}),Ke(t)||Ke(t)}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,Ge(t,n);var o=r.prototype;return o.initializeMonacoIfReady=function(){this.container&&this.initializeMonaco(this.container)},o.componentDidMount=function(){var e=Ve(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0!==window.monaco&&this.initializeMonacoIfReady();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.componentDidUpdate=function(e){if(void 0===this.editor)this.props.isReactMonacoLoaded&&this.initializeMonacoIfReady();else{var t=this.props.script.storageScript.id,n=e.script.storageScript.id,r=this.props.script.localUpdates.body,i=e.script.localUpdates.body,o=(0,Pe.u)(this.props.script),a=(0,Pe.u)(e.script),s=void 0!==r&&null!==r,c=void 0!==i&&null!==i;if(!s)return;if(o!=a&&this.initializeIntellisense(),t&&n&&t!==n||this.props.script.storageScript.name&&e.script.storageScript.name&&this.props.script.storageScript.name!==e.script.storageScript.name){var l=monaco.Uri.file(e.script.storageScript.name),u=monaco.editor.getModel(l);u&&u.dispose()}if(t&&t!==n||s&&!c||this.props.externalContentUpdateCounter!==e.externalContentUpdateCounter||this.props.isReadOnly!==e.isReadOnly){this.editor.updateOptions({readOnly:this.props.isReadOnly});var d=this.getModel();d&&(this.editor.setModel(d),this.editor.getValue()!==r&&(this.editor.pushUndoStop(),this.editor.executeEdits("ReactMonaco",[{range:d.getFullModelRange(),text:r}]))),this.handleResize()}}},o.componentWillUnmount=function(){this.editor&&(this.editor.dispose(),this.editor=void 0),window.removeEventListener("resize",this.handleResize)},o.render=function(){return i.createElement(i.Fragment,null,i.createElement(ee.Z,{when:void 0===this.props.script.localUpdates.body||this.props.isMonacoLoading},i.createElement(qe,{"data-testid":(0,u.k)("MainEditorScriptLoadingSpinner")},i.createElement(ae.$,{size:se.E.large,styles:(0,D.H_)(se.E.large,this.props.theme)}))),i.createElement(qe,{style:{display:void 0!==this.props.script.localUpdates.body?"block":"none"},ref:this.setMonacoContainerRef,"data-testid":(0,u.k)("MainEditor"),role:"textbox","aria-label":strings.Editor.EditorAriaLabel,"aria-roledescription":strings.Editor.EditorAriaRoleDescription,dir:"ltr"}))},r.attemptToLoadMonaco=function(){var e=Ve(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new l.pX("LoadMonaco","System",[{level:l.in.Warning,timeout:l.NJ.UserUnsatisfied}]),e.prev=1,r=fe(),e.next=5,re(r+"/loader.js");case 5:return window.require.config({baseUrl:".",paths:{vs:r}}),e.next=8,Se(["vs/editor/editor.main"]);case 8:n.succeed(l.in.Information,{loadedFrom:t}),e.next=15;break;case 11:throw e.prev=11,e.t0=e.catch(1),n.fail(l.in.Error,{loadedFrom:t},e.t0),e.t0;case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t){return e.apply(this,arguments)}}(),o.initializeIntellisense=function(){var e=Ve(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.script,e.next=3,(0,we.Z)((0,Pe.u)(t));case 3:n=e.sent,(r=monaco.languages.typescript.typescriptDefaults).setExtraLibs&&r.setExtraLibs([]),n.forEach((function(e){return monaco.languages.typescript.typescriptDefaults.addExtraLib(e)}));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),o.initializeMonaco=function(e){var t=new l.pX("InitializeMonaco","System");try{this.setCustomKeyHandler(e),monaco.languages.typescript.typescriptDefaults.setCompilerOptions({target:monaco.languages.typescript.ScriptTarget.ES5,allowNonTsExtensions:!0,lib:["dom","es2015"]}),this.initializeIntellisense();monaco.languages.typescript.typescriptDefaults.setDiagnosticsOptions({diagnosticCodesToIgnore:[6133]}),window.addEventListener("resize",this.handleResize),this.editor=this.createEditor(e),(0,Te.HQ)("DynamicLinter")&&(this.disposableMonacoProviders.push(monaco.languages.registerCompletionItemProvider(this.language,Ue())),this.disposableMonacoProviders.push(monaco.languages.registerCodeActionProvider(this.language,_e()))),this.props.editorDidMount(this.editor),t.succeed(l.in.Information,{})}catch(n){throw t.fail(l.in.Error,{},n),n}},o.getModel=function(){var e=this,t=monaco.Uri.file(this.props.script.storageScript.name),n=monaco.editor.getModel(t);if(!n){var r=this.props.script.localUpdates.body;void 0!==r&&null!==r?(n=monaco.editor.createModel(r,this.language.toLowerCase(),t)).onWillDispose((function(){monaco.editor.setModelMarkers(n,xe(Ee.FunctionArgument),[]),monaco.editor.setModelMarkers(n,xe(Ee.SyncAPI),[]),((0,Te.HQ)("DynamicLinter")||(0,Te.HQ)("DynamicLinterTelemetry"))&&monaco.editor.setModelMarkers(n,xe(Ee.Dynamic),[]),(0,pe.Xf)()===Office.PlatformType.PC&&(0,He.jN)("OfficeScriptsWin32CRUD")&&monaco.editor.setModelMarkers(n,xe(Ee.ApiSet),[]),e.disposableMonacoProviders.forEach((function(e){return e.dispose()}));var t=De.c.value();t&&(t.onCacheUpdated=void 0)})):n=null}return n},o.clearAllModels=function(){monaco.editor.getModels().forEach((function(e){return e.dispose()}))},o.createEditor=function(e){var t=this;this.clearAllModels();var n=this.getModel(),r=monaco.editor.create(e,{model:n,language:this.language,automaticLayout:!0});return r.onDidChangeModelContent((function(){t.onValueChange(r)})),r.onDidPaste&&r.onDidPaste((function(){(0,l.ve)((0,Y.Z)({eventName:"EditorOperation",eventType:"User",data:{logLevel:l.in.Information,operation:"Paste",storageId:t.props.script.storageScript.id}}))})),r.onDidChangeCursorPosition((function(e){switch(e.reason){case monaco.editor.CursorChangeReason.Undo:t.isUndoInProgress&&t.undoCount++;break;case monaco.editor.CursorChangeReason.Redo:t.isRedoInProgress&&t.redoCount++}})),r.getAction("editor.action.clipboardCopyAction")&&r.addCommand(monaco.KeyMod.CtrlCmd|monaco.KeyCode.KEY_C,(function(){r.trigger("ReactMonaco","editor.action.clipboardCopyAction",null),(0,l.ve)((0,Y.Z)({eventName:"EditorOperation",eventType:"User",data:{logLevel:l.in.Information,operation:"Copy",storageId:t.props.script.storageScript.id,isOwner:(0,Ce.C)(t.props.script),driveType:t.props.script.storageScript.driveType}}))})),r.getAction("editor.action.clipboardCutAction")&&r.addCommand(monaco.KeyMod.CtrlCmd|monaco.KeyCode.KEY_X,(function(){r.trigger("ReactMonaco","editor.action.clipboardCutAction",null),(0,l.ve)((0,Y.Z)({eventName:"EditorOperation",eventType:"User",data:{logLevel:l.in.Information,operation:"Cut",storageId:t.props.script.storageScript.id}}))})),r.updateOptions({readOnly:this.props.isReadOnly}),this.props.monacoEditorOnWindowName&&(window[this.props.monacoEditorOnWindowName]=r),r},o.handleResize=function(){this.editor&&this.editor.layout()},o.setCustomKeyHandler=function(e){var t=this;this.isKeyboardListenerAlreadyAttached||(this.isKeyboardListenerAlreadyAttached=!0,e.onkeydown=this.onKeyDown,e.onkeyup=function(e){if((0,ke.hD)(e)&&(t.isUndoInProgress=!1,0===t.undoCount&&(0,l.ve)((0,Y.Z)({eventName:"EditorOperation",eventType:"User",data:{logLevel:l.in.Information,operation:"Undo",storageId:t.props.script.storageScript.id,success:!1}})),t.undoCount=0),(0,ke.UL)(e)&&(t.isRedoInProgress=!1,0===t.redoCount&&(0,l.ve)((0,Y.Z)({eventName:"EditorOperation",eventType:"User",data:{logLevel:l.in.Information,operation:"Redo",storageId:t.props.script.storageScript.id,success:!1}})),t.redoCount=0),(0,ke.jA)(e))return e.stopPropagation(),void(t.props.script&&Re(t.props.script,t.props.isStorageCallInProgress)&&((0,l.ve)({eventName:"ControlAction",eventType:"User",data:{control:"ReactMonacoSaveEvent",location:"Editor",storageId:t.props.script.storageScript.id,navigationSourcePage:t.props.navigationSourcePageName}}),Be.P.instance(Ie.u.store).saveScript(t.props.script,{})));e.key===be.OK9&&t.editor&&t.editor.getOption&&!t.editor.getOption(monaco.editor.EditorOption.tabFocusMode)&&e.stopPropagation()})},r}(i.Component),$e=Xe,qe=c.ZP.div.withConfig({displayName:"ReactMonaco__EditorArea",componentId:"mxa0lf-0"})(["width:100%;height:calc(100% - 3.4rem);background:",";display:flex;align-items:center;justify-content:center;"],(function(e){return e.theme.colors.neutralLighterAlt})),Qe=n(36047),Ye=n(14979),Je=n(98320),et=n(83081),tt=n(18639),nt=n(81066);function rt(){return rt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rt.apply(this,arguments)}function it(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,i)}function ot(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){it(o,r,i,a,s,"next",e)}function s(e){it(o,r,i,a,s,"throw",e)}a(void 0)}))}}var at,st=function(e){return i.createElement("svg",e,i.createElement("title",null,"ExcelMyScripts_B (1) (1)"),i.createElement("defs",null,i.createElement("radialGradient",{cx:"108.994%",cy:"19.759%",fx:"108.994%",fy:"19.759%",r:"323.462%",gradientTransform:"matrix(.83914 0 0 1 .175 0)",id:"a"},i.createElement("stop",{stopColor:"#4E9668",offset:".063%"}),i.createElement("stop",{stopColor:"#64A57C",offset:"6.21%"}),i.createElement("stop",{stopColor:"#7AB490",offset:"14.45%"}),i.createElement("stop",{stopColor:"#8BBFA0",offset:"24.18%"}),i.createElement("stop",{stopColor:"#96C7AB",offset:"36.22%"}),i.createElement("stop",{stopColor:"#9DCCB1",offset:"53.11%"}),i.createElement("stop",{stopColor:"#9FCDB3",offset:"100%"})),i.createElement("radialGradient",{cx:"58.266%",cy:"64.37%",fx:"58.266%",fy:"64.37%",r:"73.563%",gradientTransform:"matrix(-1 0 0 -.59535 1.165 1.027)",id:"b"},i.createElement("stop",{stopColor:"#4E9668",offset:"0%"}),i.createElement("stop",{stopColor:"#5B9F74",offset:"4.87%"}),i.createElement("stop",{stopColor:"#73AF8B",offset:"16.8%"}),i.createElement("stop",{stopColor:"#87BD9D",offset:"30.17%"}),i.createElement("stop",{stopColor:"#95C6A9",offset:"45.57%"}),i.createElement("stop",{stopColor:"#9DCBB1",offset:"64.83%"}),i.createElement("stop",{stopColor:"#9FCDB3",offset:"100%"})),i.createElement("radialGradient",{cx:"71.624%",cy:"25.648%",fx:"71.624%",fy:"25.648%",r:"54.323%",gradientTransform:"scale(1 .9361) rotate(2.358 .291 .265)",id:"c"},i.createElement("stop",{stopColor:"#9B643D",offset:"0%"}),i.createElement("stop",{stopColor:"#BF8F68",offset:"100%"})),i.createElement("radialGradient",{cx:"10.077%",cy:"53.232%",fx:"10.077%",fy:"53.232%",r:"75.991%",gradientTransform:"scale(1 .58715) rotate(3.128 -6.754 .72)",id:"d"},i.createElement("stop",{stopColor:"#9B643D",offset:"0%"}),i.createElement("stop",{stopColor:"#BF8F68",offset:"100%"})),i.createElement("radialGradient",{cx:"61.106%",cy:"117.264%",fx:"61.106%",fy:"117.264%",r:"104.552%",gradientTransform:"scale(.87234 1) rotate(.251 .656 21.586)",id:"e"},i.createElement("stop",{stopColor:"#4E9668",offset:"0%"}),i.createElement("stop",{stopColor:"#5EA177",offset:"5.69%"}),i.createElement("stop",{stopColor:"#76B18D",offset:"16.24%"}),i.createElement("stop",{stopColor:"#88BE9E",offset:"28.3%"}),i.createElement("stop",{stopColor:"#95C6AA",offset:"42.56%"}),i.createElement("stop",{stopColor:"#9DCCB1",offset:"61.12%"}),i.createElement("stop",{stopColor:"#9FCDB3",offset:"100%"}))),i.createElement("g",{fillRule:"nonzero",fill:"none"},i.createElement("g",{transform:"translate(0 .5)"},i.createElement("path",{d:"M37.754 93.58a15.19 15.19 0 0 0-.074-4.536c-1.688-9.927-5.057-18.94-13.655-18.94-8.599 0-16.833 9.911-16.833 19.65 0 1.31.132 2.589.38 3.825h30.182z",fill:"#605D5A"}),i.createElement("path",{d:"M61.274 71.67l4.908-2.234.977-.453c.438-.033.869.156 1.142.503l.927 1.17 1.547-1.277-.844-1.798a1.808 1.808 0 0 0-1.266-.998l-1.945-.412 2.069-.223 1.622.973 1.332-.156-2.995-2.086-3.236.478-5.47 4.024 1.232 2.49z",fill:"#BF8F68"}),i.createElement("path",{d:"M62.78 67.194s-16.303 2.918-23.006-5.335c-4.403-5.426-5.28-13.342-5.446-16.648-.132-2.614-1.713-4.552-4.005-4.66-1.25-.057-2.54.388-3.46 1.403-4.775 5.277-3.525 20.44 7.482 27.754 9.045 6.02 26.276 2.969 28.94 1.83l-.504-4.344z",fill:"url(#a)"}),i.createElement("path",{d:"M55.432 75.159l4.907-2.235.977-.453c.438-.033.869.156 1.142.503l.927 1.17 1.547-1.278-.844-1.797a1.808 1.808 0 0 0-1.266-.998l-1.945-.412 2.07-.223 1.621.973 1.333-.156-2.996-2.087-3.236.479-5.47 4.024 1.233 2.49z",fill:"#BF8F68"}),i.createElement("path",{d:"M5.917 16.22l19.449-1.93V66.64l-25.217.074s4.279-25.75 5.768-50.496z",fill:"#3A312E"}),i.createElement("path",{d:"M5.652 17.967C5.057 28.052 16.03 37.575 25.366 38.021c9.922.437 7.812-25.57 7.911-33.626C30.63 2.119 27.31.693 23.644.51 14.301.066 6.248 7.883 5.652 17.967z",fill:"#3A312E"}),i.createElement("ellipse",{fill:"#8B8CC7",cx:"19.606",cy:"47.074",rx:"8.35",ry:"8.32"}),i.createElement("path",{d:"M6.306 86.043h31.697s-2.152-9.573-1.78-18.182c.373-8.608 1.432-14.034-.471-20.787-1.598-5.648-4.337-9.565-8.061-12.632-1.49-1.229-3.708-1.336-6.074-1.583-2.367-.248-4.51.338-6.331 1.6-4.66 3.215-6.43 13.2-5.67 22.823.845 10.72-3.31 28.761-3.31 28.761z",fill:"url(#b)"}),i.createElement("path",{d:"M55.564 71.67s-17.86.306-24.753-9.317c-4.535-6.324-5.114-14.636-5.148-18.066-.024-2.713-1.646-4.972-4.137-5.467-1.358-.272-2.781-.016-3.824.874-5.437 4.65-4.783 20.49 6.836 29.858 9.55 7.701 28.42 7.42 31.365 6.695l-.339-4.576z",fill:"#9FCDB3"}),i.createElement("path",{d:"M15.757 33.741s2.152 1.97 6.298 1.995c4.072-.28 5.628-1.294 5.628-1.294-2.607-1.163-2.218-2.894-2.317-3.95l.19-6.027-8.392-1.468s1.655 4.741.646 8.922c-.224.932-2.053 1.822-2.053 1.822z",fill:"url(#c)"}),i.createElement("path",{d:"M26.135 29.198l-.712-.05c-5.453-.396-9.55-5.129-9.153-10.562l.24-3.257c.39-5.294 5.016-9.277 10.329-8.89l1.671.125c4.486.33 7.846 4.213 7.523 8.674l-.43 5.813c-.348 4.848-4.593 8.501-9.468 8.147z",fill:"#BF8F68"}),i.createElement("path",{fill:"url(#d)",d:"M34.734 14.908l-.927 9.895-4.883-.61.795-8.88z"}),i.createElement("path",{d:"M16.651 15.015c-1.788-.206-3.41 1.064-3.617 2.845a3.249 3.249 0 0 0 2.856 3.603l1.092.124-.331-6.572zM28.163 20.647c.016.602.993 2.053.993 2.053s.083-.495.521-.66c.712-.263 1.167-1.22 1.026-2.086-.107-.643-.355-.832-.753-1.154-.356-.289-.918-2.045-.918-2.045s-.919 2.309-.87 3.892z",fill:"#BF8F68"}),i.createElement("ellipse",{fill:"#3A312E",transform:"rotate(-88.659 24.365 17.469)",cx:"24.365",cy:"17.469",rx:"1.435",ry:"1"}),i.createElement("ellipse",{fill:"#3A312E",transform:"rotate(-88.298 32.43 17.861)",cx:"32.43",cy:"17.861",rx:"1.352",ry:"1"}),i.createElement("path",{d:"M28.229 25.182c-.248.445-.77.684-1.25.734-.496.066-.976-.05-1.407-.256a2.435 2.435 0 0 1-1.042-.98c-.249-.421-.34-.982-.133-1.436.075-.165.273-.239.439-.165.041.017.083.05.116.083l.041.05c.248.28.455.428.67.577.216.14.43.272.663.387.223.124.463.223.711.322.249.082.489.173.844.198l.083.008a.33.33 0 0 1 .306.346.808.808 0 0 1-.041.132z",fill:"#9B643D"}),i.createElement("path",{d:"M30.513 13.68l1.25-2.35.918 2.514 5.504.85s1.614-11.313-10.46-12.13C22.7 2.226 16.807 9.433 16.476 14.29c-.008-.009 8.897-.924 14.036-.61z",fill:"#3A312E"}),i.createElement("path",{d:"M21.343 12.542l-.993 13.044c.1 4.016-1.928 7.108-5.321 9.623-1.324.981-2.74 2.168-4.047 3.554l.72-26.081 9.641-.14z",fill:"#3A312E"})),i.createElement("path",{d:"M200.769 95.5H86l.231-77.834c0-3.956 3.197-7.166 7.137-7.166h100.496c3.94 0 7.136 3.21 7.136 7.166l-.231 77.834z",fill:"#B3AFAB"}),i.createElement("path",{d:"M161 17.194c0-3.7-2.988-6.694-6.68-6.694H87.5c-3.693 0-6.68 2.994-6.68 6.694V59.41l-.059-.008L55 82.08l.34 13.42h105.536L161 17.194z",fill:"#DBDBDB"}),i.createElement("g",{transform:"translate(125 25.5)"},i.createElement("ellipse",{fill:"#9FCDB3",cx:"4.538",cy:"23.517",rx:"3.78",ry:"3.852"}),i.createElement("ellipse",{fill:"#4E9668",cx:"4.538",cy:"4.104",rx:"3.78",ry:"3.852"}),i.createElement("ellipse",{fill:"#FFF",cx:"4.538",cy:"42.921",rx:"3.78",ry:"3.852"}),i.createElement("ellipse",{fill:"#FFF",cx:"23.66",cy:"4.104",rx:"3.78",ry:"3.852"}),i.createElement("ellipse",{fill:"#4E9668",cx:"23.66",cy:"23.517",rx:"3.78",ry:"3.852"}),i.createElement("ellipse",{fill:"#9FCDB3",cx:"23.66",cy:"42.921",rx:"3.78",ry:"3.852"})),i.createElement("path",{d:"M197.297 29.5h-31.594c-1.49 0-2.703-1.115-2.703-2.5 0-1.377 1.206-2.5 2.703-2.5h31.594c1.49 0 2.703 1.115 2.703 2.5-.008 1.377-1.214 2.5-2.703 2.5z",fill:"#A19F9D"}),i.createElement("path",{d:"M164 26.5s3.76 5.562 4.078 13.708c.423 10.612-.562 25.93 9.5 27.043 6.837.751 33.422-.437 33.422-.437s-8.8-3.59-7.896-21.358c.7-13.724-5.022-18.675-5.022-18.675L164 26.5z",fill:"url(#e)"}),i.createElement("path",{d:"M224.831 56.5l-36.313 1.133S186.17 65.985 178 67.557c8.83 2.373 40.177-.48 40.177-.48s8.08-1.174 6.654-10.577z",fill:"#BCDCCA"}),i.createElement("g",{transform:"translate(86 25.5)"},i.createElement("circle",{fill:"#FFF",cx:"13.008",cy:"13.05",r:"12.782"}),i.createElement("path",{d:"M13.008.176c-4.83 0-9.04 2.692-11.222 6.66A12.76 12.76 0 0 0 .201 13H.185c0 3.254 1.207 6.357 3.413 8.74l2.835-2.617a9.002 9.002 0 0 1-2.39-6.098h.008c0-1.392.319-2.709.88-3.891 1.443-3.02 4.521-5.117 8.077-5.117 1.024 0 2.013.177 2.927.495a9.024 9.024 0 0 1 6.03 8.513h3.85c0-5.695-3.707-10.534-8.831-12.22a12.896 12.896 0 0 0-3.976-.629z",fill:"#9FCDB3"}),i.createElement("path",{d:"M22.578 9.1l-9.897 1.241c-1.962.244-3.17 2.282-2.457 4.127a3.04 3.04 0 0 0 4.596 1.367l8.119-5.787c.453-.319.184-1.015-.36-.948zm-10.09 5.46a1.362 1.362 0 1 1 1.191-2.449c.671.327.956 1.149.63 1.82-.328.68-1.141.964-1.82.629z",fill:"#217346"}),i.createElement("path",{d:"M13.034.176c-4.815 0-9.025 2.692-11.197 6.651.05.067 3.044 2.273 3.137 2.298 1.442-3.02 4.512-5.108 8.06-5.108 1.023 0 2.004.177 2.918.495.05.009.998-3.698 1.049-3.707a12.842 12.842 0 0 0-3.967-.629z",fill:"#4E9668"}),i.createElement("path",{d:"M1.786 6.844a12.76 12.76 0 0 0-1.585 6.164H.185c0 3.255 1.207 6.358 3.413 8.74l2.835-2.617a9.002 9.002 0 0 1-2.39-6.097h.008c0-1.393.478-2.961 1.04-4.144-.076-.033-3.288-2.096-3.305-2.046z",fill:"#9FCDB3"})),i.createElement("path",{fill:"#B3AFAB",d:"M91.285 81.155v-3.432h21.43v3.432z"}),i.createElement("path",{d:"M108.698 73.644v11.592c0 1.016-.84 1.832-1.866 1.832h-2.738c-1.035 0-1.866-.824-1.866-1.832V73.644c0-1.016.84-1.832 1.866-1.832h2.738c1.027 0 1.866.824 1.866 1.832z",fill:"#4E9668"})))};st.defaultProps={width:"225",height:"96",viewBox:"0 0 225 96",xmlns:"http://www.w3.org/2000/svg"},function(e){e.Recent="Recent",e.Attached="Attached",e.Samples="Samples"}(at||(at={}));var ct={Recent:(0,Te.HQ)("PopulateRecentScripts")?strings.Editor.MyRecentLabel:strings.Editor.MyScriptsLabel,Attached:strings.Editor.ThisWorkbookLabel,Samples:strings.Editor.SamplesLabel},lt=function(){Be.P.instance(Ie.u.store).createNewScript()},ut=(0,c.Zz)((function(e){var t,n=(0,i.useState)(!0),r=n[0],o=n[1],a=(0,i.useRef)(0),s=(0,i.useRef)(!1),c=e.showConnectionPage;(0,i.useEffect)((function(){function t(){return(t=ot(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.current++,n=a.current,t.next=4,(0,Qe.D)(3e3);case 4:if(s.current||a.current!==n){t.next=9;break}return t.next=7,Xe.attemptToLoadMonaco("Backstage");case 7:s.current=!0,e.setIsReactMonacoLoaded();case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}void 0===window.monaco&&function(){t.apply(this,arguments)}()}),[e]);var d=(0,i.useState)(!0),p=d[0],m=d[1];(0,Je.g)().then((function(e){m(e)}));for(var g=[],v=0,S=Object.values(at);v<S.length;v++){var y=S[v];g.push({key:y,testId:(0,u.k)("Backstage"+y+"Pivot"),text:ct[y],ariaLabel:ct[y]})}var E=i.createElement(vt,null,i.createElement(et.K,{"data-testid":(0,u.k)("ViewMoreScriptsButton"),iconProps:{iconName:(0,B.zg)()?"ArrowForwardRtl":"ArrowForward"},ariaLabel:strings.Backstage.ViewMoreScriptsButtonText,styles:rt({},(0,D.R4)(e.theme),Et(e.theme)),onClick:function(){e.invokeSharedFilePicker()}},strings.Backstage.ViewMoreScriptsButtonText)),b=nt.X.instance(),w=i.createElement(i.Fragment,null,i.createElement(ft,{"data-testid":(0,u.k)("BackstageNoScriptsMessage")},i.createElement(st,null),i.createElement(ht,null,i.createElement(Ye._,{styles:yt(e.theme,!0,!0)},b.isTeamOwnershipUXEnabled()?strings.Backstage.NoRecentScriptsMessageHeader:strings.Backstage.NoScriptsMessageHeader),i.createElement(Ye._,{styles:yt(e.theme,!1,!1)},xt()),i.createElement(J.r,{href:"https://docs.microsoft.com/office/dev/scripts/tutorials/excel-office-scripts-tutorial",target:"_blank",styles:(0,D.Ti)(e.theme)},strings.Backstage.LearnMoreLink)),b.isTeamOwnershipUXEnabled()&&E)),k=b.isTeamOwnershipUXEnabled()?!e.hasReceivedMRUMetadata||e.mruScripts.length>0?i.createElement(i.Fragment,null,i.createElement(Z,{theme:e.theme,"data-testid":(0,u.k)("BackstageMainRecentScriptsList"),items:e.mruScripts,shouldShowShimmer:!e.hasReceivedMRUMetadata,openScript:wt(e,"Backstage My Scripts"),addButtonToWorkbook:e.addButtonToWorkbook,showConnectionPage:c}),E):w:!e.hasReceivedMetadata||e.recentScripts.length>0?i.createElement(Z,{theme:e.theme,"data-testid":(0,u.k)("BackstageMainRecentScriptsList"),items:e.recentScripts,shouldShowShimmer:!e.hasReceivedMetadata,openScript:wt(e,"Backstage My Scripts"),addButtonToWorkbook:e.addButtonToWorkbook,showConnectionPage:c}):w,P=((t={})[at.Recent]=k,t[at.Attached]=!e.hasLoadedAttachedScripts||e.hasLoadedAttachedScripts&&e.docAttachedScripts.length>0?i.createElement(Z,{theme:e.theme,"data-testid":(0,u.k)("BackstageMainDocAttachedScriptsList"),items:e.docAttachedScripts,shouldShowShimmer:!e.hasLoadedAttachedScripts,openScript:wt(e,"Backstage This Workbook"),addButtonToWorkbook:e.addButtonToWorkbook,showConnectionPage:c}):i.createElement(gt,{"data-testid":(0,u.k)("BackstageNoAttachedScriptsMessage")},i.createElement(ht,null,i.createElement(Ye._,{styles:yt(e.theme,!0,!1)},strings.Backstage.NoAttachedScriptsMessageText),p&&i.createElement(J.r,{href:"https://go.microsoft.com/fwlink/?linkid=2157324",target:"_blank",onClick:function(){return(0,l.ve)({eventName:"FollowLink",eventType:"User",data:{id:"ThisWorkbookEmptyStateLink",hasReceivedMetadata:e.hasReceivedMetadata,recentScriptsNum:e.recentScripts.length}})},styles:(0,D.Ti)(e.theme)},strings.Backstage.NoAttachedScriptsLinkText))),t[at.Samples]=e.sampleScripts.length>0?i.createElement(i.Fragment,null,i.createElement(Z,{theme:e.theme,"data-testid":(0,u.k)("BackstageMainSampleScriptsList"),items:e.sampleScripts,openScript:wt(e,"Backstage Samples"),addButtonToWorkbook:e.addButtonToWorkbook,showConnectionPage:c}),i.createElement(mt,null,i.createElement(J.r,{href:"https://docs.microsoft.com/office/dev/scripts/resources/excel-samples",target:"_blank",styles:(0,D.Ti)(e.theme)},strings.Backstage.MoreSamplesLink))):i.createElement(gt,null,i.createElement(ht,null,i.createElement(Ye._,{styles:yt(e.theme,!0,!0)},strings.Backstage.ComingSoonText),i.createElement(J.r,{href:"https://docs.microsoft.com/office/dev/scripts/tutorials/excel-office-scripts-tutorial",target:"_blank",styles:(0,D.Ti)(e.theme)},strings.Backstage.ComingSoonLink))),t),x=Object.keys(P)[0],C=e.currentPivotKey||x,N=P[C];return i.createElement(dt,{"data-testid":(0,u.k)("Backstage")},i.createElement(f.Z,{header:e.hasHeader?(0,tt._)()?i.createElement(St,null,i.createElement(et.K,{"data-testid":(0,u.k)("BackstageHeaderCreateNewButton"),iconProps:{iconName:"AddIcon"},ariaLabel:strings.Editor.NewScriptButtonText,styles:rt({},(0,D.R4)(e.theme),bt(e.theme)),onClick:lt},strings.Editor.NewScriptButtonText)):i.createElement(Q,{primaryCommands:[{key:(0,u.k)("BackstageHeaderCreateNewButton"),text:strings.Editor.NewScriptButtonText,iconProps:{iconName:"AddIcon"},onClick:lt}],isDetailsPage:!1}):null,main:i.createElement(pt,null,i.createElement(h.Z,{selectedKey:Object.keys(P).includes(C)?C:null,onSelect:function(t){e.setCurrentPivotKey&&e.setCurrentPivotKey(t),(0,l.sM)("Backstage","Backstage",t)},shouldFocus:r,setShouldFocus:o,items:g}),N)}))})),dt=c.ZP.div.withConfig({displayName:"Backstage__BackstageWrapper",componentId:"sc-1hwwlmr-0"})(["padding:0 ",";background:",";height:100%;"],(function(e){return(0,tt._)()?"12px":e.theme.spacing.small}),(function(e){return e.theme.colors.neutralLight})),pt=c.ZP.div.withConfig({displayName:"Backstage__MainWrapper",componentId:"sc-1hwwlmr-1"})(["display:flex;flex-direction:column;height:100%;"]),mt=c.ZP.div.withConfig({displayName:"Backstage__MoreSamplesLinkWrapper",componentId:"sc-1hwwlmr-2"})(["display:flex;justify-content:center;padding-left:0.8rem;padding-top:1rem;"]),gt=c.ZP.div.withConfig({displayName:"Backstage__PivotWrapper",componentId:"sc-1hwwlmr-3"})(["width:100%;height:100%;margin-top:",";display:flex;flex-direction:column;align-items:center;"],(function(e){return e.theme.spacing.large})),ft=c.ZP.div.withConfig({displayName:"Backstage__MyScriptsPivotWrapper",componentId:"sc-1hwwlmr-4"})(["width:100%;height:100%;margin-top:",";display:flex;flex-direction:column;align-items:center;"],(function(e){return e.theme.spacing.large})),ht=c.ZP.div.withConfig({displayName:"Backstage__PivotMessageWrapper",componentId:"sc-1hwwlmr-5"})(["width:60%;display:flex;flex-direction:column;justify-content:stretch;padding:",";font-size:",";text-align:center;"],(function(e){return e.theme.spacing.small}),(function(e){return e.theme.fontSizes.small})),vt=c.ZP.div.withConfig({displayName:"Backstage__ViewMoreScriptsButtonWrapper",componentId:"sc-1hwwlmr-6"})(["display:flex;justify-content:flex-end;width:100%;"]),St=c.ZP.div.withConfig({displayName:"Backstage__FlexWrapper",componentId:"sc-1hwwlmr-7"})(["display:flex;"]),yt=function(e,t,n){return{root:{padding:e.spacing.small,fontSize:t?e.fontSizes.medium:e.fontSizes.small,fontWeight:n?e.fontWeights.semibold:e.fontWeights.regular}}},Et=function(e){return{root:{minWidth:"6.8rem",height:e.spacing.mediumPlus,fontWeight:e.fontWeights.semibold,fontSize:e.fontSizes.small,margin:"0.5rem 1.6rem",color:e.colors.primary},flexContainer:{flexDirection:"row-reverse"}}},bt=function(e){return{root:{height:e.spacing.large}}};function wt(e,t){return function(n,r){e.openScript({id:n.storageScript.id,destination:r}),(0,l.ve)((0,Y.Z)({eventName:"OpenScript",eventType:"User",data:{logLevel:l.in.Information,storageId:n.storageScript.id,entryPoint:t,hasDescription:!!n.storageScript.description,isOwner:(0,Ce.C)(n),driveType:n.storageScript.driveType}}))}}var kt,Pt,xt=function(){var e=strings.Backstage.NoScriptsMessageText,t=e.indexOf("${recordActions}"),n=e.indexOf("${newScript}"),r=i.createElement("b",null,strings.MacroRecorder.RecordActionsButtonText),o=i.createElement("b",null,strings.Editor.NewScriptButtonText);return i.createElement("div",null,t>0&&e.slice(0,t),r,t+16<n&&e.slice(t+16,n),o,n+12<e.length&&e.slice(n+12))},Ct=(0,o.$j)((function(e){return{hasHeader:!0,recentScripts:a.w.scripts.getAllMyScriptsInLastModifiedOrder(e),mruScripts:a.w.scripts.getAllMRUScripts(e),docAttachedScripts:a.w.scripts.getAllDocAttachedScripts(e),hasLoadedAttachedScripts:a.w.scripts.getHasLoadedAttachedScripts(e),sampleScripts:a.w.scripts.getAllSampleScriptsInSortIndexOrder(e),activeScriptId:a.w.editor.getActiveScriptId(e),currentPivotKey:a.w.backstage.getCurrentPivot(e),hasReceivedMetadata:a.w.scripts.getHasReceivedMetadata(e),hasReceivedMRUMetadata:a.w.scripts.getHasReceivedMRUMetadata(e)}}),{invokeSharedFilePicker:a.N.scripts.invokeFilePicker,openScript:a.N.editor.openScript,hideBackstage:function(){return a.N.backstage.hide()},setCurrentPivotKey:a.N.backstage.setCurrentPivot,setIsReactMonacoLoaded:a.N.backstage.setIsReactMonacoLoaded,addButtonToWorkbook:a.N.scripts.addButtonToWorkbook.request})((function(e){var t=e.hasHeader,n=e.hasLoadedAttachedScripts,r=e.hasReceivedMetadata,o=e.hasReceivedMRUMetadata,a=e.recentScripts,s=e.mruScripts,c=e.docAttachedScripts,l=e.sampleScripts,u=e.activeScriptId,d=e.currentPivotKey,p=e.setCurrentPivotKey,m=e.openScript,g=e.invokeSharedFilePicker,f=e.hideBackstage,h=e.addButtonToWorkbook,v=e.showConnectionPage,S=e.setIsReactMonacoLoaded;return i.createElement(ut,{hasHeader:t,hasLoadedAttachedScripts:n,hasReceivedMetadata:r,hasReceivedMRUMetadata:o,recentScripts:a,mruScripts:s,docAttachedScripts:c,sampleScripts:l,activeScriptId:u,currentPivotKey:d,setCurrentPivotKey:p,openScript:m,invokeSharedFilePicker:g,hideBackstage:f,addButtonToWorkbook:h,showConnectionPage:v,setIsReactMonacoLoaded:S})})),Nt=n(63699),Mt=n(45502),Rt=n(59725),It=n(67833);function Bt(e,t){return t||(t=e.slice(0)),e.raw=t,e}function Tt(){return Tt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Tt.apply(this,arguments)}function Dt(e){var t=(0,i.useState)(It.p.instance().getAllSettings()),n=t[0],r=t[1],o=n[e],a=function(e){It.p.instance().updateSetting(e),r(It.p.instance().getAllSettings())},s=Rt.Z[e];if(s.enum)return i.createElement(Mt.Z,{key:e+"_key","data-testid":"testId-"+e,settingTitle:s.userFacingName,currentValue:o,possibleValues:s.enum,displayValues:s.displayText,onChange:function(t){var n;a(((n={})[e]=t,n))}});if("boolean"===typeof s.defaultValue)return i.createElement(Nt.Z,{key:e+"_key","data-testid":"testId-"+e,settingTitle:s.userFacingName,checked:o,onChange:function(t){var n;a(((n={})[e]=t,n))}});throw new Error('Unsupported type for default setting setting "'+e+'"')}var Ot,Lt,At,zt,Zt=(0,c.Zz)((function(e){(0,i.useEffect)((function(){window.document.title=strings.PageTitles.CodeEditorSettings}));var t=i.createRef();(0,i.useEffect)((function(){t.current&&t.current.focus()}),[t]);var n=Object.keys(Rt.Z),r=n.filter((function(e){return void 0===Rt.Z[e].flightName})),o=n.filter((function(e){var t=Rt.Z[e].flightName;if(t){var n=(0,Te.HQ)(t);return"OfficeScriptConnection"===t?n&&!(0,Te.HQ)("OfficeScriptConnectionOn"):n}return!1}));return i.createElement(Ft,{"data-testid":(0,u.k)("MainEditorSettingsPane")},i.createElement(Wt,null,i.createElement(et.K,{"data-testid":(0,u.k)("SettingsPaneBackButton"),iconProps:{iconName:(0,B.zg)()?"BackArrowRtl":"BackArrow"},ariaLabel:strings.General.BackButtonText,allowDisabledFocus:!0,componentRef:t,onClick:function(){e.hideSettingsPage()},styles:Tt({},_t(e.theme),(0,D.R4)(e.theme))}),i.createElement(Ye._,{styles:Ut(e.theme)},strings.Editor.EditorSettingsLabel)),r.map((function(e){return Dt(e)})),o.map((function(e){return Dt(e)})),i.createElement(Wt,null,i.createElement(J.r,{"data-testid":(0,u.k)("SettingsPaneLearnMoreLink"),href:"https://docs.microsoft.com/office/dev/scripts",target:"_blank",styles:Ht(e.theme)},strings.Editor.LearnMoreLink)))})),Ft=c.ZP.div(kt||(kt=Bt(["\n  height: 100%;\n  width: 100%;\n  padding: 0 ",";\n  overflow: auto;\n"])),(function(e){return e.theme.spacing.medium})),Wt=c.ZP.div(Pt||(Pt=Bt(["\n  display: flex;\n"]))),_t=function(e){return{root:{fontWeight:e.fontWeights.semibold,fontSize:e.fontSizes.mediumPlus,paddingLeft:e.spacing.xSmall,paddingRight:e.spacing.xSmall,marginRight:e.spacing.small},icon:{fontSize:e.fontSizes.icon}}},Ut=function(e){return{root:{fontWeight:e.fontWeights.semibold,fontSize:e.fontSizes.mediumPlus,margin:"auto 0"}}},Ht=function(e){return{root:Tt({},(0,D.Ti)(e).root,{margin:".8rem"})}};function jt(e,t){return t||(t=e.slice(0)),e.raw=t,e}var Vt,Kt=(0,c.Zz)((function(e){return i.createElement(i.Fragment,null,i.createElement(Xt,null,i.createElement(y.q,{shimmerColors:Gt(e.theme),shimmerElements:[{type:E.s.line,height:20,width:"50%"},{type:E.s.gap,width:"50%"}]})),i.createElement($t,null,i.createElement(y.q,{shimmerColors:Gt(e.theme),shimmerElements:[{type:E.s.line,height:20,width:"10%"},{type:E.s.gap,width:"2%"},{type:E.s.line,height:20,width:"10%"},{type:E.s.gap,width:"2%"},{type:E.s.line,height:20,width:"10%"},{type:E.s.gap,width:"66%"}]})),i.createElement(qt,null,i.createElement(Qt,null,i.createElement(y.q,{shimmerColors:Gt(e.theme),shimmerElements:[{type:E.s.line,height:16,width:"70%"},{type:E.s.gap,width:"30%"}]}))),i.createElement(qt,null,i.createElement(Qt,null,i.createElement(y.q,{shimmerColors:Gt(e.theme),shimmerElements:[{type:E.s.line,height:16,width:"30%"},{type:E.s.gap,width:"70%"}]})),i.createElement(Qt,null,i.createElement(y.q,{shimmerColors:Gt(e.theme),shimmerElements:[{type:E.s.line,height:16,width:"50%"},{type:E.s.gap,width:"50%"}]}))))})),Gt=function(e){return{shimmer:e.colors.neutralQuaternaryAlt,shimmerWave:e.colors.neutralQuaternary,background:e.colors.neutralLight}},Xt=c.ZP.div(Ot||(Ot=jt(["\n  padding: 0.6rem 0;\n"]))),$t=c.ZP.div(Lt||(Lt=jt(["\n  padding: 0.8rem 0;\n"]))),qt=c.ZP.div(At||(At=jt(["\n  padding: 1rem 0;\n"]))),Qt=c.ZP.div(zt||(zt=jt(["\n  padding: 0.6rem 0;\n"])));function Yt(){return Yt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Yt.apply(this,arguments)}var Jt=(0,c.Zz)((function(e){var t=e.theme,n=e.returnToPreviousPage,r=i.createRef();return(0,i.useEffect)((function(){r.current&&r.current.focus()}),[]),i.createElement(en,null,i.createElement(et.K,{"data-testid":(0,u.k)("DetailsPageBackButton"),iconProps:{iconName:(0,B.zg)()?"BackArrowRtl":"BackArrow"},ariaLabel:strings.General.BackButtonText,allowDisabledFocus:!0,componentRef:r,onClick:function(){n()},styles:Yt({},tn(t),(0,D.R4)(t))}),i.createElement(Ye._,{styles:nn(t)},e.buttonText))})),en=c.ZP.div(Vt||(Vt=function(e,t){return t||(t=e.slice(0)),e.raw=t,e}(["\n  display: flex;\n"]))),tn=function(e){return{root:{fontSize:e.fontSizes.mediumPlus,height:(0,tt._)()?"32px":void 0,padding:(0,tt._)()?"0px":void 0},icon:{fontSize:e.fontSizes.icon,paddingTop:(0,tt._)()?"1px":"0.2rem"}}},nn=function(e){return{root:{fontWeight:e.fontWeights.regular,fontSize:(0,tt._)()?e.fontSizes.medium:e.fontSizes.mediumPlus,paddingLeft:(0,tt._)()?"4px":e.spacing.small,margin:"auto 0"}}},rn=n(88475),on=n(31746),an=n(75099),sn=n(97524),cn=n(62680),ln=["text","makeEdit","onBlurAction","readOnly","fontWeight","fontSize","multilineTextfield","placeholderText","takerLabelRole","theme","getErrorMessage","errorDeferredValidationTime","buttonTestId","originalPage","editMode","setEditMode","shouldFocus","setShouldFocus","sendButtonClickTelemetry","setButtonHasFocus","onEscapeAction"];function un(){return un=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},un.apply(this,arguments)}var dn,pn,mn=(0,c.Zz)((function(e){var t=e.text,n=e.makeEdit,r=e.onBlurAction,o=e.readOnly,a=e.fontWeight,s=e.fontSize,c=e.multilineTextfield,u=e.placeholderText,d=e.takerLabelRole,p=e.theme,m=e.getErrorMessage,g=e.errorDeferredValidationTime,f=e.buttonTestId,h=e.originalPage,v=e.editMode,S=e.setEditMode,y=e.shouldFocus,E=e.setShouldFocus,b=e.sendButtonClickTelemetry,w=e.setButtonHasFocus,k=e.onEscapeAction,P=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,ln);if(!t&&!u)return null;var x=i.createRef();return(0,i.useEffect)((function(){x.current&&!v&&y&&x.current.focus(),E(!1)}),[v,y]),i.createElement("div",un({},P,{style:"Editor"===h?{width:"100%",minWidth:"0",display:"flex",alignItems:"center",wordBreak:"break-word"}:{width:"100%",display:"flex",alignItems:"center",wordBreak:"break-word"}}),o?t?i.createElement(Ye._,{role:d||"heading",styles:hn(p,a,s,h)},t):null:v?i.createElement(cn.n,{onKeyDown:function(e){if("Enter"===e.key)if(c&&e.shiftKey)t.split("\n").length<6?t+="\n":e.preventDefault();else{e.preventDefault();try{r(),E(!0),S(!1)}catch(n){}}else"Escape"===e.key&&(k(),E(!0),S(!1))},onChange:function(e,t){void 0!==t&&null!==t?n(t):(0,l.m)(new Error("Unexpected null or undefined TextField value"),l.in.Error)},onBlur:function(){try{r(),void 0!==w&&w(!1),S(!1)}catch(e){}},autoFocus:!0,contentEditable:!0,deferredValidationTime:g,onGetErrorMessage:m,defaultValue:t,styles:Sn(p,a,s,h),multiline:c,autoAdjustHeight:c}):i.createElement(R.G,{content:u,overflowMode:I.y.Self,styles:gn(h),calloutProps:(0,D.FA)(p)},i.createElement(sn.Y,{"data-testid":f,onClick:function(){S(!o),void 0!=b&&b()},text:t||u,styles:fn({theme:p,textFontWeight:a,textFontSize:s,readOnly:o,multilineTextfield:c,placeholderOnly:!t,originalPage:h}),ariaLabel:strings.substitute(strings.Details.EditableLabelAriaLabel,{editableLabelContents:t||u}),componentRef:x})))})),gn=function(e){return"Editor"===e?{root:{width:"100%",margin:(0,tt._)()?"0 8px":"0 0.7rem",minWidth:"0"}}:{root:{width:"100%"}}},fn=function(e){var t=e.theme,n=e.textFontWeight,r=e.multilineTextfield,i=e.placeholderOnly,o=e.textFontSize,a=e.originalPage;return{root:{padding:"Details"===a?"0.2rem 0":"0.6rem 0",background:"none",border:"none",width:"100%",maxWidth:"101%",cursor:"pointer",textAlign:"left",margin:"Editor"===a?"0 0.1rem 0.2rem 0.1rem":"0.1rem",selectors:{"&:focus":{outline:"none"}},textOverflow:r?"inherit":"ellipsis",whiteSpace:r?"pre-wrap":"nowrap",overflow:r?"visible":"hidden"},textContainer:{padding:"0.6rem 0",fontSize:o||t.fontSizes.medium,fontWeight:n||t.fontWeights.semibold,color:t.colors.neutralPrimary,textAlign:"left"},label:{color:i?t.colors.neutralSecondary:t.colors.neutralPrimary,textAlign:"left"}}},hn=function(e,t,n,r){var i=(0,D.xm)(e,t,n);return"Editor"===r?{root:un({},i,{margin:"0 0.7rem"})}:i},vn=function(e,t,n){return{field:{fontSize:n||e.fontSizes.medium,fontWeight:t||e.fontWeights.semibold,color:e.colors.neutralPrimary,backgroundColor:e.colors.neutralLighterAlt},fieldGroup:{borderWidth:"1px",selectors:{"::after":{borderWidth:"1px"}}},errorMessage:{fontSize:e.fontSizes.small,color:e.colors.redText}}},Sn=function(e,t,n,r){return un({},vn(e,t,n),"Editor"===r?{root:{width:"100%",minWidth:"0",margin:"0 0.3rem 0.2rem"}}:{root:{width:"100%",margin:"0rem 0 0.1rem"}})},yn=n(84195),En=n(84824),bn=n(49282);function wn(e,t){return t||(t=e.slice(0)),e.raw=t,e}var kn=(0,c.Zz)((function(e){var t=e.theme,n=e.isScriptShared,r=n?strings.Details.CurrentOrgHasAccessText:strings.Details.OnlyCurrentUserHasAccessText;return i.createElement(i.Fragment,null,i.createElement(Pn,{role:"gridcell"},n?i.createElement(xn,null,i.createElement(bn.xu,{iconName:"WorkbookSharingToken24"})):i.createElement(xn,null,i.createElement(bn.xu,{iconName:"ProtectForm"})),i.createElement(Ye._,{styles:Cn(t),"data-testid":(0,u.k)("AccessInThisWorkbookText")},r)))})),Pn=c.ZP.div(dn||(dn=wn(["\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n  padding-top: ",";\n"])),(function(e){return e.theme.spacing.xSmall})),xn=c.ZP.div(pn||(pn=wn(["\n  padding: ",";\n"])),(function(e){return(0,B.zg)()?"0 0 0 "+e.theme.spacing.medium:"0 "+e.theme.spacing.medium+" 0 0"})),Cn=function(e){return{root:{fontSize:e.fontSizes.small,color:e.colors.neutralPrimary,fontWeight:e.fontWeights.regular}}},Nn=function(e,t,n){return!!e&&(0,Me.o)(e)&&!n&&!t},Mn=n(90828),Rn=(0,c.Zz)((function(e){var t=e.isScriptRunning,n=e.isStorageCallInProgress,r=e.script,o=e.theme,a=Nn(r,t,n);return i.createElement(i.Fragment,null,i.createElement(J.r,{onClick:function(){return Ie.u.store.dispatch(Mn.N.consentDialog.show())},styles:In(o,a),disabled:!a},strings.Details.RunPermissionsLinkText))})),In=function(e,t){return{root:{fontSize:e.fontSizes.small,color:t?e.colors.linkText:e.colors.neutralSecondary,selectors:{":focus":{color:e.colors.linkText},":hover":{color:t?e.colors.linkTextHovered:e.colors.neutralSecondary,textDecoration:t?"underline":"none"}},cursor:t?"pointer":"not-allowed"}}},Bn=(0,c.Zz)((function(e){var t=e.isScriptRunning,n=e.isStorageCallInProgress,r=e.script,o=e.theme,a=Nn(r,t,n);return i.createElement(i.Fragment,null,i.createElement(J.r,{onClick:function(){return Ie.u.store.dispatch(Mn.N.permissionDialog.show())},styles:Tn(o,a),disabled:!a},strings.Details.ScriptPermissionsLinkText))})),Tn=function(e,t){return{root:{fontSize:e.fontSizes.small,color:t?e.colors.linkText:e.colors.neutralSecondary,selectors:{":focus":{color:e.colors.linkText},":hover":{color:t?e.colors.linkTextHovered:e.colors.neutralSecondary,textDecoration:t?"underline":"none"}},cursor:t?"pointer":"not-allowed"}}},Dn=n(67796),On=n(1645),Ln=n(32613),An=n(44444),zn=n(72558),Zn=n(78015),Fn=n(34961),Wn=(0,c.Zz)((function(e){var t=e.scriptRecentVersions.map((function(t){return{lastModifiedByLabel:t.lastModifiedByUser===e.currentUserId?strings.Details.MakerLastEditedLabel:strings.substitute(strings.Details.TakerLastEditedLabel,{ScriptOwner:t.lastModifiedByUserName}),lastModifiedByDate:t.dateLastModified}}));return(0,zn.J)(e.script)?i.createElement(Zn.a,{items:t,onRenderCell:function(t){return t?_n(e.theme,t.lastModifiedByLabel,t.lastModifiedByDate):null},role:"presentation","aria-label":strings.Details.ScriptActivitySection}):null})),_n=function(e,t,n){return i.createElement(Un,{role:"row"},i.createElement(Hn,{role:"gridcell"},i.createElement(jn,null,i.createElement(bn.xu,{iconName:"EditGeneric24"})),i.createElement("div",null,i.createElement(Ye._,{id:"last-saved-date-label",styles:{root:{fontSize:e.fontSizes.small,fontWeight:e.fontWeights.regular,padding:"5px 0 0"}}},t),i.createElement(Ye._,{"aria-labelledby":"last-saved-date-label",styles:{root:{fontSize:e.fontSizes.small,fontWeight:e.fontWeights.regular,padding:"0 0 5px"}}},new Date(n).toLocaleString((0,Fn.O3)())))))},Un=c.ZP.div.withConfig({displayName:"ActivitySection__SectionWrapper",componentId:"sc-1l54m8t-0"})(["padding:10px 20px 14px 20px;"]),Hn=c.ZP.div.withConfig({displayName:"ActivitySection__FlexWrapper",componentId:"sc-1l54m8t-1"})(["display:flex;align-items:center;justify-content:flex-start;"]),jn=c.ZP.div.withConfig({displayName:"ActivitySection__IconWrapper",componentId:"sc-1l54m8t-2"})(["padding:",";"],(function(e){return(0,B.zg)()?"0 0 0 "+e.theme.spacing.medium:"0 "+e.theme.spacing.medium+" 0 0"})),Vn=n(45912);function Kn(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,i)}function Gn(e,t){return Gn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Gn(e,t)}var Xn=function(e){var t,n;function r(t){var n;return n=e.call(this)||this,Object.defineProperty(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(n),"storage",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),n.storage=t,n}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,Gn(t,n);var i=r.prototype;return i.getValue=function(){var t,n=(t=regeneratorRuntime.mark((function t(n){var r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.isCached(n),t.next=3,e.prototype.getValue.call(this,n);case 3:return i=t.sent,r||this.setValue(n,i),t.abrupt("return",i);case 6:case"end":return t.stop()}}),t,this)})),function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(e){Kn(o,r,i,a,s,"next",e)}function s(e){Kn(o,r,i,a,s,"throw",e)}a(void 0)}))});return function(e){return n.apply(this,arguments)}}(),i.setValue=function(t,n){e.prototype.setValue.call(this,t,n),this.storage.write(this.innerKey(t),n)},i.isCached=function(t){if(!e.prototype.isCached.call(this,t)){var n=this.innerKey(t),r=this.storage.read(n);return!!r&&(e.prototype.setValue.call(this,t,r),!0)}return!0},i.forget=function(t){e.prototype.forget.call(this,t),this.storage.purge(this.innerKey(t))},r}(n(55048).q),$n=n(56222),qn=n(83359),Qn=n(66052),Yn=n(39711);function Jn(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,i)}var er=function(){Object.defineProperty(this,"getUsers",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new l.pX("GetUsersFromStorage","System",[{level:l.in.ASHA,timeout:l.NJ.UserUnsatisfied}]),e.prev=1,e.next=4,(0,Yn.$I)((function(e){return(0,yn.Rf)(e,t)}),n,(function(){return!1}));case 4:return r=e.sent,n.succeed(l.in.Information,{missingUsers:t.length-r.length}),e.abrupt("return",r);case 9:throw e.prev=9,e.t0=e.catch(1),n.fail(l.in.ASHA,{},e.t0),e.t0;case 13:case"end":return e.stop()}}),e,null,[[1,9]])})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Jn(o,r,i,a,s,"next",e)}function s(e){Jn(o,r,i,a,s,"throw",e)}a(void 0)}))});return function(e){return t.apply(this,arguments)}}()})};function tr(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,i)}var nr=function(){};function rr(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,i)}function ir(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){rr(o,r,i,a,s,"next",e)}function s(e){rr(o,r,i,a,s,"throw",e)}a(void 0)}))}}function or(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ar(e,t){return ar=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ar(e,t)}Object.defineProperty(nr,"_instance",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(nr,"instance",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e,t=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(nr._instance){e.next=7;break}e.t0=(0,qn.mi)(),e.next=e.t0===qn.B1.makerserviceprodnew||e.t0===qn.B1.makerserviceint||e.t0===qn.B1.makerservicetest||e.t0===qn.B1.makerservicelocal?4:e.t0===qn.B1.localstorage?5:6;break;case 4:return e.abrupt("return",nr._instance=new er);case 5:return e.abrupt("return",(0,Qn.S)("LocalStorageUsers",(function(){return n.e(1854).then(n.bind(n,61326))})).then((function(e){return nr._instance=new e.LocalStorageUsers})));case 6:throw new Error(qn.Qg);case 7:return e.abrupt("return",nr._instance);case 8:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){tr(o,r,i,a,s,"next",e)}function s(e){tr(o,r,i,a,s,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}()});var sr=function(e){var t,n;function r(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t=e.call.apply(e,[this].concat(r))||this,Object.defineProperty(or(t),"innerKey",{configurable:!0,enumerable:!0,writable:!0,value:function(e){return e}}),or(t)||or(t)}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,ar(t,n);var i=r.prototype;return i.getImpl=function(){var e=ir(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getManyImpl([t]);case 2:return n=e.sent,e.abrupt("return",n[0]);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),i.getManyImpl=function(){var e=ir(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],e.next=3,nr.instance();case 3:return r=e.sent,e.next=6,r.getUsers(t);case 6:return n=e.sent,e.abrupt("return",t.map((function(e){return n.find((function(t){return t.id===e}))})));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r}(Xn);Object.defineProperty(sr,"_instance",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(sr,"instance",{configurable:!0,enumerable:!0,writable:!0,value:function(){if(!sr._instance){sr._instance=new sr(new $n.sH("users",2e4,6048e5,{compare:$n.iQ,canPurge:function(){return!0}}))}return sr._instance}});var cr=n(28041);function lr(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,i)}var ur,dr,pr,mr,gr,fr=function(e,t,n,r){var o={users:[],numConsented:0},a=(0,i.useState)(o),s=a[0],c=a[1];return(0,i.useEffect)((function(){if(t&&!(0,Dn.a)(t)&&!(0,Ln.H)(t)){var n=function(){var n,r=(n=regeneratorRuntime.mark((function n(){var r,i;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,cr.q.instance();case 2:return r=n.sent,n.next=5,r.getScriptConsentRecord(t);case 5:(i=n.sent)?sr.instance().getValues(i.userIds).then((function(t){if(e.current){var n=t.length,r=t.filter((function(e){return!!e}));c({numConsented:n,users:r})}})).catch((function(){})):e.current&&c(o);case 7:case"end":return n.stop()}}),n)})),function(){var e=this,t=arguments;return new Promise((function(r,i){var o=n.apply(e,t);function a(e){lr(o,r,i,a,s,"next",e)}function s(e){lr(o,r,i,a,s,"throw",e)}a(void 0)}))});return function(){return r.apply(this,arguments)}}();n()}}),[e,t,n,r]),s},hr=n(26634),vr=n(57464);function Sr(e,t){return t||(t=e.slice(0)),e.raw=t,e}function yr(){return yr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yr.apply(this,arguments)}var Er=(0,c.Zz)((function(e){var t=e.theme,n=e.script,r=e.isPermissionDialogOpen,o=e.isConsentDialogOpen,a=e.isScriptRunning,s=e.isStorageCallInProgress,c=n&&n.storageScript.description?n.storageScript.description:"",l=(0,i.useState)(c),u=l[0],d=l[1],p=(0,i.useState)((0,yn.bt)(u)),m=p[0],g=p[1],f=(0,i.useState)(!1),h=f[0],v=f[1],S=(0,i.useState)(!1),y=S[0],E=S[1],b=br(),w=wr(b,n),k=kr(b),P=fr(b,n,r,o),x=Pr(b,n,o);(0,i.useEffect)((function(){n.storageScript.description&&d(n.storageScript.description)}),[n.storageScript.description]);var C=!1;return C=(0,Te.HQ)("EnablePermissionDialog")?!(0,Dn.a)(n)&&!(0,Ln.H)(n)&&P.numConsented>0:!(0,Dn.a)(n)&&!(0,Ln.H)(n)&&x.length>0,i.createElement(Ir,null,i.createElement(rn.M,{items:Mr(n,w,k,C,c,u,d,m,g,t,h,v,y,E,a,s),onRenderCell:xr,groups:Rr(n,C),groupProps:Nr(t),selectionMode:on.oW.none}))})),br=function(){var e=(0,i.useRef)(!1);return(0,i.useEffect)((function(){return e.current=!0,function(){e.current=!1}}),[]),e},wr=function(e,t){var n=(0,i.useState)([]),r=n[0],o=n[1];return(0,i.useEffect)((function(){(0,An.W9)(t).then((function(t){e.current&&o(t.slice(0,6))})).catch((function(){}))}),[e,t]),r},kr=function(e){var t=(0,i.useState)(""),n=t[0],r=t[1];return(0,i.useEffect)((function(){try{(0,Vn.Z)().then((function(t){e.current&&r(t.UserId)}))}catch(t){}}),[e]),n},Pr=function(e,t,n){var r=(0,i.useState)([]),o=r[0],a=r[1];return(0,i.useEffect)((function(){(0,Ln.H)(t)||(0,Dn.a)(t)||hr.T.instance().getValue(t).then((function(t){e.current&&a(t)})).catch((function(){}))}),[e,t,n]),o},xr=function(e,t,n){return t&&"number"===typeof n&&n>-1?t:null},Cr=function(e){var t=function(){null!=e&&e.onToggleCollapse&&e.group&&(null==e||e.onToggleCollapse(e.group));var t=null==e?void 0:e.group;if(t&&t.data){var n=(0,On.Fy)(t.data.storageId);n.storageId=t.data.storageId,n.isOwner=t.data.isOwner;var r=t.key;n.groupSectionStatus[r]=!n.groupSectionStatus[r],(0,On.vf)(t.data.storageId,n)}};return i.createElement(an.t,yr({},e,{onToggleCollapse:t,onToggleSelectGroup:t}))},Nr=function(e){return{headerProps:{styles:{groupHeaderContainer:{height:"32px",width:"auto",border:"1px solid transparent",boxSizing:"border-box",whiteSpace:"nowrap"},headerCount:{display:"none"},title:{display:"inline-block",fontSize:"14px",cursor:"default",padding:"3px 0 3px 0",lineHeight:"24px",whiteSpace:"nowrap",verticalAlign:"middle"},root:{border:"none",selectors:{":hover":{backgroundColor:e.colors.neutralQuaternaryAlt}}}},expandButtonIcon:"ChevronRight",expandButtonProps:{"aria-label":strings.General.CollapseText,style:{display:"inline-block",height:"32px",width:"auto",margin:(0,B.zg)()?"4px 0 0 8px":"4px 8px 0 0",backgroundColor:"transparent",verticalAlign:"middle",color:e.colors.neutralDark}}},onRenderHeader:Cr}},Mr=function(e,t,n,r,o,a,s,c,d,p,m,g,f,h,v,S){var y=[i.createElement(Br,{key:"DescriptionWrapper",role:"row"},i.createElement(Or,{editMode:m,role:"gridcell"},i.createElement(mn,{"data-testid":(0,u.k)("DetailsPageDescriptionInput"),buttonTestId:(0,u.k)("DetailsPageDescriptionInputButton"),text:(0,Ce.C)(e)?a:a||strings.Editor.EmptyDescriptionTaker,readOnly:!(0,Ce.C)(e),makeEdit:function(e){s(e),d((0,yn.bt)(e))},fontSize:p.fontSizes.small,fontWeight:p.fontWeights.regular,multilineTextfield:!0,placeholderText:strings.Details.ScriptDescriptionPlaceholderText,onEscapeAction:function(){s(o)},onBlurAction:function(){c&&a!==o&&(Be.P.instance(Ie.u.store).saveScript(e,{description:a}),(0,l.ve)((0,Y.Z)({eventName:"EditScriptProperties",eventType:"User",data:{logLevel:l.in.Information,storageId:e.storageScript.id,entryPoint:"Group Sections",propertyName:"Description"}})))},takerLabelRole:"complementary",editMode:m,setEditMode:g,shouldFocus:f,setShouldFocus:h}))),i.createElement(Br,{key:"ScriptAccessWrapper",role:"row"},i.createElement(kn,{isScriptShared:(0,En.o)(e)||(0,vr.$)(e)})),i.createElement("div",{key:"ScriptActivityWrapper",role:"presentation"},i.createElement(Wn,{script:e,scriptRecentVersions:t,currentUserId:n}))];return r&&((0,Te.HQ)("EnablePermissionDialog")?y.push(i.createElement("div",{key:"SecurityWrapper",role:"row"},i.createElement(Br,{role:"gridcell"},i.createElement(Ye._,{styles:Lr(p),"data-testid":(0,u.k)("ChangesAsOwnEditsText")},strings.Details.ChangesAsOwnEditsText),i.createElement(Tr,null,i.createElement(Bn,{isScriptRunning:v,isStorageCallInProgress:S,script:e}))))):y.push(i.createElement("div",{key:"SecurityWrapper",role:"row"},i.createElement(Br,{role:"gridcell"},i.createElement(Dr,null,i.createElement(Rn,{isScriptRunning:v,isStorageCallInProgress:S,script:e})))))),y},Rr=function(e,t){var n=(0,On.Fy)(e.storageScript.id),r=[{key:"descriptionGroup",isCollapsed:n.groupSectionStatus.descriptionGroup,name:strings.Details.DescriptionSection,startIndex:0,count:1,data:{storageId:e.storageScript.id,isOwner:(0,Ce.C)(e)}},{key:"scriptAccessGroup",isCollapsed:n.groupSectionStatus.scriptAccessGroup,name:strings.Details.ScriptAccessSection,startIndex:1,count:1,data:{storageId:e.storageScript.id,isOwner:(0,Ce.C)(e)}},{key:"scriptActivityGroup",isCollapsed:n.groupSectionStatus.scriptActivityGroup,name:strings.Details.ScriptActivitySection,startIndex:2,count:1,data:{storageId:e.storageScript.id,isOwner:(0,Ce.C)(e)}}];return t&&r.push({key:"securityGroup",isCollapsed:n.groupSectionStatus.securityGroup,name:strings.Details.SecuritySection,startIndex:3,count:1,data:{storageId:e.storageScript.id,isOwner:(0,Ce.C)(e)}}),r},Ir=c.ZP.div(ur||(ur=Sr(["\n  padding: ",";\n"])),(0,tt._)()?"0.8rem 1.6rem 1.2rem":"0.8rem 2rem 1.2rem"),Br=c.ZP.div(dr||(dr=Sr(["\n  padding: 10px 20px 14px 20px;\n"]))),Tr=c.ZP.div(pr||(pr=Sr(["\n  padding-top: ",";\n"])),(function(e){return e.theme.spacing.xSmall})),Dr=c.ZP.div(mr||(mr=Sr(["\n  padding-top: ",";\n"])),(function(e){return e.theme.spacing.xSmall})),Or=c.ZP.div(gr||(gr=Sr(["\n  &:focus-within {\n    outline: ",";\n  }\n"])),(function(e){return e.editMode?"none":"1px solid "+e.theme.colors.neutralSecondary})),Lr=function(e){return{root:{fontSize:e.fontSizes.small,color:e.colors.neutralPrimary,fontWeight:e.fontWeights.regular}}},Ar=n(18421),zr=n(32406),Zr=n(88360),Fr=n(47180),Wr=function(){return(0,me.Z)()&&(0,pe.e8)()&&!(0,He.jN)("OfficeScriptsWin32CRUD")},_r=n(27062),Ur=n(70530),Hr=n(22377);function jr(){return jr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jr.apply(this,arguments)}var Vr=(0,c.Zz)((function(e){var t=(0,Ar.n)(e.script,e.isScriptRunning,e.isRecorderRecording),n={additionalStyles:(0,U.oF)(e.theme.fontSizes.medium,e.theme,!t)},r=[(0,Ur.Gu)((0,u.k)("DetailsPageRunButton"),e.script,t,"Details Page",e.isRecorderRecording,n),(0,Ur.OC)((0,u.k)("DetailsPageEditButton"),(function(){e.setNavigationSourcePage("Details"),e.openScriptInEditor()}),n)],o=Wr()?[]:Xr(jr({},e,{isRunButtonEnabled:t}));return i.createElement(Kr,null,i.createElement(Gr,null,i.createElement(Q,{primaryCommands:r,overflowCommands:o,isDetailsPage:!0})))})),Kr=c.ZP.div.withConfig({displayName:"ActionsSection__Wrapper",componentId:"sc-1u52cw9-0"})(["display:flex;"]),Gr=c.ZP.div.withConfig({displayName:"ActionsSection__CommandBarWrapper",componentId:"sc-1u52cw9-1"})(["padding:0.6rem 0.5rem 0.7rem;width:100%;"]),Xr=function(e){var t,n,r,i,o=e.script,a=e.isStorageCallInProgress,s=e.showConnectionPage,c=(0,Ce.C)(o),d=(0,En.o)(o),p=!d&&c&&e.isSharingEnabled,m=(0,zr.E)(o,e.isScriptRunning,e.isStorageCallInProgress),g=(0,Ur.Gu)((0,u.k)("DetailsPageOverflowRunButton"),e.script,e.isRunButtonEnabled,"Details Page",e.isRecorderRecording),f=(0,Ur.OC)((0,u.k)("DetailsPageOverFlowEditButton"),(function(){e.setNavigationSourcePage("Details"),e.openScriptInEditor()})),h=(0,_r.c)({entryPoint:Hr.N.DetailsPageOverflowButton,script:o,isStorageCallInProgress:a,callback:s}),v=(0,Ur.TW)((0,u.k)("DetailsPageShareButton"),d,e.isSharingEnabled),S=(0,Ur.O8)((0,u.k)("DetailsPageStopSharingButton")),y=(0,Ur.LY)((0,u.k)("Divider")+"DetailsPage1"),E=(0,Ur.lq)((0,u.k)("DetailsPageDeleteButton"),e.script,m),b=function(e,t){var n=(0,Zr.E)(e,t,!1);return nt.X.instance().isTeamOwnershipUXEnabled()?(0,Ur.co)((0,u.k)("DetailsPageCopyToButton"),n,(function(){Be.P.instance(Ie.u.store).makeACopyTo(e,"Details")})):(0,Ur.xT)((0,u.k)("DetailsPageCopyButton"),n,(function(){Be.P.instance(Ie.u.store).makeACopyOfScript(e.storageScript.id,"Details")}))}(o,e.isScriptRunning),w=function(e){var t=(0,Fr.I)(e.script,e.isStorageCallInProgress);return(0,Ur.sI)((0,u.k)("DetailsPageRenameButton"),t,(function(){e.editMode||e.setEditMode(!0),(0,l.ve)({eventName:"ControlAction",eventType:"User",data:{control:"RenameButton",location:"Overflow"}})}))}(e),k=(0,Ur.LY)((0,u.k)("Divider")+"DetailsPage2"),P=(0,Ur.mw)((0,u.k)("DetailsPageFlowButton"),e.script,"Details"),x=(0,Ur.kQ)((0,u.k)("DetailsPageAddButtonToWorkbookButton"),e.script,e.isSharingEnabled,e.addButtonToWorkbook),C=(t=e.theme,n=e.overflowButtonRef,r=e.isMenuOpened,i=e.setIsMenuOpened,{key:"OverflowStylesCarrier",additionalStyles:(0,U.Tt)(t),isMenuOpened:r,setIsMenuOpened:i,calloutBackgroundColor:t.colors.neutralLighterAlt,overflowButtonRef:n});return[g,f].concat(h,[p&&v,d&&S,y,E,w,b,k,P,x,C]).filter(Boolean)};function $r(e,t){return!t.some((function(t){return t.toUpperCase()===e.toUpperCase()}))}var qr,Qr,Yr=(0,c.Zz)((function(e){return i.createElement(mn,{"data-testid":(0,u.k)("ScriptNameEditableLabel"),buttonTestId:(0,u.k)("ScriptNameEditableLabelButton"),text:e.scriptName,originalPage:e.originalPage,readOnly:e.isReadOnly,editMode:e.editorNameEditMode,setEditMode:e.setEditorNameEditMode,makeEdit:function(t){e.setScriptName(t)},onEscapeAction:function(){e.setScriptName(e.savedScriptName)},onBlurAction:function(){if("None"!==(0,yn.gt)(e.scriptName).error||!$r(e.scriptName,e.otherScriptNames))throw new Error("Invalid name");e.scriptName!==e.savedScriptName&&(Be.P.instance(Ie.u.store).saveScript(e.script,{name:e.scriptName}),(0,l.ve)((0,Y.Z)({eventName:"EditScriptProperties",eventType:"User",data:{logLevel:l.in.Information,storageId:e.script.storageScript.id,entryPoint:Jr(e.originalPage),propertyName:"Name"}})))},placeholderText:strings.Details.ScriptNamePlaceholderText,fontSize:e.fontSize,fontWeight:e.fontWeight,errorDeferredValidationTime:1e3,getErrorMessage:function(t){return(0,Ce.C)(e.script)?$r(t,e.otherScriptNames)?function(e){switch(e.error){case"Name is empty":return strings.Message.EmptyScriptNameError;case"Name is too long":return strings.Message.TooLongScriptNameError;case"Name contains invalid character":return strings.substitute(strings.Message.InvalidCharacterScriptNameError,{character:e.invalidSubstring});case"Invalid name":return strings.Message.InvalidScriptNameError;case"Name ends in whitespace":return strings.Message.EndInWhitespaceError;case"None":return""}}((0,yn.gt)(t)):strings.Message.ScriptNameUsedError:""},shouldFocus:e.shouldFocus,setShouldFocus:e.setShouldFocus,setButtonHasFocus:e.setButtonHasFocus,sendButtonClickTelemetry:function(){(0,l.ve)({eventName:"ControlAction",eventType:"User",data:{control:"RenameButton",location:"EditableLabel"}})}})})),Jr=function(e){switch(e){case"Details":return"Script Card";case"Editor":return"Editor Header"}},ei=n(26460),ti=n(57776),ni=n(32641),ri=n(85359),ii=function(e){return Wr()||!(0,Ce.C)(e)},oi=n(98425),ai=(0,o.$j)((function(e){return{currentPivotKey:Mn.w.backstage.getCurrentPivot(e)}}),{setNavigationSourcePage:Mn.N.editor.setNavigationSourcePage})((0,c.Zz)((function(e){var t=(0,i.useState)(!1),n=t[0],r=t[1],o=(0,i.useState)(!1),a=o[0],s=o[1],c=e.script?e.script.storageScript.name:"",d=(0,i.useState)(c),p=d[0],m=d[1],g=(0,En.o)(e.script),f=(0,Ce.C)(e.script),h=(0,Dn.a)(e.script),v=g&&!f?strings.substitute(strings.Backstage.ScriptItemUserOwnedOneDriveRootFolderText,{creator:e.script.storageScript.creatorDisplayName||""}):h?strings.Backstage.ScriptItemSamplesRootFolderText:strings.Backstage.ScriptItemMyFilesRootFolderText,S=(0,En.o)(e.script)?"OfficeScriptsSharedIcon48":"OfficeScriptsIcon48";(0,i.useEffect)((function(){e.setIsEditingScriptName(e.isEditingScriptName)}),[e.isEditingScriptName]),(0,i.useEffect)((function(){m(e.script.storageScript.name)}),[e.script.storageScript.name]),(0,i.useEffect)((function(){"Failed"===e.scriptSavingStatus&&c!==p&&m(c)}),[e.scriptSavingStatus,c]),(0,i.useEffect)((function(){!0===e.isMakingACopy&&r(!0)}),[e.isMakingACopy]);var y=(0,i.useState)(!1),E=y[0],b=y[1],w=(0,i.useRef)(E),k=(0,i.useState)(!1),P=k[0],x=k[1],C=(0,i.useRef)(null),N=function(){if(!Wr()){var e;if(w.current)null==(e=C.current)||e.openMenu();if(!C.current){var t=new ri.sH("Script card overflow button ref is null!");(0,l.m)(t,l.in.Error)}}};return(0,i.useEffect)((function(){var e;if(E){if(E&&(!P||ue.x)){var t;null==(t=C.current)||t.openMenu()}}else null==(e=C.current)||e.dismissMenu()}),[E]),(0,i.useEffect)((function(){return window.addEventListener("transitionend",N),function(){window.removeEventListener("transitionend",N)}}),[]),i.createElement(ui,null,i.createElement(ei.z,{styles:(0,D.Qf)(e.theme,E),onMouseEnter:function(e){x(!0)},onMouseLeave:function(e){x(!1)}},i.createElement(di,null,e.isEditingScriptName?i.createElement(mi,null,i.createElement(fi,null,i.createElement(Yr,{theme:e.theme,script:e.script,savedScriptName:c,scriptName:p,otherScriptNames:e.otherScriptNames,scriptSavingStatus:e.scriptSavingStatus,fontSize:e.theme.fontSizes.medium,editorNameEditMode:e.isEditingScriptName,setEditorNameEditMode:e.setIsEditingScriptName,shouldFocus:n,setShouldFocus:r,setScriptName:m,setButtonHasFocus:s,originalPage:"Details",isReadOnly:ii(e.script)}))):i.createElement(gi,{buttonHasFocus:a,onFocusCapture:function(){s(!0)},onBlurCapture:function(){s(!1)}},i.createElement(fi,null,i.createElement(Yr,{theme:e.theme,script:e.script,savedScriptName:c,scriptName:p,otherScriptNames:e.otherScriptNames,scriptSavingStatus:e.scriptSavingStatus,fontSize:e.theme.fontSizes.medium,editorNameEditMode:e.isEditingScriptName,setEditorNameEditMode:e.setIsEditingScriptName,shouldFocus:n,setShouldFocus:r,setScriptName:m,setButtonHasFocus:s,originalPage:"Details",isReadOnly:ii(e.script)}))),i.createElement(pi,null,nt.X.instance().isTeamOwnershipUXEnabled()||(0,vr.$)(e.script)?i.createElement(oi.Z,{script:e.script,isPointerCursor:!1,scriptHasUnsavedChanges:!1,shouldSplit:!nt.X.instance().isTeamOwnershipUXEnabled()||"Attached"===e.currentPivotKey}):i.createElement(ni.Z,{rootFolder:v,isPointerCursor:!1,scriptHasUnsavedChanges:!1,showSubFolder:!0}))),!e.isMakingACopy&&i.createElement(i.Fragment,null,i.createElement(si,null,i.createElement(ci,{onClick:function(){e.setNavigationSourcePage("Details"),e.openScriptInEditor(),(0,l.ve)((0,Y.Z)({eventName:"OpenScript",eventType:"User",data:{logLevel:l.in.Information,storageId:e.script.storageScript.id,entryPoint:"Script Card Icon",hasDescription:!!e.script.storageScript.description,isOwner:(0,Ce.C)(e.script),driveType:e.script.storageScript.driveType}}))},onKeyDown:function(t){"Enter"!==t.key&&" "!==t.key||(e.setNavigationSourcePage("Details"),e.openScriptInEditor(),t.preventDefault(),t.stopPropagation(),(0,l.ve)((0,Y.Z)({eventName:"OpenScript",eventType:"User",data:{logLevel:l.in.Information,storageId:e.script.storageScript.id,entryPoint:"Script Card Icon",hasDescription:!!e.script.storageScript.description,isOwner:(0,Ce.C)(e.script),driveType:e.script.storageScript.driveType}})))},tabIndex:0,role:"button","aria-label":strings.Details.ScriptCardIconAriaLabel},i.createElement(li,null,i.createElement(ti.J,{iconName:S,"aria-hidden":"true","data-testid":(0,u.k)("ScriptCardScriptIcon")})))),i.createElement(Vr,{script:e.script,isScriptRunning:e.isScriptRunning,isStorageCallInProgress:e.isStorageCallInProgress,isSharingEnabled:e.isSharingEnabled,addButtonToWorkbook:e.addButtonToWorkbook,openScriptInEditor:function(){e.openScriptInEditor(),(0,l.ve)((0,Y.Z)({eventName:"OpenScript",eventType:"User",data:{logLevel:l.in.Information,storageId:e.script.storageScript.id,entryPoint:"Script Card Button",hasDescription:!!e.script.storageScript.description,isOwner:(0,Ce.C)(e.script),driveType:e.script.storageScript.driveType}}))},setNavigationSourcePage:e.setNavigationSourcePage,editMode:e.isEditingScriptName,setEditMode:e.setIsEditingScriptName,isRecorderRecording:e.isRecorderRecording,isMenuOpened:E,setIsMenuOpened:function(e){w.current=e,b(e)},overflowButtonRef:C,showConnectionPage:e.showConnectionPage}))))}))),si=c.ZP.div.withConfig({displayName:"ScriptCard__CardLogoPadding",componentId:"rampfd-0"})(["padding:0 12px 0;"]),ci=c.ZP.div.withConfig({displayName:"ScriptCard__CardLogoWrapper",componentId:"rampfd-1"})(["width:100%;height:92px;background:",";&:focus{outline:0.1rem solid ",";}&:hover{cursor:pointer;}"],(function(e){return e.theme.colors.neutralLighter}),(function(e){return e.theme.colors.neutralSecondary})),li=c.ZP.div.withConfig({displayName:"ScriptCard__CardLogoInnerWrapper",componentId:"rampfd-2"})(["top:50%;left:50%;position:relative;text-align:center;transform:translate(-50%,-50%);"]),ui=c.ZP.div.withConfig({displayName:"ScriptCard__Wrapper",componentId:"rampfd-3"})(["padding:",";display:flex;flex-direction:column;"],(0,tt._)()?"0.8rem 1.6rem 1.2rem":"0.8rem 2rem 1.2rem"),di=c.ZP.div.withConfig({displayName:"ScriptCard__CardHeaderWrapper",componentId:"rampfd-4"})(["padding:0.8rem 0.5rem 0.9rem;display:flex;flex-direction:column;"]),pi=c.ZP.div.withConfig({displayName:"ScriptCard__FolderPathWrapper",componentId:"rampfd-5"})(["padding:0 7px;width:100%;"]),mi=c.ZP.div.withConfig({displayName:"ScriptCard__FlexWrapper",componentId:"rampfd-6"})(["display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;"]),gi=c.ZP.div.withConfig({displayName:"ScriptCard__HoverEffectFlexWrapper",componentId:"rampfd-7"})(["display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;outline:",";padding:0 7px 0;&:hover{background-color:",";}"],(function(e){return e.buttonHasFocus?"0.1rem solid "+e.theme.colors.neutralSecondary:"none"}),(function(e){return e.theme.colors.neutralQuaternaryAlt})),fi=c.ZP.div.withConfig({displayName:"ScriptCard__ScriptTitleWrapper",componentId:"rampfd-8"})(["overflow:hidden;flex-grow:1;"]);function hi(e,t){return t||(t=e.slice(0)),e.raw=t,e}var vi,Si,yi,Ei,bi,wi,ki=(0,c.Zz)((function(e){var t=e.theme,n=e.status,r=e.shouldWrapText;return i.createElement(Pi,{id:"StatusBar",theme:t,shouldWrapText:!!r,role:"status"},"InProgress"===n&&i.createElement(i.Fragment,null,i.createElement(xi,{theme:t,"data-testid":(0,u.k)("StatusText")},strings.Editor.SavingScriptStatusLabel),i.createElement(ae.$,{size:se.E.small,styles:(0,D.H_)(se.E.small,t)})),"Succeeded"===n&&i.createElement(i.Fragment,null,i.createElement(xi,{theme:t,"data-testid":(0,u.k)("StatusText")},strings.Editor.SavedScriptStatusLabel),i.createElement(ti.J,{iconName:"CheckMarkIcon",styles:{root:{fontSize:t.fontSizes.icon,color:t.colors.successIcon}}})),"Failed"===n&&i.createElement(i.Fragment,null,i.createElement(xi,{theme:t,"data-testid":(0,u.k)("StatusText")},strings.Editor.SaveErrorScriptStatusLabel),i.createElement(ti.J,{iconName:"ErrorBadge",styles:{root:{fontSize:t.fontSizes.icon,color:t.colors.errorIcon,height:"16px"}}})),"Unsaved"===n&&i.createElement(i.Fragment,null,i.createElement(xi,{theme:t,"data-testid":(0,u.k)("UnsavedDecorator")},strings.Editor.UnsavedChangesLabel),i.createElement(ti.J,{iconName:"ErrorBadge",styles:{root:{fontSize:t.fontSizes.icon,color:t.colors.successIcon,height:"16px"}}})))})),Pi=c.ZP.div(qr||(qr=hi(["\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n  height: 3.2rem;\n  white-space: ",";\n"])),(function(e){return e.shouldWrapText?"normal":"nowrap"})),xi=c.ZP.div(Qr||(Qr=hi(["\n  flex-grow: 1;\n  margin: ",";\n  font-size: ",";\n  font-weight: 400;\n  color: ",";\n  vertical-align: middle;\n"])),(function(e){return(0,B.zg)()?"0 0 0 "+e.theme.spacing.small:"0 "+e.theme.spacing.small+" 0 0"}),(function(e){return e.theme.fontSizes.small}),(function(e){return e.theme.colors.neutralSecondary})),Ci=n(84879),Ni=n(40608),Mi=(0,c.Zz)((function(e){var t=e.messageBarProps,n=e.theme,r=e.dispatch,o=e.dismiss;return i.createElement(Ri,{"data-testid":(0,u.k)("MainReduxMessageBar"),isVisible:t.isVisible},t.isVisible&&i.createElement(Ci.c,{dismissButtonAriaLabel:"Close",messageBarType:t.style,onDismiss:t.isBlocking?void 0:function(){o(),t.additionalDismissCallback&&t.additionalDismissCallback()},isMultiline:!t.forceSingleLine,styles:Ii(n),actions:t.buttons?i.createElement("div",null,t.buttons.map((function(e){return i.createElement(Ni.Z,{"data-testid":(0,u.k)("MainReduxMessageBarButton"),key:"button_"+e.text,text:e.text,primary:e.isPrimary,disabled:e.isDisabled,onClick:e.actions&&e.actions.length>0?function(){e.actions.forEach((function(e){r(e)})),e.additionalOnClickCallback&&e.additionalOnClickCallback()}:function(){e.altOnClick&&e.altOnClick(),e.additionalOnClickCallback&&e.additionalOnClickCallback()}})}))):void 0},t.text,t.urlLink&&i.createElement(J.r,{href:t.urlLink.url,target:"_blank",styles:(0,D.Ti)(n)},t.urlLink.text),t.actionLink&&i.createElement(J.r,{onClick:function(){return r(t.actionLink.action)},styles:(0,D.Ti)(n)},t.actionLink.text)))})),Ri=c.ZP.div.withConfig({displayName:"MessageBar__MessageBarWrapper",componentId:"sc-6ppfaj-0"})(["height:",";opacity:",";width:100%;position:relative;z-index:10;background-color:",";transition:all 350ms ease-in-out;"],(function(e){return e.isVisible?"auto":0}),(function(e){return e.isVisible?1:0}),(function(e){return e.theme.colors.white})),Ii=function(e){return{root:{color:e.colors.neutralDark,backgroundColor:e.colors.neutralLighterAlt,border:"1px solid "+e.colors.neutralTertiaryAlt,boxShadow:"0 0 4px 0 rgba(0, 0, 0, 0.35)",selectors:{".ms-MessageBar-icon":{height:"16px"}}}}},Bi=(0,o.$j)((function(e){return{messageBarProps:e.messageBar}}),(function(e){return{dispatch:e,dismiss:function(){return e(p.ZP.messageBar.dismiss())}}}))(Mi);function Ti(e,t){return t||(t=e.slice(0)),e.raw=t,e}var Di=(0,c.Zz)((function(e){var t=e.theme,n=e.script,r=e.isPermissionDialogOpen,o=e.isConsentDialogOpen,a=e.returnToPreviousPage,s=e.hasReceivedMetadata,c=e.hasReceivedMRUMetadata,l=e.otherScriptNames,d=e.openScriptInEditor,p=e.addButtonToWorkbook,m=e.isMakingACopy,g=e.isEditingScriptName,f=e.scriptSavingStatus,h=e.isScriptRunning,v=e.isStorageCallInProgress,S=e.setIsEditingScriptName,y=e.isRecorderRecording,E=e.hasLoadedAttachedScripts,b=e.othersOwnedScripts,w=e.showConnectionPage;(0,i.useEffect)((function(){window.document.title=strings.PageTitles.ScriptDetails})),(0,i.useEffect)((function(){E&&(0,On.oh)(b)}),[E]);var k=i.createRef();(0,i.useEffect)((function(){k.current&&k.current.focus()}),[k]);var P=(nt.X.instance().isTeamOwnershipUXEnabled()?!c:!s)||!n,x=(0,i.useState)(!0),C=x[0],N=x[1];return(0,Je.g)().then((function(e){N(e)})),i.createElement(Oi,{"data-testid":(0,u.k)("DetailsPage")},!Wr()&&i.createElement(Zi,null,i.createElement(Jt,{buttonText:strings.General.BackButtonAllScriptsLabel,returnToPreviousPage:a}),!!n&&(0,Ce.C)(n)&&!m&&i.createElement(zi,null,i.createElement(ki,{status:f}))),!n||P?i.createElement(Li,null,i.createElement(Kt,null)):m?i.createElement(Ai,null,i.createElement(ae.$,{size:se.E.large,ariaLabel:strings.Editor.MakingACopySpinner,label:strings.Editor.MakingACopySpinnerAriaLabel,styles:(0,D.H_)(se.E.large,t)})):i.createElement(i.Fragment,null,i.createElement(ai,{script:n,otherScriptNames:l,scriptSavingStatus:f,isScriptRunning:h,isStorageCallInProgress:v,isSharingEnabled:C,isMakingACopy:m,isEditingScriptName:g,openScriptInEditor:d,addButtonToWorkbook:p,setIsEditingScriptName:S,isRecorderRecording:y,showConnectionPage:w}),i.createElement(Fi,null,i.createElement(Bi,null)),i.createElement(Er,{theme:t,script:n,isPermissionDialogOpen:r,isConsentDialogOpen:o,isScriptRunning:h,isStorageCallInProgress:v})))})),Oi=c.ZP.div(vi||(vi=Ti(["\n  height: 100%;\n  width: 100%;\n  overflow: auto;\n"]))),Li=c.ZP.div(Si||(Si=Ti(["\n  padding: 0 ",";\n"])),(function(e){return e.theme.spacing.medium})),Ai=c.ZP.div(yi||(yi=Ti(["\n  width: 100%;\n  align-items: end;\n  justify-content: center;\n  display: flex;\n  position: relative;\n  top: 30%;\n"]))),zi=c.ZP.div(Ei||(Ei=Ti(["\n  flex-grow: 0;\n"]))),Zi=c.ZP.div(bi||(bi=Ti(["\n  padding: ",";\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-between;\n  align-items: center;\n"])),(0,tt._)()?"0rem 1.6rem":"1.1rem 2rem 0px 2rem"),Fi=c.ZP.div(wi||(wi=Ti(["\n  display: flex;\n  position: relative;\n"]))),Wi=n(81329),_i=n(78574),Ui=n(32225),Hi=n(58679),ji=n(26106);function Vi(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,i)}function Ki(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Vi(o,r,i,a,s,"next",e)}function s(e){Vi(o,r,i,a,s,"throw",e)}a(void 0)}))}}var Gi,Xi,$i=new Hi.P(Ki(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ji.D.instance();case 2:return t=e.sent,e.abrupt("return",t.getOrganization());case 4:case"end":return e.stop()}}),e)})))),qi=function(){var e=Ki(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",$i.promise());case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function Qi(e,t){return t||(t=e.slice(0)),e.raw=t,e}var Yi,Ji,eo=(0,c.Zz)((function(e){var t=e.script,n=e.isOpen,r=e.addScriptToWorkbook,o=e.hideShareDialog,a=e.theme;if(!t)return null;var s=(0,i.useState)(!1),c=s[0],l=s[1],d=(0,i.useState)(""),p=d[0],m=d[1];return qi().then((function(e){m(e.DisplayName)})),i.createElement(Wi.V,{hidden:!n,onDismiss:o,dialogContentProps:ro(a),modalProps:{isBlocking:!1,styles:(0,D.De)(),onDismissed:function(){l(!1)}}},i.createElement(no,null,i.createElement(to,null,""!==p?strings.substitute(strings.Details.ShareInWorkbookPermissionWithOrgText,{organizationName:p}):strings.Details.ShareInWorkbookPermissionText)),i.createElement(_i.c,null,i.createElement(Ni.Z,{"data-testid":(0,u.k)("ShareDialogActionButton"),text:strings.Details.ShareCommandButtonText,ariaLabel:strings.Details.ShareCommandButtonText,disabled:c,onClick:function(){l(!0),r(t)},primary:!0}),i.createElement(Ni.Z,{"data-testid":(0,u.k)("ShareDialogCancelButton"),text:strings.General.CancelButtonText,ariaLabel:strings.General.CancelButtonText,disabled:c,onClick:function(){o()}})))})),to=c.ZP.div(Gi||(Gi=Qi(["\n  margin-bottom: ",";\n"])),(function(e){return e.theme.spacing.mediumPlus})),no=c.ZP.div(Xi||(Xi=Qi(["\n  display: flex;\n"]))),ro=function(e){return{type:Ui.i.normal,title:strings.Details.ShareInWorkbookDialogTitle,styles:{title:{fontSize:e.fontSizes.large,fontWeight:e.fontWeights.semibold,color:e.colors.primary},content:{backgroundColor:e.colors.neutralLight}}}},io=(0,o.$j)((function(e){return{isOpen:m.ZP.shareDialog.getIsVisible(e),script:m.ZP.scripts.get(e,m.ZP.editor.getActiveScriptId(e))}}),(function(e){return{dispatch:e,addScriptToWorkbook:function(t){return e(p.ZP.scripts.addScriptToWorkbook.request(t))},hideShareDialog:function(){return e(p.ZP.shareDialog.hide())}}}))(eo),oo=n(31183);function ao(e,t){return t||(t=e.slice(0)),e.raw=t,e}var so=(0,c.Zz)((function(e){var t=e.script,n=e.isOpen,r=e.removeScriptFromWorkbook,o=e.blockAccessToScript,a=e.hideUnshareDialog,s=e.theme;if(!t)return null;var c=(0,Ce.C)(t),l=(0,i.useState)(!1),d=l[0],p=l[1],m=(0,i.useState)(!1),g=m[0],f=m[1],h=(0,En.o)(t),v=(0,i.useState)(""),S=v[0],y=v[1];return qi().then((function(e){y(e.DisplayName)})),i.createElement(Wi.V,{hidden:!n,onDismiss:a,dialogContentProps:uo(s),modalProps:{isBlocking:!1,styles:(0,D.De)(),onDismissed:function(){f(!1)}}},i.createElement(lo,null,i.createElement(co,null,""!==S?strings.substitute(strings.Details.StopShareInWorkbookPermissionWithOrgText,{organizationName:S}):strings.Details.StopShareInWorkbookPermissionText),c&&i.createElement(oo.X,{label:strings.Dialog.StopSharingCheckboxText,onChange:function(e,t){p(!!t)},checked:d})),i.createElement(_i.c,null,i.createElement(Ni.Z,{"data-testid":(0,u.k)("UnshareDialogActionButton"),text:strings.Dialog.StopSharingButtonText,ariaLabel:strings.Dialog.StopSharingButtonText,disabled:g,onClick:function(){f(!0),d||h||a(),d&&o(t),h&&r(t)},primary:!0}),i.createElement(Ni.Z,{"data-testid":(0,u.k)("UnshareDialogCancelButton"),text:strings.General.CancelButtonText,ariaLabel:strings.General.CancelButtonText,disabled:g,onClick:function(){a()}})))})),co=c.ZP.div(Yi||(Yi=ao(["\n  margin-bottom: ",";\n"])),(function(e){return e.theme.spacing.mediumPlus})),lo=c.ZP.div(Ji||(Ji=ao(["\n  display: flex;\n  flex-direction: column;\n"]))),uo=function(e){return{type:Ui.i.normal,title:strings.Details.UnshareDialogTitle,styles:{title:{fontSize:e.fontSizes.large,fontWeight:e.fontWeights.semibold,color:e.colors.primary},content:{backgroundColor:e.colors.neutralLight}}}},po=(0,o.$j)((function(e){return{isOpen:m.ZP.unshareDialog.getIsVisible(e),script:m.ZP.scripts.get(e,m.ZP.editor.getActiveScriptId(e))}}),(function(e){return{dispatch:e,removeScriptFromWorkbook:function(t){return e(p.ZP.scripts.removeScriptFromWorkbook.request(t))},blockAccessToScript:function(t){return e(p.ZP.scripts.unshareScriptFromAllWorkbooks.request(t))},hideUnshareDialog:function(){return e(p.ZP.unshareDialog.hide())}}}))(so),mo=n(63746),go=n(99072),fo=n(35826);function ho(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,i)}var vo=function(e){ko.call(this),this.reduxStore=e};Object.defineProperty(vo,"_instance",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(vo,"instance",{configurable:!0,enumerable:!0,writable:!0,value:function(){if(!vo._instance){var e=(0,fo.v)();vo._instance=new vo(e)}return vo._instance}});var So,yo,Eo,bo,wo,ko=function(){Object.defineProperty(this,"reduxStore",{configurable:!0,enumerable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"revokeOrCancelConsent",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e,t=(e=regeneratorRuntime.mark((function e(t,n){var r,i,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===n&&(n=!1),n){e.next=20;break}return e.prev=2,e.next=5,cr.q.instance();case 5:return r=e.sent,e.next=8,r.denyConsent(t);case 8:e.next=12;break;case 10:e.prev=10,e.t0=e.catch(2);case 12:return e.next=14,(0,An.W9)(t);case 14:return i=e.sent,e.next=17,(0,Vn.Z)();case 17:o=e.sent,a=i.filter((function(e){return e.lastModifiedByUser!==o.UserId})),hr.T.instance().setValue(t,a);case 20:case"end":return e.stop()}}),e,null,[[2,10]])})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){ho(o,r,i,a,s,"next",e)}function s(e){ho(o,r,i,a,s,"throw",e)}a(void 0)}))});return function(e,n){return t.apply(this,arguments)}}()})};function Po(e,t){return t||(t=e.slice(0)),e.raw=t,e}function xo(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,i)}function Co(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){xo(o,r,i,a,s,"next",e)}function s(e){xo(o,r,i,a,s,"throw",e)}a(void 0)}))}}var No,Mo=(0,o.$j)((function(e){return{currentPivotKey:Mn.w.backstage.getCurrentPivot(e)}}))((0,c.Zz)((function(e){var t=e.script,n=e.isOpen,r=e.viewScript,o=e.currentPivotKey,a=e.theme,s=Ro(),c=fr(s,t,n),u=c.numConsented>0,d=0!=c.users.length,p=(0,i.useState)(!1),m=p[0],g=p[1],f=(0,i.useState)(!1),h=f[0],v=f[1],S=(0,i.useState)(!1),y=S[0],E=S[1];if(!t||!u)return null;var b="";c.users.length>2?b=strings.substitute(strings.Dialog.PermissionsFor3UsersAndMore,{firstUserName:c.users[0].name,numberOfUsers:c.users.length-1}):2===c.users.length?b=strings.substitute(strings.Dialog.PermissionsFor2Users,{firstUserName:c.users[0].name,secondUserName:c.users[1].name}):d&&(b=c.users[0].name);var w=c.users.map((function(e){return{lastModifiedByUser:e.id,lastModifiedByUserName:e.name,lastModifiedByUserEmail:e.email}})),k=!!r,P=[{text:strings.Dialog.ConsentViewAndModifyScopeText,infoLink:"https://aka.ms/script-run-permissions"}],x=strings.substitute(strings.Backstage.ScriptItemUserOwnedOneDriveRootFolderText,{creator:t.storageScript.creatorDisplayName||""});return i.createElement(Wi.V,{hidden:!n,onDismiss:function(){Ie.u.store.dispatch(Mn.N.permissionDialog.hide())},dialogContentProps:Oo(a),modalProps:{isBlocking:!1,styles:(0,D.De)()},minWidth:"340px"},i.createElement(Io,null,k?i.createElement(To,null,i.createElement(Bo,null,i.createElement(ti.J,{iconName:(0,En.o)(t)?"OfficeScriptsSharedIcon32":"OfficeScriptsIcon32"}),i.createElement(Do,{onClick:function(){(0,l.ve)({eventName:"ControlAction",eventType:"User",data:{control:"PermissionDialog",operationType:"OpenScript",storageId:t.storageScript.id}}),r&&r(t)}},i.createElement(Ye._,{styles:Lo(a)},t.storageScript.name),nt.X.instance().isTeamOwnershipUXEnabled()||(0,vr.$)(t)?i.createElement(oi.Z,{script:t,isPointerCursor:!0,shouldSplit:!nt.X.instance().isTeamOwnershipUXEnabled()||"Attached"===o}):i.createElement(ni.Z,{rootFolder:x,isPointerCursor:!0,showSubFolder:!0})))):i.createElement(Bo,null,i.createElement(ti.J,{iconName:(0,En.o)(t)?"OfficeScriptsSharedIcon32":"OfficeScriptsIcon32"}),i.createElement(Do,null,i.createElement(Ye._,{styles:Lo(a)},t.storageScript.name),nt.X.instance().isTeamOwnershipUXEnabled()||(0,vr.$)(t)?i.createElement(oi.Z,{script:t,isPointerCursor:!0,shouldSplit:!nt.X.instance().isTeamOwnershipUXEnabled()||"Attached"===o}):i.createElement(ni.Z,{rootFolder:x,isPointerCursor:!0,showSubFolder:!0}))),d?i.createElement(zo,null,i.createElement(mo.Z,{message:strings.Dialog.PermissionsMessage,ariaLabel:strings.Dialog.PermissionsUsersAriaLabel,uniqueUserInfos:w,isUserNamesHovered:h,isUserNamesFocused:y,isCalloutVisible:m,setIsUserNamesHovered:v,setIsUserNamesFocused:E,setIsCalloutVisible:g,modifiedByUserNames:b,theme:a})):null,i.createElement(Ye._,{styles:{root:{fontWeight:a.fontWeights.regular}}},strings.Dialog.PermissionsScopesListHeader),i.createElement("ul",{style:{margin:"0 "+a.spacing.mediumPlus+" 0"}},P.map((function(e,t){return i.createElement("li",{key:t},i.createElement(Ye._,{styles:{root:{display:"inline",fontWeight:a.fontWeights.regular}}},e.text),i.createElement(go.h,{iconProps:{iconName:"Info"},onClick:function(){return window.open(e.infoLink,"_blank")},styles:{root:{marginLeft:0,cursor:"pointer",color:a.colors.neutralSecondary,verticalAlign:"middle",paddingBottom:"0.1rem"}},ariaLabel:strings.substitute(strings.Dialog.ConsentViewScopeDetailAriaLabel,{scope:e.text}),role:"link"}))}))),i.createElement(J.r,{href:"https://aka.ms/office-scripting-overview",target:"_blank",styles:Ao(a),role:"link"},strings.Dialog.ConsentLearnAboutOfficeScriptingLinkText)),i.createElement(_i.c,null,i.createElement(Ni.Z,{text:strings.General.OKButtonText,ariaLabel:strings.General.OKButtonText,onClick:function(){Ie.u.store.dispatch(Mn.N.permissionDialog.hide())},primary:!0,role:"button"}),i.createElement(Ni.Z,{text:strings.Dialog.PermissionsRevokeButtonText,ariaLabel:strings.Dialog.PermissionsRevokeButtonText,ariaDescription:strings.Dialog.PermissionsRevokeButtonAriaDescription,onClick:Co(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vo.instance().revokeOrCancelConsent(t);case 2:Ie.u.store.dispatch(Mn.N.permissionDialog.hide());case 3:case"end":return e.stop()}}),e)}))),role:"button"})))}))),Ro=function(){var e=(0,i.useRef)(!1);return(0,i.useEffect)((function(){return e.current=!0,function(){e.current=!1}}),[]),e},Io=c.ZP.div(So||(So=Po(["\n  margin-bottom: ",";\n"])),(function(e){return e.theme.spacing.mediumPlus})),Bo=c.ZP.div(yo||(yo=Po(["\n  display: flex;\n  align-items: center;\n"]))),To=c.ZP.div(Eo||(Eo=Po(["\n  cursor: pointer;\n  padding: ",";\n  margin: ",";\n\n  &:hover {\n    background: ",";\n  }\n\n  &:focus {\n    background: ",";\n    outline: none;\n  }\n"])),(function(e){return e.theme.spacing.xSmall+" "+e.theme.spacing.small}),(function(e){return"0 -"+e.theme.spacing.small}),(function(e){return e.theme.colors.neutralQuaternaryAlt}),(function(e){return e.theme.colors.neutralTertiaryAlt})),Do=c.ZP.div(bo||(bo=Po(["\n  padding: ",";\n  width: 100%;\n  overflow: hidden;\n"])),(function(e){return(0,B.zg)()?"0 "+e.theme.spacing.medium+" 0 0":"0 0 0 "+e.theme.spacing.medium})),Oo=function(e){return{type:Ui.i.normal,title:strings.Dialog.PermissionsHeader,styles:{title:{fontSize:e.fontSizes.large,fontWeight:e.fontWeights.semibold,color:e.colors.primary},content:{backgroundColor:e.colors.neutralLight}}}},Lo=function(e){return{root:{fontSize:e.fontSizes.medium,fontWeight:e.fontWeights.semibold,padding:0,overflow:"hidden"}}},Ao=function(e){return{root:{marginTop:e.spacing.smallPlus,display:"inline-block",color:e.colors.linkText,selectors:{":focus":{color:e.colors.linkText,outline:"none !important"},":hover":{color:e.colors.linkTextHovered,textDecoration:"underline"}}}}},zo=c.ZP.div(wo||(wo=Po(["\n  display: flex;\n  align-items: center;\n  margin: 0 0 ",";\n  padding-bottom: ",";\n  border-bottom: 1px solid ",";\n"])),(function(e){return e.theme.spacing.small}),(function(e){return e.theme.spacing.xSmall}),(function(e){return e.theme.colors.neutralLighter})),Zo=(0,o.$j)((function(e){var t=a.w.scripts.get(e,a.w.editor.getActiveScriptId(e)),n=a.w.permissionDialog.getIsVisible(e),r=a.w.consentDialog.getIsVisible(e),i=a.w.scripts.getHasReceivedMetadata(e),o=a.w.scripts.getHasReceivedMRUMetadata(e),s=a.w.scripts.getOtherOwnedScriptNames(e,(t||{storageScript:{}}).storageScript.id),c=a.w.scripts.getSavingStatus(e,t?t.storageScript.id:null),l=a.w.run.getIsRunning(e),u=a.w.scripts.getIsStorageCallInProgress(e,t?t.storageScript.id:null),d=a.w.editor.getIsRecorderRunning(e);return{script:t,isPermissionDialogOpen:n,isConsentDialogOpen:r,hasReceivedMetadata:i,hasReceivedMRUMetadata:o,localOtherOwnedScriptNames:s,savingStatus:c,isScriptRunning:l,isStorageCallInProgress:u,isMakingACopy:a.w.editor.getIsMakingACopy(e),isEditingScriptName:a.w.editor.getIsEditingScriptName(e),isRecorderRecording:d,hasLoadedAttachedScripts:a.w.scripts.getHasLoadedAttachedScripts(e),othersOwnedScripts:a.w.scripts.getAllNonOwnedScripts(e)}}),{removeScriptFromWorkbook:a.N.scripts.removeScriptFromWorkbook.request,addButtonToWorkbook:a.N.scripts.addButtonToWorkbook.request,hideDetailsPage:a.N.editor.hideDetailsPage,showDetailsPage:a.N.editor.showDetailsPage,showBackstage:a.N.backstage.show,setCurrentPivotKey:a.N.backstage.setCurrentPivot,setIsEditingScriptName:a.N.editor.setIsEditingScriptName})((function(e){var t=e.script,n=e.isPermissionDialogOpen,r=e.isConsentDialogOpen,o=e.hasReceivedMetadata,s=e.hasReceivedMRUMetadata,c=e.localOtherOwnedScriptNames,l=e.addButtonToWorkbook,u=e.savingStatus,d=e.isScriptRunning,p=e.isStorageCallInProgress,m=e.isMakingACopy,g=e.isEditingScriptName,f=e.isRecorderRecording,h=e.hideDetailsPage,v=e.showBackstage,S=e.setCurrentPivotKey,y=e.setIsEditingScriptName,E=e.hasLoadedAttachedScripts,b=e.othersOwnedScripts,w=e.showConnectionPage;return i.createElement(i.Fragment,null,t&&i.createElement(i.Fragment,null,i.createElement(io,null),i.createElement(Mo,{script:t,isOpen:a.w.permissionDialog.getIsVisible(Ie.u.store.getState())}),i.createElement(po,null)),i.createElement(Di,{script:t,isPermissionDialogOpen:n,isConsentDialogOpen:r,hasReceivedMetadata:o,hasReceivedMRUMetadata:s,scriptSavingStatus:u,isScriptRunning:d,isStorageCallInProgress:p,otherScriptNames:c,isMakingACopy:m,isEditingScriptName:g,isRecorderRecording:f,returnToPreviousPage:function(){t&&(0,Ce.C)(t)?S(at.Recent):t&&(0,Dn.a)(t)?S(at.Samples):S(at.Attached),v(),h()},addButtonToWorkbook:l,openScriptInEditor:function(){h()},setIsEditingScriptName:y,hasLoadedAttachedScripts:E,othersOwnedScripts:b,showConnectionPage:w}))})),Fo=n(99212),Wo=n(94078),_o=n(62438),Uo=n(49384);var Ho,jo,Vo,Ko,Go,Xo=(0,c.Zz)((function(e){var t,n=e.theme,r=e.returnToPreviousPage,o=e.connectionStatus,a=e.workbookName,s=e.scriptName,c=e.disconnect,l=e.reconnect,d="OverflowIcon";switch(o){case Fo.MceConnectionStatus.Connected:t="Connected",d="CompleteIcon";break;case Fo.MceConnectionStatus.Disconnected:t="Disconnected",d="ErrorBadge";break;default:t="Unknown",d="Warning"}return i.createElement($o,{"data-testid":(0,u.k)("ConnectionPage")},i.createElement(Wo.K,{tokens:Yo},i.createElement(Wo.K,{horizontal:!0,verticalAlign:"center",tokens:Jo},i.createElement(ti.J,{iconName:"VisualStudioCode20",styles:qo(n),"aria-hidden":"true"}),i.createElement(Ye._,null,strings.VSCodeConnection.ConnectionTitle)),i.createElement(_o.Z,{styles:Qo(n)}),i.createElement(Wo.K,{horizontal:!0,verticalAlign:"center",tokens:Jo},i.createElement(Wo.K.Item,null,i.createElement(ti.J,{iconName:"Workbook20",styles:qo(n),"aria-hidden":"true"})),i.createElement(Wo.K.Item,{grow:!0,styles:ea},i.createElement(Uo.x,{variant:"medium"},a))),i.createElement(Wo.K,{horizontal:!0,verticalAlign:"center",wrap:!1,tokens:Jo},i.createElement(Wo.K.Item,null,i.createElement(ti.J,{iconName:"OfficeScriptsIcon20",styles:qo(n),"aria-hidden":"true"})),i.createElement(Wo.K.Item,{grow:!0,styles:ea},s),i.createElement(Wo.K.Item,{align:"end"},i.createElement(R.G,{calloutProps:(0,D.FA)(n),content:t},i.createElement(ti.J,{iconName:d,styles:qo(n),"aria-hidden":"true"})))),i.createElement(Ye._,{styles:ta(n)},strings.VSCodeConnection.ConnectionMessage),i.createElement(Wo.K.Item,null,i.createElement(Wo.K,{horizontal:!0,horizontalAlign:"end",tokens:{childrenGap:10}},i.createElement(Ni.Z,{onClick:function(){c(),r()}},strings.General.CloseButtonLabel),i.createElement(Ni.Z,{primary:!0,onClick:function(){c(),l()}},strings.VSCodeConnection.RelaunchButtonText)))))})),$o=c.ZP.div(No||(No=function(e,t){return t||(t=e.slice(0)),e.raw=t,e}(["\n  height: 100%;\n  overflow: auto;\n  margin-left: 1.143em;\n  margin-right: 1.143em;\n"]))),qo=function(e){return{root:{fontSize:e.fontSizes.icon,marginTop:".6rem"}}},Qo=function(e){return{root:[{selectors:{"::before":{background:e.colors.neutralQuaternary}},fontSize:0}]}},Yo={childrenGap:7},Jo={childrenGap:12,maxWidth:"100%"},ea={root:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}},ta=function(e){return{root:{fontSize:e.fontSizes.medium,color:e.colors.neutralPrimary,fontWeight:e.fontWeights.regular,paddingTop:"1.42rem"}}},na=n(30051),ra=n(93275),ia=n(38758),oa=n(24350),aa=n(29159),sa=(0,o.$j)((function(e){var t=(0,oa.s)();return{scriptName:t?t.storageScript.name:"???",previousPage:$a}}),{})((function(e){var t=e.scriptName,n=e.previousPage,r=e.hideConnectionPage,o=(0,i.useState)("My Workbook"),a=o[0],s=o[1];(0,i.useEffect)((function(){(0,pe.wH)().then((function(e){s(e||"My Workbook")}))}),[]);var c=(0,i.useState)(Fo.MceConnectionStatus.Unknown),l=c[0],u=c[1];return(0,i.useEffect)((function(){(0,ia.AR)((function(e){u(e)}))}),[]),i.createElement(Xo,{returnToPreviousPage:function(){r()},scriptName:t,workbookName:a,connectionStatus:l,previousPage:n,disconnect:function(){(0,na.x)()},reconnect:function(){(0,na.U)({target:ra.P,channel:aa.l,entryPoint:Hr.N.ConnectionPageRelaunchButton})}})})),ca=c.ZP.div.withConfig({displayName:"EditorWrapper",componentId:"sc-1l194aj-0"})(["height:100%;overflow:hidden;flex:1;position:relative;"]);function la(e,t){return t||(t=e.slice(0)),e.raw=t,e}var ua=(0,c.Zz)((function(e){var t=e.theme,n=e.script,r=e.scriptSavingStatus,o=e.otherScriptNames,a=e.editMode,s=e.setEditMode,c=e.shouldFocus,l=e.setShouldFocus,u=e.isMakingACopy,d=e.savedScriptName,p=e.scriptName,m=e.setScriptName,g=(0,i.useState)(!1),f=g[0],h=g[1];return a?i.createElement(pa,null,i.createElement(Yr,{theme:t,script:n,savedScriptName:d,scriptName:p,otherScriptNames:o,scriptSavingStatus:r,fontSize:e.theme.fontSizes.small,fontWeight:600,originalPage:"Editor",editorNameEditMode:a,setEditorNameEditMode:s,shouldFocus:c,setShouldFocus:l,setScriptName:m,setButtonHasFocus:h,isReadOnly:ii(e.script)}),ii(n)&&i.createElement(ga,null,"[",strings.Editor.ReadOnlyLabel,"]")):i.createElement(da,{buttonHasFocus:f,onFocusCapture:function(){h(!0)},onBlurCapture:function(){h(!1)}},i.createElement(ti.J,{iconName:(0,En.o)(n)?"OfficeScriptsSharedIcon":"OfficeScriptsIcon",styles:{root:{marginTop:".2rem",fontSize:t.fontSizes.icon}}}),i.createElement(Yr,{theme:t,script:n,savedScriptName:d,scriptName:p,otherScriptNames:o,scriptSavingStatus:r,fontSize:e.theme.fontSizes.small,fontWeight:600,originalPage:"Editor",editorNameEditMode:a,setEditorNameEditMode:s,shouldFocus:c,setShouldFocus:l,setScriptName:m,setButtonHasFocus:h,isReadOnly:ii(n)}),!Wr()&&(0,Ce.C)(n)&&!u&&i.createElement(ma,null,i.createElement(ki,{status:r})),ii(n)&&i.createElement(fa,null,"[",strings.Editor.ReadOnlyLabel,"]"))})),da=c.ZP.div(Ho||(Ho=la(["\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n  border: ",";\n  padding: ",";\n  &:hover {\n    background-color: ",";\n  }\n"])),(function(e){return e.buttonHasFocus?"0.1rem solid "+e.theme.colors.neutralSecondary:"none"}),(function(e){return e.buttonHasFocus?"0 "+((0,tt._)()?"23px":e.theme.spacing.medium):"0.1rem "+((0,tt._)()?"23px":e.theme.spacing.medium)}),(function(e){return e.theme.colors.neutralQuaternaryAlt})),pa=c.ZP.div(jo||(jo=la(["\n  display: flex;\n  align-items: center;\n  justify-content: flex-start;\n  padding: 0\n    ",";\n"])),(function(e){return(0,tt._)()?"20px":e.theme.spacing.medium})),ma=c.ZP.div(Vo||(Vo=la(["\n  margin: ",";\n"])),(0,B.zg)()?"0 auto 0 0":"0 0 0 auto"),ga=c.ZP.div(Ko||(Ko=la(["\n  color: ",";\n  vertical-align: middle;\n  margin: 0 0.1rem 0.2rem 0.1rem;\n  padding: 0 0.1rem;\n"])),(function(e){return e.theme.colors.neutralPrimary})),fa=c.ZP.div(Go||(Go=la(["\n  color: ",";\n  vertical-align: middle;\n  margin: 0 0.1rem 0.2rem 0.1rem;\n  padding: 0 0.1rem;\n  white-space: nowrap;\n"])),(function(e){return e.theme.colors.neutralPrimary})),ha=n(21849),va=n(30747),Sa=n(88061),ya=(0,c.Zz)((function(e){var t=e.links.map((function(t){var n=t.id,r=t.title,o=t.link;return i.createElement(ba,{key:n},i.createElement(J.r,{key:n,href:o,target:"_blank",onClick:function(){return(0,l.ve)({eventName:"FollowLink",eventType:"User",data:{id:n,storageId:e.activeScriptId}})},styles:(0,D.Ti)(e.theme)},r))}));return i.createElement(v.k,{"data-testid":e["data-testid"],role:"list",style:Ea(e.theme)},i.createElement(i.Fragment,null,i.createElement(wa,null,t),i.createElement(ba,{key:va.LT.id},i.createElement(J.r,{key:va.LT.id,href:va.LT.link,target:"_blank",onClick:function(){return(0,l.ve)({eventName:"FollowLink",eventType:"User",data:{id:va.LT.id,storageId:e.activeScriptId}})},styles:(0,D.Ti)(e.theme)},va.LT.title))))})),Ea=function(e){return{padding:"0.6rem 0.1rem",maxHeight:"100%",overflowX:"hidden",overflowY:"auto",background:e.colors.neutralLight}},ba=c.ZP.div.withConfig({displayName:"HelpLinkList__LinkWrapper",componentId:"sc-1ict7rp-0"})(["padding:"," "," 0 ",";"],(function(e){return e.theme.spacing.xSmall}),(function(e){return e.theme.spacing.small}),(function(e){return e.theme.spacing.small})),wa=c.ZP.div.withConfig({displayName:"HelpLinkList__LinkListWrapper",componentId:"sc-1ict7rp-1"})(["padding-bottom:",";"],(function(e){return e.theme.spacing.smallPlus})),ka=function(e){var t,n=e.outputLogs,r=e.problemsLogs,o=e.helpLinks,a=e.currentPivotKey,s=e.setCurrentPivotKey,c=e.shouldFocusBottomPanel,l=e.setShouldFocusBottomPanel,d=e.activeScriptId,p=e.hide,m=[{key:va.Fh.Output,testId:(0,u.k)("BottomPanelOutputPivot"),text:strings.Editor.OutputTabLabel,ariaLabel:strings.Editor.OutputTabLabel,itemCount:n.length},{key:va.Fh.Problems,testId:(0,u.k)("BottomPanelProblemsPivot"),text:strings.Editor.ProblemsTabLabel,ariaLabel:strings.Editor.ProblemsTabLabel,itemCount:r.length},{key:va.Fh.Help,testId:(0,u.k)("BottomPanelHelpPivot"),text:strings.Editor.HelpTabLabel,ariaLabel:strings.Editor.HelpTabLabel,itemCount:o?o.length:0}],g=((t={})[va.Fh.Output]=i.createElement(ha.Z,{"data-testid":(0,u.k)("BottomPanelOutputPanel"),logs:n}),t[va.Fh.Problems]=i.createElement(ha.Z,{"data-testid":(0,u.k)("BottomPanelProblemsPanel"),logs:r}),t[va.Fh.Help]=i.createElement(ya,{"data-testid":(0,u.k)("BottomPanelHelpPanel"),links:o,activeScriptId:d}),t);return i.createElement(Sa.ZP,{pivotBarItems:m,pivotPages:g,currentPivotKey:a,shouldFocusBottomPanel:c,setShouldFocusBottomPanel:l,hideBottomPanel:p,setCurrentPivotKey:s,allowClose:!0,allowMinimize:!1})},Pa=(0,o.$j)((function(e){return{outputLogs:a.w.bottomPanel.getOutputLogs(e),problemsLogs:a.w.bottomPanel.getProblemsLogs(e),helpLinks:a.w.bottomPanel.getHelpLinks(e),currentPivotKey:a.w.bottomPanel.getCurrentPivot(e),activeScriptId:a.w.editor.getActiveScriptId(e)||""}}),{hide:a.N.bottomPanel.hide,setCurrentPivotKey:a.N.bottomPanel.setCurrentPivot})(ka),xa=n(52105),Ca=n(90845),Na=n(91981),Ma=n(30757);function Ra(e,t,n,r){var i=r.script,o=r.callback,a=t===Ma.C.WebSocket?e:"Open Code - "+e;return{key:"MainHeaderOverflowExtensionTestOptionButton"+a,text:a,iconProps:{iconName:"Info"},onClick:(0,Na.F)({target:n,channel:t,script:i,callback:o})}}function Ia(){return Ia=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ia.apply(this,arguments)}var Ba=(0,o.$j)((function(e){var t=a.w.editor.getActiveScriptId(e);return{isScriptRunning:a.w.run.getIsRunning(e),disableHeader:!t||a.w.run.getIsRunning(e),navigationSourcePageName:a.w.editor.getNavigationSourcePage(e),isRecorderRecording:a.w.editor.getIsRecorderRunning(e)}}),{showBottomPanel:a.N.bottomPanel.show,hideBottomPanel:a.N.bottomPanel.hide,showBackstage:a.N.backstage.show,dismissMessage:a.N.messageBar.dismiss,addButtonToWorkbook:a.N.scripts.addButtonToWorkbook.request,setBottomPanelPivotKey:a.N.bottomPanel.setCurrentPivot,setCurrentPivotKey:a.N.backstage.setCurrentPivot})((0,c.Zz)((function(e){(0,i.useEffect)((function(){window.document.title=strings.PageTitles.CodeEditor}));var t=(0,Ce.C)(e.script),n=(0,i.useState)(!0),r=n[0],o=n[1];(0,Je.g)().then((function(e){o(e)}));var a=!!e.script&&!t,s="Details"===e.navigationSourcePageName?strings.General.BackButtonDetailsPageLabel:strings.General.BackButtonAllScriptsLabel,c=(0,Ar.n)(e.script,e.isScriptRunning,e.isRecorderRecording),l=(0,U.oF)(e.theme.fontSizes.medium,e.theme,!c),d=[(0,Ur.Gu)((0,u.k)("MainHeaderRunButton"),e.script,c,"Editor Page",e.isRecorderRecording,{additionalStyles:l})];if(!Wr()){var p=a?Oa(e.script,e.isScriptRunning,e.isStorageCallInProgress,e.editableScriptNameRef):La(e.script,e.isStorageCallInProgress,e.navigationSourcePageName);d.push(p)}return i.createElement(Ta,null,i.createElement(Da,null,i.createElement(Jt,{buttonText:s,returnToPreviousPage:function(){e.isScriptRunning||e.dismissMessage(),"Details"===e.navigationSourcePageName?e.showDetailsPage():(t?e.setCurrentPivotKey(at.Recent):e.script&&(0,Dn.a)(e.script)?e.setCurrentPivotKey(at.Samples):e.setCurrentPivotKey(at.Attached),e.showBackstage())}})),i.createElement(Q,{disabled:e.disableHeader,primaryCommands:d,overflowCommands:Wr()?[]:Aa(Ia({},e,{isSharingEnabled:r})),isDetailsPage:!1}))}))),Ta=c.ZP.div.withConfig({displayName:"EditorHeader__Wrapper",componentId:"sc-1fukbqc-0"})(["padding:0 ",";"],(function(e){return(0,tt._)()?e.theme.spacing.medium:e.theme.spacing.small})),Da=c.ZP.div.withConfig({displayName:"EditorHeader__BackButtonWrapper",componentId:"sc-1fukbqc-1"})(["padding-bottom:",";"],(0,tt._)()?"7px":"0"),Oa=function(e,t,n,r){var i=(0,Zr.E)(e,t,n),o=function(){r&&r.current&&r.current.focus()};return nt.X.instance().isTeamOwnershipUXEnabled()&&!ue.x?(0,Ur.co)((0,u.k)("MainHeaderMakeACopyTo"),i,(function(){Be.P.instance(Ie.u.store).makeACopyTo(e,"Editor"),o()})):(0,Ur.xT)((0,u.k)("MainHeaderMakeACopy"),i,(function(){Be.P.instance(Ie.u.store).makeACopyOfScript(e.storageScript.id,"Editor"),o()}))},La=function(e,t,n){var r=Re(e,t);return{key:(0,u.k)("MainHeaderPublishButton"),text:strings.Editor.SaveButtonText,ariaLabel:strings.Editor.SaveButtonText,iconProps:{iconName:"SaveToCloudIcon"},disabled:!r,onClick:function(){(0,l.ve)({eventName:"ControlAction",eventType:"User",data:{control:"MainHeaderPublishButton",location:"Editor",storageId:e.storageScript.id,navigationSourcePage:n}}),Be.P.instance(Ie.u.store).saveScript(e,{})},additionalStyles:{iconDisabled:{opacity:.5}},tooltipText:(0,Ce.C)(e)?"":strings.Message.OnlyScriptOwner}},Aa=function(e){var t=(0,Ce.C)(e.script),n="production"!==(0,de.IA)(),r=(0,En.o)(e.script),i=!r&&t&&e.isSharingEnabled,o=(0,Fr.I)(e.script,e.isStorageCallInProgress),a=function(e,t,n){return!!e&&!ii(e)&&(0,zn.J)(e)&&(0,Ne.o)(e)&&!n&&!t}(e.script,e.isScriptRunning,e.isStorageCallInProgress),s=(0,zr.E)(e.script,e.isScriptRunning,e.isStorageCallInProgress),c=e.script,d=e.isStorageCallInProgress,p=e.showConnectionPage,m=(0,Ar.n)(e.script,e.isScriptRunning,e.isRecorderRecording),g=(0,Ur.Gu)((0,u.k)("MainHeaderRunButton"),e.script,m,"Editor Page",e.isRecorderRecording),f=(0,_r.c)({entryPoint:Hr.N.EditorPageOverflowButton,script:c,isStorageCallInProgress:d,callback:p}),h=(0,Ur.TW)((0,u.k)("EditorHeaderShareButton"),r,e.isSharingEnabled),v=(0,Ur.O8)((0,u.k)("EditorHeaderStopSharingButton")),S=(0,Ur.LY)((0,u.k)("Divider")+"EditorHeader1"),y=(0,Ur.lq)((0,u.k)("MainHeaderOverflowDelete"),e.script,s),E=(0,Ur.sI)((0,u.k)("MainHeaderOverflowRenameButton"),o,function(e){return function(){e.editMode||e.setEditMode(!0),(0,l.ve)({eventName:"ControlAction",eventType:"User",data:{control:"RenameButton",location:"Overflow"}})}}({editMode:e.editMode,setEditMode:e.setEditMode})),b=Oa(e.script,e.isScriptRunning,e.isStorageCallInProgress),w=(0,Ur.LY)((0,u.k)("Divider")+"EditorHeader2"),k=(0,Ur.tj)(a,(function(){Be.P.instance(Ie.u.store).revertToLastSaved(e.script)})),P=(0,Ur.j3)((function(){e.setShouldFocusBottomPanel(!0),e.setBottomPanelPivotKey(va.Fh.Output),e.showBottomPanel()})),x=(0,Ur.nC)((function(){e.setShouldFocusBottomPanel(!0),e.setBottomPanelPivotKey(va.Fh.Help),e.showBottomPanel()})),C=(0,Ur.Jj)((function(){e.showSettingsPage()})),N=(0,Ur.LY)((0,u.k)("Divider")+"EditorHeader3"),M=(0,Ur.mw)((0,u.k)("EditorHeaderFlowButton"),e.script,"Editor"),R=(0,Ur.kQ)((0,u.k)("MainHeaderOverflowAddButtonToWorkbookButton"),e.script,e.isSharingEnabled,e.addButtonToWorkbook),I=(0,Ur.LY)((0,u.k)("Divider")+"EditorHeader4"),B=(0,Ur.uW)((0,u.k)("EditorHeaderOverflowDetailsButton"),e.script,"Editor Page Overflow"),T=(0,Ur.dR)((function(){window.sessionStorage.setItem((0,Y.Z)("ShowBackButton"),"1"),window.location.hash=xa.yy.About})),D=function(e){if((0,Te.HQ)("OfficeScriptConnectionTest")){var t=Ra;return[t("Connect Local Websocket",Ma.C.WebSocket,Ca.a.None,e),t("Connect Persistant Insiders",Ma.C.Persistent,Ca.a.Insiders,e),t("Local Insiders",Ma.C.Single,Ca.a.LocalInsiders,e),t("Local",Ma.C.Single,Ca.a.Local,e),t("Insiders",Ma.C.Single,Ca.a.Insiders,e),t("Production",Ma.C.Single,Ca.a.Production,e)]}return[]}({script:e.script,callback:e.showConnectionPage}),O={key:"OverflowStylesCarrier",calloutBackgroundColor:e.theme.colors.neutralLighterAlt};return[g].concat(f,[i&&h,r&&v,S,y,E,b,w,k,P,x,C,N,M,R,I,B,n&&T],D,[O]).filter(Boolean)};function za(){return za=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},za.apply(this,arguments)}var Za,Fa=(0,o.$j)((function(e,t){var n={script:t.script,isReadOnly:!1,isMonacoLoading:!1,externalContentUpdateCounter:0,isStorageCallInProgress:!1,monacoEditorOnWindowName:ue.x?"MONACO_EDITOR":void 0,isReactMonacoLoaded:!1},r=m.ZP.scripts.getIsStorageCallInProgress(e,t.script.storageScript.id);return za({},n,{isReadOnly:r||m.ZP.run.getIsRunning(e)||ii(t.script),isMonacoLoading:m.ZP.editor.getIsLoading(e),externalContentUpdateCounter:m.ZP.editor.getExternalContentUpdateCounter(e),isStorageCallInProgress:r,isReactMonacoLoaded:m.ZP.backstage.getIsReactMonacoLoaded(e),navigationSourcePageName:m.ZP.editor.getNavigationSourcePage(e)})}),{editorDidMount:p.ZP.editor.onMount,onValueChange:p.ZP.scripts.editBody})($e),Wa=(0,o.$j)((function(e){var t=a.w.scripts.get(e,a.w.editor.getActiveScriptId(e)),n=a.w.scripts.getSavingStatus(e,t?t.storageScript.id:null),r=a.w.scripts.getIsStorageCallInProgress(e,t?t.storageScript.id:null),i=a.w.scripts.getOtherOwnedScriptNames(e,(t||{storageScript:{}}).storageScript.id);return{isBottomPanelVisible:a.w.bottomPanel.getIsVisible(e),savingStatus:n,script:t,isStorageCallInProgress:r,localOtherOwnedScriptNames:i,isMakingACopy:a.w.editor.getIsMakingACopy(e),isEditingScriptName:a.w.editor.getIsEditingScriptName(e)}}),{showDetailsPage:a.N.editor.showDetailsPage,setIsEditingScriptName:a.N.editor.setIsEditingScriptName})((0,c.Zz)((function(e){var t=e.theme,n=e.isBottomPanelVisible,r=e.savingStatus,o=e.isStorageCallInProgress,a=e.script,s=e.localOtherOwnedScriptNames,c=e.isMakingACopy,l=e.isEditingScriptName,u=e.showDetailsPage,d=e.showSettingsPage,p=e.showConnectionPage,m=e.setIsEditingScriptName,g=(0,i.useState)(!1),h=g[0],v=g[1],S=(0,i.useRef)(null),y=(0,i.useState)(!1),E=y[0],b=y[1],w=a?a.storageScript.name:"",k=(0,i.useState)(w),P=k[0],x=k[1];return(0,i.useEffect)((function(){x(a?a.storageScript.name:"")}),[null==a?void 0:a.storageScript.name]),(0,i.useEffect)((function(){"Failed"===r&&w!==P&&x(w)}),[r,w]),(0,i.useEffect)((function(){!0===c&&b(!0)}),[c]),i.createElement(f.Z,{header:a?i.createElement(Ba,{isStorageCallInProgress:o,showDetailsPage:u,showSettingsPage:d,setShouldFocusBottomPanel:function(e){return v(e)},script:a,editableScriptNameRef:S,editMode:l,setEditMode:m,showConnectionPage:p}):null,main:i.createElement(_a,null,a?i.createElement(i.Fragment,null,i.createElement(io,null),i.createElement(po,null),i.createElement(ua,{script:a,savedScriptName:w,scriptName:P,scriptSavingStatus:r,isStorageCallInProgress:o,otherScriptNames:s,editMode:l,setEditMode:m,shouldFocus:E,setShouldFocus:b,isMakingACopy:c,setScriptName:x}),i.createElement(ca,null,i.createElement(Bi,null),c?i.createElement(Ha,null,i.createElement(ae.$,{size:se.E.large,ariaLabel:strings.Editor.MakingACopySpinner,label:strings.Editor.MakingACopySpinnerAriaLabel,styles:(0,D.H_)(se.E.large,t)})):i.createElement(Fa,{theme:t,script:a}),i.createElement(ee.Z,{when:n},i.createElement(Pa,{shouldFocusBottomPanel:h,setShouldFocusBottomPanel:function(e){return v(e)}})))):i.createElement(Ua,null,i.createElement(ae.$,{size:se.E.large,styles:{circle:{border:"2px solid "+t.colors.primaryLightest,borderTop:"2px solid "+t.colors.primary,width:"30px",height:"30px",animation:"loading-animation 1s linear infinite"}}})))})}))),_a=c.ZP.div.withConfig({displayName:"CodeEditor__MainWrapper",componentId:"sc-1d66gn5-0"})(["height:100%;width:100%;"]),Ua=c.ZP.div.withConfig({displayName:"CodeEditor__SpinnerWrapper",componentId:"sc-1d66gn5-1"})(["height:100%;width:100%;display:flex;align-items:center;justify-content:center;"]),Ha=c.ZP.div.withConfig({displayName:"CodeEditor__SpinnerArea",componentId:"sc-1d66gn5-2"})(["width:100%;height:calc(100% - 3.2rem);background:",";display:flex;align-items:center;justify-content:center;"],(function(e){return e.theme.colors.neutralLighterAlt})),ja=n(20440),Va=n(3033);!function(e){e.Backstage="Backstage",e.Connection="Connection",e.Details="Details",e.Editor="Editor",e.Settings="Settings",e.Unknown="Unknown"}(Za||(Za={}));var Ka=n(2898),Ga=!1,Xa=Za.Unknown,$a=Za.Unknown,qa=0,Qa=0;function Ya(e){return Za[e]}var Ja=(0,o.$j)((function(e){return{isBackstageVisible:a.w.backstage.getIsVisible(e),isDetailsPageVisible:a.w.editor.getIsDetailsPageVisible(e),detailsNavigateSource:a.w.editor.getDetailsNavigateSource(e)}}),{setDetailsNavigateSource:a.N.editor.setDetailsNavigateSource})((function(e){var t=e.isBackstageVisible,n=e.isDetailsPageVisible,r=e.detailsNavigateSource,o=e.setDetailsNavigateSource,a=(0,i.useState)(!1),s=a[0],c=a[1],d=(0,i.useState)(!1),p=d[0],m=d[1],f=function(){return m(!0)},h=function(e){var t=e.isBackstageVisible,n=e.isConnectionPageVisible,r=e.isDetailsPageVisible,i=e.isSettingsPageVisible;return n?Za.Connection:i?Za.Settings:r?Za.Details:t?Za.Backstage:Za.Editor}({isBackstageVisible:t,isDetailsPageVisible:n,isConnectionPageVisible:p,isSettingsPageVisible:s});$a=Xa,Xa=h;var v=Ya($a),S=Ya(Xa);r&&Xa==Za.Details?((0,l.sM)(r,S),o(null)):(0,l.sM)(v,S),Xa!==Za.Details&&Xa!==Za.Editor||Ka.L.instance().ensurePreload(),(0,i.useEffect)((function(){Ga||window.addEventListener("resize",(0,oe.D)((function(){var e=window.innerWidth,t=window.innerHeight;e==qa&&t==Qa||(0,l.ve)({eventName:"WindowResized",eventType:"System",data:{height:t,previousHeight:Qa,width:e,previousWidth:qa,page:S}}),qa=e,Qa=t}),3e3)),Ga=!0,qa=window.innerWidth,Qa=window.innerHeight}));var y=i.createElement(i.Fragment,null);switch(h){case Za.Backstage:y=i.createElement(i.Fragment,null,i.createElement(Bi,null),i.createElement(Ct,{showConnectionPage:f}));break;case Za.Connection:y=i.createElement(sa,{hideConnectionPage:function(){return m(!1)}});break;case Za.Editor:y=i.createElement(Wa,{showSettingsPage:function(){return c(!0)},showConnectionPage:f});break;case Za.Details:y=i.createElement(Zo,{showConnectionPage:f});break;case Za.Settings:y=i.createElement(Zt,{hideSettingsPage:function(){return c(!1)}})}return i.createElement(es,{"data-testid":(0,u.k)("CodeEditor")},i.createElement(ja.Z,null),i.createElement(g,null),y,i.createElement(Va.Z,null))})),es=c.ZP.div.withConfig({displayName:"EditorMain__Wrapper",componentId:"sc-19e5x8c-0"})(["height:100%;width:100%;padding-bottom:",";display:flex;flex-direction:column;"],(function(e){return e.theme.spacing.medium})),ts=n(40106),ns=n(78095),rs=n(24654),is=n(65262),os=(0,ns.UY)({isVisible:function(e,t){switch(void 0===e&&(e=!0),t.type){case(0,rs.getType)(is.show):return!0;case(0,rs.getType)(is.hide):return!1;default:return e}},currentPivot:function(e,t){return void 0===e&&(e=null),t.type===(0,rs.getType)(is.setCurrentPivot)?t.payload:e},isReactMonacoLoaded:function(e,t){return void 0===e&&(e=!1),t.type===(0,rs.getType)(is.setIsReactMonacoLoaded)||e}}),as=n(9580),ss=n(9180),cs=n(13732),ls=n(89121),us=(0,ns.UY)({isVisible:function(e,t){switch(void 0===e&&(e=!1),t.type){case(0,rs.getType)(ls.show):return!0;case(0,rs.getType)(ls.hide):return!1;default:return e}}}),ds=n(71234),ps=(0,ns.UY)({isVisible:function(e,t){switch(void 0===e&&(e=!1),t.type){case(0,rs.getType)(ds.show):return!0;case(0,rs.getType)(ds.hide):return!1;default:return e}}}),ms=n(89311),gs=n(50578),fs=n(71611),hs=n(94232),vs=n(2015),Ss=n(6503),ys=n(10819),Es=(0,ns.UY)({isVisible:function(e,t){switch(void 0===e&&(e=!1),t.type){case(0,rs.getType)(ys.show):return!0;case(0,rs.getType)(ys.hide):return!1;default:return e}}}),bs=n(24637),ws=n(13683);function ks(e){e.addAction({id:"trigger-suggest",label:"Trigger suggestion",keybindings:[monaco.KeyCode.F2],contextMenuGroupId:"navigation",contextMenuOrder:0,run:function(){return e.trigger("editor","editor.action.triggerSuggest",{})}})}var Ps=0,xs=function(e){return{id:""+Ps++,message:"["+e.startLineNumber+", "+e.startColumn+"] "+e.message,severity:Cs(e.severity)}},Cs=function(e){switch(e){case monaco.MarkerSeverity.Hint:return va.xj.Log;case monaco.MarkerSeverity.Info:return va.xj.Info;case monaco.MarkerSeverity.Warning:return va.xj.Warn;case monaco.MarkerSeverity.Error:return va.xj.Error;default:throw new Error("Invalid marker severity")}},Ns=n(89281),Ms=n(65506),Rs=n(87356);function Is(e,t,n){var r=e.getModel();monaco.editor.setModelMarkers(r,t,n)}var Bs={MainFunction:null,FunctionArgument:null,SyncApi:null,Dynamic:null};function Ts(e){if(!Bs[e]){var t=new Worker(new URL(n.p+n.u(1984),n.b));t.addEventListener("error",(function(n){t.terminate(),Bs[e]=null,(0,l.m)(new Error("Unexpected error in Monaco marker web worker: "+n.message),l.in.Warning)})),Bs[e]=t}return Bs[e]}var Ds=n(38843),Os=n(82143),Ls=n(59338);function As(){return As=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},As.apply(this,arguments)}function zs(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,i)}function Zs(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){zs(o,r,i,a,s,"next",e)}function s(e){zs(o,r,i,a,s,"throw",e)}a(void 0)}))}}var Fs=regeneratorRuntime.mark(tc),Ws=regeneratorRuntime.mark(nc),_s=regeneratorRuntime.mark(rc),Us=regeneratorRuntime.mark(ic),Hs=regeneratorRuntime.mark(oc),js=regeneratorRuntime.mark(ac),Vs=regeneratorRuntime.mark(sc),Ks=regeneratorRuntime.mark(cc),Gs=regeneratorRuntime.mark(pc),Xs=regeneratorRuntime.mark(mc),$s=regeneratorRuntime.mark(Sc),qs=regeneratorRuntime.mark(yc),Qs=regeneratorRuntime.mark(Ec),Ys=regeneratorRuntime.mark(bc),Js=regeneratorRuntime.mark(wc),ec=regeneratorRuntime.mark(kc);function tc(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,bs.ib)((0,rs.getType)(Mn.N.misc.initialize),nc);case 2:return e.next=4,(0,bs.ib)((0,rs.getType)(Mn.N.scripts.remove.success),kc);case 4:return e.next=6,(0,bs.ib)((0,rs.getType)(Mn.N.editor.openScript),ic);case 6:return e.next=8,(0,bs.ib)((0,rs.getType)(Mn.N.editor.openScriptInDetailsPage),oc);case 8:return e.next=10,(0,bs.ib)((0,rs.getType)(Mn.N.editor.openScriptInEditor),ac);case 10:return e.next=12,(0,bs.ib)((0,rs.getType)(Mn.N.editor.onMount),sc);case 12:return e.next=14,(0,bs.ib)((0,rs.getType)(Mn.N.editor.onOpenNewScript),cc);case 14:return e.next=16,(0,bs.Ds)(1e3,(0,rs.getType)(Mn.N.editor.updateMonacoMarkers),pc);case 16:return e.next=18,(0,bs.P2)(500,(0,rs.getType)(Mn.N.editor.updateProblemsLogs),Ec);case 18:return e.next=20,(0,bs.ib)((0,rs.getType)(Mn.N.bottomPanel.show),bc);case 20:return e.next=22,(0,bs.ib)((0,rs.getType)(Mn.N.editor.hideDetailsPage),wc);case 22:case"end":return e.stop()}}),Fs)}function nc(){var e,t,n,r,i,o;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!(0,Te.HQ)("EnableMRUExperience")){a.next=15;break}if(!((e=(0,Ns.Gp)())&&e.length>0)){a.next=9;break}return a.next=5,(0,bs.gz)(Mn.N.scripts.fetchMRUMetadataFromStorage.success({scripts:e}));case 5:return a.next=7,(0,bs.gz)(Mn.N.scripts.mruScriptMetadataReceived());case 7:a.next=15;break;case 9:return a.next=11,(0,bs.Ys)(Mn.w.scripts.getAllMRUScripts);case 11:if(!((t=a.sent)&&t.length>0)){a.next=15;break}return a.next=15,(0,bs.gz)(Mn.N.scripts.mruScriptMetadataReceived());case 15:if(!(n=(0,Ns.Ey)())){a.next=23;break}return a.next=19,(0,bs.gz)(Mn.N.scripts.mergeMetadataFromRibbon({scripts:n}));case 19:if("Editor"!==(0,xa.L3)()){a.next=23;break}return(0,l.bK)(),a.next=23,(0,bs.gz)(Mn.N.scripts.publishedScriptMetadataReceived());case 23:if(!(r=(0,Ns.lw)())){a.next=30;break}if(!(0,Te.HQ)("EnableMRUExperience")){a.next=28;break}return a.next=28,(0,bs.gz)(Mn.N.scripts.updateMRUScriptsIfShared({scripts:r}));case 28:return a.next=30,(0,bs.gz)(Mn.N.scripts.mergeSharedMetadataFromRibbon({scripts:r}));case 30:return a.next=32,(0,bs.RE)(Ns.k5);case 32:return i=a.sent,o=(0,He.Gk)(),a.next=36,(0,bs.rM)(Ds.QH);case 36:if(!(0,Te.HQ)("PopulateRecentScripts")){a.next=39;break}return a.next=39,(0,bs.rM)(Ds.k5);case 39:if(!i){a.next=46;break}return a.next=42,(0,bs.gz)(Mn.N.editor.setDetailsNavigateSource(o||null));case 42:return a.next=44,(0,bs.RE)(rc,i);case 44:a.next=51;break;case 46:if("Editor"!==(0,He.xO)()){a.next=51;break}return a.next=50,(0,bs.gz)(Mn.N.backstage.hide());case 50:Be.P.instance(Ie.u.store).createNewScript();case 51:return a.next=53,(0,bs.RE)(l.Qm);case 53:case"end":return a.stop()}}),Ws)}function rc(e){var t,n,r,i;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e,o.next=3,(0,bs.Ys)(Mn.w.scripts.get,t.storageScript.id);case 3:return n=o.sent,r=(0,Rs.Z)({incomingScript:t,existingScript:n}),i=r.selectedScript,o.next=7,(0,bs.gz)(Mn.N.scripts.update(i));case 7:if("Details"!==(0,He.xO)()){o.next=11;break}return o.next=11,(0,bs.gz)(Mn.N.editor.showDetailsPage());case 11:return o.next=13,(0,bs.gz)(Mn.N.backstage.hide());case 13:return o.next=15,(0,bs.gz)(Mn.N.editor.setActive({id:i.storageScript.id,forceRefetch:"MacroRecorder"!==(0,He.Gk)()}));case 15:case"end":return o.stop()}}),_s)}function ic(e){var t,n,r;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.payload.id,n=e.payload.destination,i.next=4,(0,bs.Ys)(Mn.w.scripts.get,t);case 4:if(r=i.sent,!(0,Ne.o)(r)){i.next=9;break}return i.next=9,(0,bs.gz)(Mn.N.scripts.updateSavingStatus({id:e.payload.id,status:"Unsaved"}));case 9:if("Details"!==n){i.next=14;break}return i.next=12,(0,bs.gz)(Mn.N.editor.openScriptInDetailsPage({id:t}));case 12:i.next=16;break;case 14:return i.next=16,(0,bs.gz)(Mn.N.editor.openScriptInEditor({id:t}));case 16:case"end":return i.stop()}}),Us)}function oc(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,bs.gz)(Mn.N.editor.setActive(e.payload));case 2:return t.next=4,(0,bs.gz)(Mn.N.editor.showDetailsPage());case 4:return t.next=6,(0,bs.gz)(Mn.N.backstage.hide());case 6:case"end":return t.stop()}}),Hs)}function ac(e){var t,n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,bs.Ys)(Mn.w.editor.getActiveScriptId);case 2:if(t=r.sent){r.next=6;break}return r.next=6,(0,bs.gz)(Mn.N.backstage.hide());case 6:return r.next=8,(0,bs.gz)(Mn.N.editor.setActive(e.payload));case 8:return r.next=10,(0,bs.gz)(Mn.N.editor.hideDetailsPage());case 10:if(It.p.instance().applySettings(),!(n=e.payload.id)||n===t){r.next=15;break}return r.next=15,(0,bs.gz)(Mn.N.editor.onOpenNewScript());case 15:return r.next=17,(0,bs.gz)(Mn.N.backstage.hide());case 17:case"end":return r.stop()}}),js)}function sc(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Ls.r.editor=e.payload,t.next=3,(0,bs.gz)(Mn.N.editor.updateProblemsLogs());case 3:return t.next=5,(0,bs.gz)(Mn.N.editor.updateMonacoMarkers());case 5:return t.next=7,(0,bs.RE)(ks,Ls.r.editor);case 7:return It.p.instance().applySettings(),t.next=10,(0,bs.gz)(Mn.N.editor.monacoInitialized());case 10:case"end":return t.stop()}}),Vs)}function cc(e){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,bs.gz)(Mn.N.bottomPanel.clearOutputLogs());case 2:return e.next=4,(0,bs.gz)(Mn.N.bottomPanel.clearProblemsLogs());case 4:case"end":return e.stop()}}),Ks)}var lc=0;function uc(e,t,n,r,i){return dc.apply(this,arguments)}function dc(){return(dc=Zs(regeneratorRuntime.mark((function e(t,n,r,i,o){var a,s,c,u,d,p,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new l.pX(t,"System")).failAfter(l.NJ.OperationProbablyHung,l.in.ASHA),s=lc++,c=Ts(t),e.next=6,De.c.promise();case 6:return u=e.sent,o&&(u.onCacheUpdated=o),d=new Promise((function(e,n){c.addEventListener("message",(function r(i){var o=i.data,u=o.messageId,d=o.markers,p=o.error,m=void 0===p?void 0:p,g=o.parameterInfo,f=void 0===g?void 0:g,h=o.telemetryData,v=void 0===h?void 0:h;(0,Te.HQ)("DynamicLinter")||t!==Ee.Dynamic||d.splice(0),s==u&&(c.removeEventListener("message",r),m?(a.fail(l.in.Warning,As({},v),m),n(m)):(Is(Ls.r.editor,xe(t),d),a.succeed(l.in.Information,As({},v)),e(f)))}))})),p={cache:u.getCache(),stringsDictionary:strings.Linting},m={shouldApiLint:!Wr(),shouldUndoLint:!1,highestSupportedApi:"1.14",apiNotSupportedError:strings.Linting.APINotSupported,apiNotUndoableError:strings.Linting.APINotUndoable},c.postMessage({messageId:s,linter:t,body:n,variant:r,rules:i,dynamicParams:p,apiParams:m}),e.abrupt("return",d);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pc(){var e,t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,bs.Ys)(Mn.w.editor.getActiveScriptId);case 2:return e=n.sent,n.next=5,(0,bs.Ys)(Mn.w.scripts.get,e);case 5:if((t=n.sent)&&!ii(t)){n.next=8;break}return n.abrupt("return");case 8:if(!Ls.r.editor){n.next=23;break}if(!e||!t){n.next=21;break}if(!(0,Ms.Z)(t)){n.next=19;break}return n.next=13,(0,bs.rM)(mc,t);case 13:if(!(0,Te.HQ)("DynamicLinter")&&!(0,Te.HQ)("DynamicLinterTelemetry")){n.next=16;break}return n.next=16,(0,bs.rM)(gc,t);case 16:if((0,pe.Xf)()!==Office.PlatformType.PC||!(0,He.jN)("OfficeScriptsWin32CRUD")){n.next=19;break}return n.next=19,(0,bs.rM)(hc,t);case 19:return n.next=21,(0,bs.rM)(Sc,t);case 21:return n.next=23,(0,bs.rM)(yc);case 23:case"end":return n.stop()}}),Gs)}function mc(e){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,bs.RE)(Os.$,e);case 2:return t=n.sent,n.prev=3,n.next=6,(0,bs.RE)(uc,Ee.SyncAPI,e.localUpdates.body,void 0,t);case 6:n.next=10;break;case 8:n.prev=8,n.t0=n.catch(3);case 10:case"end":return n.stop()}}),Xs,null,[[3,8]])}function gc(e){return fc.apply(this,arguments)}function fc(){return(fc=Zs(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,uc(Ee.Dynamic,t.localUpdates.body,void 0,void 0,Zs(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ie.u.store.dispatch(Mn.N.editor.updateMonacoMarkers());case 1:case"end":return e.stop()}}),e)}))));case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function hc(e){return vc.apply(this,arguments)}function vc(){return(vc=Zs(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,uc(Ee.ApiSet,t.localUpdates.body,void 0,void 0,Zs(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ie.u.store.dispatch(Mn.N.editor.updateMonacoMarkers());case 1:case"end":return e.stop()}}),e)}))));case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function Sc(e){var t;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,(0,bs.RE)(uc,Ee.FunctionArgument,e.localUpdates.body,(0,Pe.u)(e));case 3:if(!(t=n.sent)){n.next=7;break}return n.next=7,(0,bs.gz)(Mn.N.scripts.partialUpdate({id:e.storageScript.id,updatedFields:{parameterInfo:t}}));case 7:n.next=11;break;case 9:n.prev=9,n.t0=n.catch(0);case 11:case"end":return n.stop()}}),$s,null,[[0,9]])}function yc(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=0;case 1:if(!(e<4)){t.next=9;break}return t.next=4,(0,bs.gz)(Mn.N.editor.updateProblemsLogs());case 4:return t.next=6,(0,bs.gw)(500);case 6:e++,t.next=1;break;case 9:case"end":return t.stop()}}),qs)}function Ec(){var e,t,n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,bs.Ys)(Mn.w.editor.getActiveScriptId);case 2:return e=r.sent,r.next=5,(0,bs.Ys)(Mn.w.scripts.get,e);case 5:if((t=r.sent)&&!ii(t)){r.next=8;break}return r.abrupt("return");case 8:if(!Ls.r.editor||!t){r.next=15;break}return n=monaco.editor.getModelMarkers({resource:monaco.Uri.file(t.storageScript.name)}).map((function(e){return xs(e)})),r.next=12,(0,bs.Ys)(Mn.w.editor.getIsDetailsPageVisible);case 12:if(r.sent){r.next=15;break}return r.next=15,(0,bs.gz)(Mn.N.bottomPanel.setProblemsLogs(n));case 15:case"end":return r.stop()}}),Qs)}function bc(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,bs.gz)(Mn.N.editor.updateMonacoMarkers());case 2:return e.next=4,(0,bs.Ys)(Mn.w.editor.getIsDetailsPageVisible);case 4:if(!e.sent){e.next=8;break}return e.next=8,(0,bs.gz)(Mn.N.editor.hideDetailsPage());case 8:case"end":return e.stop()}}),Ys)}function wc(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,bs.Ys)(Mn.w.run.getIsRunning);case 2:if(e.sent){e.next=6;break}return e.next=6,(0,bs.gz)(Mn.N.messageBar.dismiss());case 6:case"end":return e.stop()}}),Js)}function kc(e){var t,n,r,i;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.payload.script,o.next=3,(0,bs.Ys)(Mn.w.editor.getActiveScriptId);case 3:if(n=o.sent,r=t.storageScript.id,(i=t.localUpdates.shareId)&&(0,pe.wc)([i]),r!==n){o.next=14;break}return o.next=10,(0,bs.gz)(Mn.N.editor.setActive({id:null}));case 10:return o.next=12,(0,bs.gz)(Mn.N.bottomPanel.hide());case 12:return o.next=14,(0,bs.gz)(Mn.N.backstage.show());case 14:case"end":return o.stop()}}),ec)}var Pc=regeneratorRuntime.mark(xc);function xc(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,bs.$6)([(0,ws.Z)(),tc(),(0,Ds.ZP)()]);case 2:case"end":return e.stop()}}),Pc)}var Cc=n(17425),Nc=n(12915),Mc=n(43067),Rc=(0,o.$j)((function(e){return{dialogProps:e.dialog}}),(function(e){return{dispatch:e,dismiss:function(){return e(p.ZP.dialog.dismiss())}}}))(Mc.Z),Ic=n(6974),Bc=n(99627),Tc=n(28722),Dc=(n(36030),n(91493)),Oc=n(70128),Lc=new Dc.N;function Ac(e){var t=function(e){return function(t){(function(e){if(e.action===Oc.om.Error||e.action===Oc.om.Success){try{var t=e.messageId,n=Lc.read(t);Lc.delete(t),e.action===Oc.om.Error?(n.reject(e.data),window.clearTimeout(n.timeoutCookie)):e.action==Oc.om.Success&&(n.resolve(e.data),window.clearTimeout(n.timeoutCookie))}catch(r){}return!0}return!1})(t.payload)||e(t)}}(e);(0,Oc.oL)(t)}var zc=n(99684),Zc=n(69841),Fc=function(e,t){return new Promise((function(n,r){Ie.u.store.dispatch(a.N.authDialog.show({acceptFn:function(){Ic.F.getAccessTokenInternal(e,t,!0).then(n).catch(r)},cancelFn:r}))}))},Wc=function(){var e=(0,i.useState)(Ie.u.store),t=e[0],n=e[1];return(0,Tc.hf)(),(0,i.useEffect)((function(){if(!Ie.u.store){var e=ue.x&&window.initialState||function(){var e;return(e={})[Nc.oF]=(0,Cc.jw)(),e}();It.p.instance().initialize((0,On.ri)()),Ie.u.store=(0,s.Z)({initialState:e,rootReducer:(0,ns.UY)({backstage:os,bottomPanel:as.Z,consentDialog:ss.Z,authDialog:cs.Z,shareDialog:us,unshareDialog:ps,dialog:ms.Z,editor:gs.Z,messageBar:fs.Z,run:hs.Z,scripts:vs.ZP,runFromButton:Ss.Z,permissionDialog:Es}),rootSaga:xc}),Bc.if.putFallbackFn(Fc),Ie.u.store.dispatch(a.N.misc.initialize()),ue.x&&(window.store=Ie.u.store),n(Ie.u.store);var t=(0,oe.D)((function(){return Ie.u.store.dispatch(a.N.editor.setIsRecorderRunning(!1))}),1500);(0,pe.Xf)()==Office.PlatformType.OfficeOnline&&Office.onReady().then((function(){Ac((function(e){e.payload.method===Oc.Vy.RecorderHeartbeat&&(Ie.u.store.dispatch(a.N.editor.setIsRecorderRunning(!0)),t())}))})),Yn.$8.listen((function(e){(0,zc.r)(e),6===e.callCount&&e.callCount===e.fails.networkFailures&&(Ie.u.store.dispatch(a.N.messageBar.show({text:strings.General.NetworkFailureWarning,style:Zc.f.warning})),(0,l.ve)({eventName:"LikelyFirewallEncountered",eventType:"System"}))}))}}),[]),t?i.createElement(o.zt,{store:t},i.createElement(i.Fragment,null,i.createElement(ts.Z,null,i.createElement(Ja,null)),i.createElement(Rc,null))):null}},70128:function(e,t,n){n.d(t,{om:function(){return r},Vy:function(){return i},tn:function(){return s},oL:function(){return c}});var r,i,o=n(52105),a=n(54050);function s(e,t){return{sourcePane:(0,o.L3)(),targetPane:e,payload:t}}function c(e){(0,a.xi)((function(t){t.targetPane===(0,o.L3)()&&e(t)}))}!function(e){e[e.Request=0]="Request",e[e.Success=1]="Success",e[e.Error=2]="Error"}(r||(r={})),function(e){e[e.RecorderHeartbeat=0]="RecorderHeartbeat"}(i||(i={}))},67746:function(e,t,n){n.d(t,{D:function(){return r}});var r=function(e,t){var n;return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];clearTimeout(n),n=setTimeout((function(){return e.apply(void 0,i)}),t)}}}}]);
//# sourceMappingURL=editor.548926e8.chunk.js.map